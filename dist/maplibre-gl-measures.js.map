{"version":3,"file":"maplibre-gl-measures.js","mappings":"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","sources":["webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/pace.js","webpack://maplibreGLMeasures/./node_modules/fast-deep-equal/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._shimkeys/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.bind/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/current.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/energy.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/partsPer.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/apparentPower.js","webpack://maplibreGLMeasures/./node_modules/lodash.identity/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/illuminance.js","webpack://maplibreGLMeasures/./node_modules/lodash._renative/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/digital.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/geojson-normalize/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/power.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/frequency.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/voltage.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/pressure.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/length.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/volume.js","webpack://maplibreGLMeasures/./node_modules/lodash.forown/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._basecreate/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/each.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/reactivePower.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/angle.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/speed.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/mass.js","webpack://maplibreGLMeasures/./node_modules/lodash._createwrapper/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._basebind/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/time.js","webpack://maplibreGLMeasures/./node_modules/lodash.keys/index.js","webpack://maplibreGLMeasures/./node_modules/wgs84/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/temperature.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.isobject/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.isfunction/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.noop/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._basecreatewrapper/index.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/geojson-area/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._setbinddata/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.foreach/index.js","webpack://maplibreGLMeasures/./node_modules/lodash._objecttypes/index.js","webpack://maplibreGLMeasures/./node_modules/lodash.support/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/volumeFlowRate.js","webpack://maplibreGLMeasures/./node_modules/lodash._basecreatecallback/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/reactiveEnergy.js","webpack://maplibreGLMeasures/./node_modules/lodash._slice/index.js","webpack://maplibreGLMeasures/./node_modules/convert-units/lib/definitions/area.js","webpack://maplibreGLMeasures/webpack/bootstrap","webpack://maplibreGLMeasures/webpack/runtime/compat get default export","webpack://maplibreGLMeasures/webpack/runtime/define property getters","webpack://maplibreGLMeasures/webpack/runtime/global","webpack://maplibreGLMeasures/webpack/runtime/hasOwnProperty shorthand","webpack://maplibreGLMeasures/webpack/runtime/make namespace object","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/mode_handler.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/constants.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/sort_features.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/map_event_to_bounding_box.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/string_set.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/features_at.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/get_features_and_set_cursor.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/euclidean_distance.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/is_click.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/is_tap.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/id.js","webpack://maplibreGLMeasures/./node_modules/nanoid/non-secure/index.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/feature_types/feature.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/feature_types/point.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/feature_types/line_string.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/feature_types/polygon.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/feature_types/multi_feature.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/mode_interface_accessors.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/mode_interface.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/object_to_mode.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/to_dense_array.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/render.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/store.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/ui.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/setup.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/events.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/theme.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/common_selectors.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/point-geometry/index.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/mouse_event_point.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/create_vertex.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/create_midpoint.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/create_supplementary_points.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/double_click_zoom.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/constrain_feature_movement.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/move_features.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/simple_select.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/direct_select.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_point.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/is_event_at_coordinates.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_polygon.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_line_string.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/modes/index.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/options.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/lib/string_sets_are_equal.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/src/api.js","webpack://maplibreGLMeasures/./node_modules/@mapbox/mapbox-gl-draw/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/helpers/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/meta/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/area/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/centroid/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/invariant/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/distance/dist/esm/index.js","webpack://maplibreGLMeasures/./node_modules/@turf/length/dist/esm/index.js","webpack://maplibreGLMeasures/./src/maplibre-gl-measures.js","webpack://maplibreGLMeasures/./node_modules/@turf/line-segment/dist/esm/index.js"],"sourcesContent":["var metric\n  , imperial;\n\nmetric = {\n  'min/km': {\n    name: {\n      singular: 'Minute per kilometre'\n    , plural: 'Minutes per kilometre'\n    }\n  , to_anchor: 0.06\n  }\n  ,'s/m': {\n    name: {\n      singular: 'Second per metre'\n    , plural: 'Seconds per metre'\n    }\n  , to_anchor: 1\n  }\n}\n\nimperial = {\n    'min/mi': {\n      name: {\n        singular: 'Minute per mile'\n      , plural: 'Minutes per mile'\n      }\n    , to_anchor: 0.0113636\n   }\n   , 's/ft': {\n      name: {\n        singular: 'Second per foot'\n      , plural: 'Seconds per foot'\n      }\n    , to_anchor: 1\n   }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 's/m'\n    , ratio: 0.3048\n    }\n  , imperial: {\n      unit: 's/ft'\n    , ratio: 1/0.3048\n    }\n  }\n};\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar objectTypes = require('lodash._objecttypes');\n\n/** Used for native method references */\nvar objectProto = Object.prototype;\n\n/** Native method shortcuts */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A fallback implementation of `Object.keys` which produces an array of the\n * given object's own enumerable property names.\n *\n * @private\n * @type Function\n * @param {Object} object The object to inspect.\n * @returns {Array} Returns an array of property names.\n */\nvar shimKeys = function(object) {\n  var index, iterable = object, result = [];\n  if (!iterable) return result;\n  if (!(objectTypes[typeof object])) return result;\n    for (index in iterable) {\n      if (hasOwnProperty.call(iterable, index)) {\n        result.push(index);\n      }\n    }\n  return result\n};\n\nmodule.exports = shimKeys;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar createWrapper = require('lodash._createwrapper'),\n    reNative = require('lodash._renative'),\n    slice = require('lodash._slice');\n\n/**\n * Creates a function that, when called, invokes `func` with the `this`\n * binding of `thisArg` and prepends any additional `bind` arguments to those\n * provided to the bound function.\n *\n * @static\n * @memberOf _\n * @category Functions\n * @param {Function} func The function to bind.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {...*} [arg] Arguments to be partially applied.\n * @returns {Function} Returns the new bound function.\n * @example\n *\n * var func = function(greeting) {\n *   return greeting + ' ' + this.name;\n * };\n *\n * func = _.bind(func, { 'name': 'fred' }, 'hi');\n * func();\n * // => 'hi fred'\n */\nfunction bind(func, thisArg) {\n  return arguments.length > 2\n    ? createWrapper(func, 17, slice(arguments, 2), null, thisArg)\n    : createWrapper(func, 1, null, null, thisArg);\n}\n\nmodule.exports = bind;\n","var current;\n\ncurrent = {\n  A: {\n    name: {\n      singular: 'Ampere'\n    , plural: 'Amperes'\n    }\n  , to_anchor: 1\n  }\n, mA: {\n    name: {\n      singular: 'Milliampere'\n      , plural: 'Milliamperes'\n    }\n    , to_anchor: .001\n  }\n, kA: {\n    name: {\n      singular: 'Kiloampere'\n    , plural: 'Kiloamperes'\n    }\n  , to_anchor: 1000\n  }\n};\n\nmodule.exports = {\n  metric: current\n, _anchors: {\n    metric: {\n      unit: 'A'\n    , ratio: 1\n    }\n  }\n};\n","var energy;\n\nenergy = {\n  Wh: {\n    name: {\n      singular: 'Watt-hour'\n    , plural: 'Watt-hours'\n    }\n  , to_anchor: 3600\n  }\n, mWh: {\n    name: {\n      singular: 'Milliwatt-hour'\n      , plural: 'Milliwatt-hours'\n    }\n    , to_anchor: 3.6\n  }\n, kWh: {\n    name: {\n      singular: 'Kilowatt-hour'\n    , plural: 'Kilowatt-hours'\n    }\n  , to_anchor: 3600000\n  }\n, MWh: {\n    name: {\n      singular: 'Megawatt-hour'\n    , plural: 'Megawatt-hours'\n    }\n  , to_anchor: 3600000000\n  }\n, GWh: {\n    name: {\n      singular: 'Gigawatt-hour'\n    , plural: 'Gigawatt-hours'\n    }\n  , to_anchor: 3600000000000\n  }\n, J: {\n    name: {\n      singular: 'Joule'\n    , plural: 'Joules'\n    }\n  , to_anchor: 1\n  }\n, kJ: {\n    name: {\n      singular: 'Kilojoule'\n    , plural: 'Kilojoules'\n    }\n  , to_anchor: 1000\n  }\n};\n\nmodule.exports = {\n  metric: energy\n, _anchors: {\n    metric: {\n      unit: 'J'\n    , ratio: 1\n    }\n  }\n};\n","var metric\n  , imperial;\n\nmetric = {\n  ppm: {\n    name: {\n      singular: 'Part-per Million'\n      , plural: 'Parts-per Million'\n    }\n    , to_anchor: 1\n  }\n  , ppb: {\n    name: {\n      singular: 'Part-per Billion'\n      , plural: 'Parts-per Billion'\n    }\n    , to_anchor: .001\n  }\n  , ppt: {\n    name: {\n      singular: 'Part-per Trillion'\n      , plural: 'Parts-per Trillion'\n    }\n    , to_anchor: .000001\n  }\n  , ppq: {\n    name: {\n      singular: 'Part-per Quadrillion'\n      , plural: 'Parts-per Quadrillion'\n    }\n    , to_anchor: .000000001\n  }\n};\n\nmodule.exports = {\n  metric: metric\n  , imperial: {}\n  , _anchors: {\n    metric: {\n      unit: 'ppm'\n      , ratio: .000001\n    }\n  }\n};\n","var apparentPower;\n\napparentPower = {\n  VA: {\n    name: {\n      singular: 'Volt-Ampere'\n    , plural: 'Volt-Amperes'\n    }\n  , to_anchor: 1\n  }\n, mVA: {\n    name: {\n      singular: 'Millivolt-Ampere'\n      , plural: 'Millivolt-Amperes'\n    }\n    , to_anchor: .001\n  }\n, kVA: {\n    name: {\n      singular: 'Kilovolt-Ampere'\n    , plural: 'Kilovolt-Amperes'\n    }\n  , to_anchor: 1000\n  }\n, MVA: {\n    name: {\n      singular: 'Megavolt-Ampere'\n    , plural: 'Megavolt-Amperes'\n    }\n  , to_anchor: 1000000\n  }\n, GVA: {\n    name: {\n      singular: 'Gigavolt-Ampere'\n    , plural: 'Gigavolt-Amperes'\n    }\n  , to_anchor: 1000000000\n  }\n};\n\nmodule.exports = {\n  metric: apparentPower\n, _anchors: {\n    metric: {\n      unit: 'VA'\n    , ratio: 1\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/**\n * This method returns the first argument provided to it.\n *\n * @static\n * @memberOf _\n * @category Utilities\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'name': 'fred' };\n * _.identity(object) === object;\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var metric,\nimperial;\n\nmetric = {\n  'lx': {\n    name: {\n      singular: 'Lux',\n      plural: 'Lux'\n    },\n    to_anchor: 1\n  }\n};\n\nimperial = {\n  'ft-cd': {\n    name: {\n      singular: 'Foot-candle',\n      plural: 'Foot-candles'\n    },\n    to_anchor: 1\n  }\n};\n\nmodule.exports = {\n  metric: metric,\n  imperial: imperial,\n  _anchors: {\n    metric: {\n      unit: 'lx',\n      ratio: 1/10.76391\n    },\n    imperial: {\n      unit: 'ft-cd',      \n\t  ratio: 10.76391\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/** Used for native method references */\nvar objectProto = Object.prototype;\n\n/** Used to resolve the internal [[Class]] of values */\nvar toString = objectProto.toString;\n\n/** Used to detect if a method is native */\nvar reNative = RegExp('^' +\n  String(toString)\n    .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n    .replace(/toString| for [^\\]]+/g, '.*?') + '$'\n);\n\nmodule.exports = reNative;\n","var bits\n  , bytes;\n\nbits = {\n  b: {\n    name: {\n      singular: 'Bit'\n    , plural: 'Bits'\n    }\n  , to_anchor: 1\n  }\n, Kb: {\n    name: {\n      singular: 'Kilobit'\n    , plural: 'Kilobits'\n    }\n  , to_anchor: 1024\n  }\n, Mb: {\n    name: {\n      singular: 'Megabit'\n    , plural: 'Megabits'\n    }\n  , to_anchor: 1048576\n  }\n, Gb: {\n    name: {\n      singular: 'Gigabit'\n    , plural: 'Gigabits'\n    }\n  , to_anchor: 1073741824\n  }\n, Tb: {\n    name: {\n      singular: 'Terabit'\n    , plural: 'Terabits'\n    }\n  , to_anchor: 1099511627776\n  }\n};\n\nbytes = {\n  B: {\n    name: {\n      singular: 'Byte'\n    , plural: 'Bytes'\n    }\n  , to_anchor: 1\n  }\n, KB: {\n    name: {\n      singular: 'Kilobyte'\n    , plural: 'Kilobytes'\n    }\n  , to_anchor: 1024\n  }\n, MB: {\n    name: {\n      singular: 'Megabyte'\n    , plural: 'Megabytes'\n    }\n  , to_anchor: 1048576\n  }\n, GB: {\n    name: {\n      singular: 'Gigabyte'\n    , plural: 'Gigabytes'\n    }\n  , to_anchor: 1073741824\n  }\n, TB: {\n    name: {\n      singular: 'Terabyte'\n    , plural: 'Terabytes'\n    }\n  , to_anchor: 1099511627776\n  }\n};\n\nmodule.exports = {\n  bits: bits\n, bytes: bytes\n, _anchors: {\n    bits: {\n      unit: 'b'\n    , ratio: 1/8\n    }\n  , bytes: {\n      unit: 'B'\n    , ratio: 8\n    }\n  }\n};\n","module.exports = normalize;\n\nvar types = {\n    Point: 'geometry',\n    MultiPoint: 'geometry',\n    LineString: 'geometry',\n    MultiLineString: 'geometry',\n    Polygon: 'geometry',\n    MultiPolygon: 'geometry',\n    GeometryCollection: 'geometry',\n    Feature: 'feature',\n    FeatureCollection: 'featurecollection'\n};\n\n/**\n * Normalize a GeoJSON feature into a FeatureCollection.\n *\n * @param {object} gj geojson data\n * @returns {object} normalized geojson data\n */\nfunction normalize(gj) {\n    if (!gj || !gj.type) return null;\n    var type = types[gj.type];\n    if (!type) return null;\n\n    if (type === 'geometry') {\n        return {\n            type: 'FeatureCollection',\n            features: [{\n                type: 'Feature',\n                properties: {},\n                geometry: gj\n            }]\n        };\n    } else if (type === 'feature') {\n        return {\n            type: 'FeatureCollection',\n            features: [gj]\n        };\n    } else if (type === 'featurecollection') {\n        return gj;\n    }\n}\n","var power;\n\npower = {\n  W: {\n    name: {\n      singular: 'Watt'\n    , plural: 'Watts'\n    }\n  , to_anchor: 1\n  }\n, mW: {\n    name: {\n      singular: 'Milliwatt'\n      , plural: 'Milliwatts'\n    }\n    , to_anchor: .001\n  }\n, kW: {\n    name: {\n      singular: 'Kilowatt'\n    , plural: 'Kilowatts'\n    }\n  , to_anchor: 1000\n  }\n, MW: {\n    name: {\n      singular: 'Megawatt'\n    , plural: 'Megawatts'\n    }\n  , to_anchor: 1000000\n  }\n, GW: {\n    name: {\n      singular: 'Gigawatt'\n    , plural: 'Gigawatts'\n    }\n  , to_anchor: 1000000000\n  }\n};\n\nmodule.exports = {\n  metric: power\n, _anchors: {\n    metric: {\n      unit: 'W'\n    , ratio: 1\n    }\n  }\n};\n","var frequency;\n\nfrequency = {\n  mHz: {\n    name: {\n      singular: 'millihertz'\n    , plural: 'millihertz'\n    }\n  , to_anchor: 1/1000\n  }\n, Hz: {\n    name: {\n      singular: 'hertz'\n    , plural: 'hertz'\n    }\n  , to_anchor: 1\n  }\n, kHz: {\n    name: {\n      singular: 'kilohertz'\n    , plural: 'kilohertz'\n    }\n  , to_anchor: 1000\n  }\n, MHz: {\n    name: {\n      singular: 'megahertz'\n    , plural: 'megahertz'\n    }\n  , to_anchor: 1000 * 1000\n  }\n, GHz: {\n    name: {\n      singular: 'gigahertz'\n    , plural: 'gigahertz'\n    }\n  , to_anchor: 1000 * 1000 * 1000\n  }\n, THz: {\n    name: {\n      singular: 'terahertz'\n    , plural: 'terahertz'\n    }\n  , to_anchor: 1000 * 1000 * 1000 * 1000\n  }\n, rpm: {\n    name: {\n      singular: 'rotation per minute'\n    , plural: 'rotations per minute'\n    }\n  , to_anchor: 1/60\n  }\n, \"deg/s\": {\n    name: {\n      singular: 'degree per second'\n    , plural: 'degrees per second'\n    }\n  , to_anchor: 1/360\n  }\n, \"rad/s\": {\n    name: {\n      singular: 'radian per second'\n    , plural: 'radians per second'\n    }\n  , to_anchor: 1/(Math.PI * 2)\n  }\n};\n\n\nmodule.exports = {\n  metric: frequency\n, _anchors: {\n    frequency: {\n      unit: 'hz'\n    , ratio: 1\n    }\n  }\n};\n","var voltage;\n\nvoltage = {\n  V: {\n    name: {\n      singular: 'Volt'\n    , plural: 'Volts'\n    }\n  , to_anchor: 1\n  }\n, mV: {\n    name: {\n      singular: 'Millivolt'\n      , plural: 'Millivolts'\n    }\n    , to_anchor: .001\n  }\n, kV: {\n    name: {\n      singular: 'Kilovolt'\n    , plural: 'Kilovolts'\n    }\n  , to_anchor: 1000\n  }\n};\n\nmodule.exports = {\n  metric: voltage\n, _anchors: {\n    metric: {\n      unit: 'V'\n    , ratio: 1\n    }\n  }\n};\n","var metric\n  , imperial;\n\nmetric = {\n  Pa: {\n    name: {\n      singular: 'pascal'\n    , plural: 'pascals'\n    }\n  , to_anchor: 1/1000\n  }\n, kPa: {\n    name: {\n      singular: 'kilopascal'\n    , plural: 'kilopascals'\n    }\n  , to_anchor: 1\n  }\n, MPa: {\n    name: {\n      singular: 'megapascal'\n    , plural: 'megapascals'\n    }\n  , to_anchor: 1000\n  }\n, hPa: {\n    name: {\n      singular: 'hectopascal'\n    , plural: 'hectopascals'\n    }\n  , to_anchor: 1/10\n  }\n, bar: {\n    name: {\n      singular: 'bar'\n    , plural: 'bar'\n    }\n  , to_anchor: 100\n  }\n, torr: {\n    name: {\n      singular: 'torr'\n    , plural: 'torr'\n    }\n  , to_anchor: 101325/760000\n  }\n};\n\nimperial = {\n  psi: {\n    name: {\n      singular: 'pound per square inch'\n    , plural: 'pounds per square inch'\n    }\n  , to_anchor: 1/1000\n  }\n, ksi: {\n    name: {\n      singular: 'kilopound per square inch'\n    , plural: 'kilopound per square inch'\n    }\n  , to_anchor: 1\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'kPa'\n    , ratio: 0.00014503768078\n    }\n  , imperial: {\n      unit: 'psi'\n    , ratio: 1/0.00014503768078\n    }\n  }\n};\n","var metric,\nimperial;\n\nmetric = {\n  mm: {\n    name: {\n      singular: 'Millimeter',\n      plural: 'Millimeters'\n    },\n    to_anchor: 1/1000\n  },\n  cm: {\n    name: {\n      singular: 'Centimeter',\n      plural: 'Centimeters'\n    },\n    to_anchor: 1/100\n  },\n  m: {\n    name: {\n      singular: 'Meter',\n      plural: 'Meters'\n    },\n    to_anchor: 1\n  },\n  km: {\n    name: {\n      singular: 'Kilometer',\n      plural: 'Kilometers'\n    },\n    to_anchor: 1000\n  }\n};\n\nimperial = {\n  'in': {\n    name: {\n      singular: 'Inch',\n      plural: 'Inches'\n    },\n    to_anchor: 1/12\n  },\n  yd: {\n    name: {\n      singular: 'Yard',\n      plural: 'Yards'\n    },\n    to_anchor: 3\n  },\n  'ft-us': {\n    name: {\n      singular: 'US Survey Foot',\n      plural: 'US Survey Feet'\n    },\n    to_anchor: 1.000002\n  },\n  ft: {\n    name: {\n      singular: 'Foot',\n      plural: 'Feet'\n    },\n    to_anchor: 1\n  },\n  mi: {\n    name: {\n      singular: 'Mile',\n      plural: 'Miles'\n    },\n    to_anchor: 5280\n  }\n};\n\nmodule.exports = {\n  metric: metric,\n  imperial: imperial,\n  _anchors: {\n    metric: {\n      unit: 'm',\n      ratio: 3.28084\n    },\n    imperial: {\n      unit: 'ft',\n      ratio: 1/3.28084\n    }\n  }\n};\n","var metric\n  , imperial;\n\nmetric = {\n  mm3: {\n      name: {\n        singular: 'Cubic Millimeter'\n      , plural: 'Cubic Millimeters'\n      }\n    , to_anchor: 1/1000000\n  }\n, cm3: {\n    name: {\n      singular: 'Cubic Centimeter'\n    , plural: 'Cubic Centimeters'\n    }\n  , to_anchor: 1/1000\n  }\n, ml: {\n    name: {\n      singular: 'Millilitre'\n    , plural: 'Millilitres'\n    }\n  , to_anchor: 1/1000\n  }\n, cl: {\n    name: {\n      singular: 'Centilitre'\n    , plural: 'Centilitres'\n    }\n  , to_anchor: 1/100\n  }\n, dl: {\n    name: {\n      singular: 'Decilitre'\n    , plural: 'Decilitres'\n    }\n  , to_anchor: 1/10\n  }\n, l: {\n    name: {\n      singular: 'Litre'\n    , plural: 'Litres'\n    }\n  , to_anchor: 1\n  }\n, kl: {\n    name: {\n      singular: 'Kilolitre'\n    , plural: 'Kilolitres'\n    }\n  , to_anchor: 1000\n  }\n, m3: {\n    name: {\n      singular: 'Cubic meter'\n    , plural: 'Cubic meters'\n    }\n  , to_anchor: 1000\n  }\n, km3: {\n    name: {\n      singular: 'Cubic kilometer'\n    , plural: 'Cubic kilometers'\n    }\n  , to_anchor: 1000000000000\n  }\n\n// Swedish units\n, krm: {\n  name: {\n    singular: 'Matsked'\n    , plural: 'Matskedar'\n  }\n  , to_anchor: 1/1000\n}\n, tsk: {\n    name: {\n      singular: 'Tesked'\n    , plural: 'Teskedar'\n    }\n  , to_anchor: 5/1000\n  }\n, msk: {\n    name: {\n      singular: 'Matsked'\n      , plural: 'Matskedar'\n    }\n    , to_anchor: 15/1000\n  }\n, kkp: {\n    name: {\n      singular: 'Kaffekopp'\n      , plural: 'Kaffekoppar'\n    }\n    , to_anchor: 150/1000\n  }\n, glas: {\n    name: {\n      singular: 'Glas'\n      , plural: 'Glas'\n    }\n    , to_anchor: 200/1000\n  }\n, kanna: {\n    name: {\n      singular: 'Kanna'\n    , plural: 'Kannor'\n    }\n  , to_anchor: 2.617\n  }\n};\n\nimperial = {\n  tsp: {\n    name: {\n      singular: 'Teaspoon'\n    , plural: 'Teaspoons'\n    }\n  , to_anchor: 1/6\n  }\n, Tbs: {\n    name: {\n      singular: 'Tablespoon'\n    , plural: 'Tablespoons'\n    }\n  , to_anchor: 1/2\n  }\n, in3: {\n    name: {\n      singular: 'Cubic inch'\n    , plural: 'Cubic inches'\n    }\n  , to_anchor: 0.55411\n  }\n, 'fl-oz': {\n    name: {\n      singular: 'Fluid Ounce'\n    , plural: 'Fluid Ounces'\n    }\n  , to_anchor: 1\n  }\n, cup: {\n    name: {\n      singular: 'Cup'\n    , plural: 'Cups'\n    }\n  , to_anchor: 8\n  }\n, pnt: {\n    name: {\n      singular: 'Pint'\n    , plural: 'Pints'\n    }\n  , to_anchor: 16\n  }\n, qt: {\n    name: {\n      singular: 'Quart'\n    , plural: 'Quarts'\n    }\n  , to_anchor: 32\n  }\n, gal: {\n    name: {\n      singular: 'Gallon'\n    , plural: 'Gallons'\n    }\n  , to_anchor: 128\n  }\n, ft3: {\n    name: {\n      singular: 'Cubic foot'\n    , plural: 'Cubic feet'\n    }\n  , to_anchor: 957.506\n  }\n, yd3: {\n    name: {\n      singular: 'Cubic yard'\n    , plural: 'Cubic yards'\n    }\n  , to_anchor: 25852.7\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'l'\n    , ratio: 33.8140226\n    }\n  , imperial: {\n      unit: 'fl-oz'\n    , ratio: 1/33.8140226\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar baseCreateCallback = require('lodash._basecreatecallback'),\n    keys = require('lodash.keys'),\n    objectTypes = require('lodash._objecttypes');\n\n/**\n * Iterates over own enumerable properties of an object, executing the callback\n * for each property. The callback is bound to `thisArg` and invoked with three\n * arguments; (value, key, object). Callbacks may exit iteration early by\n * explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @type Function\n * @category Objects\n * @param {Object} object The object to iterate over.\n * @param {Function} [callback=identity] The function called per iteration.\n * @param {*} [thisArg] The `this` binding of `callback`.\n * @returns {Object} Returns `object`.\n * @example\n *\n * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n *   console.log(key);\n * });\n * // => logs '0', '1', and 'length' (property order is not guaranteed across environments)\n */\nvar forOwn = function(collection, callback, thisArg) {\n  var index, iterable = collection, result = iterable;\n  if (!iterable) return result;\n  if (!objectTypes[typeof iterable]) return result;\n  callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n    var ownIndex = -1,\n        ownProps = objectTypes[typeof iterable] && keys(iterable),\n        length = ownProps ? ownProps.length : 0;\n\n    while (++ownIndex < length) {\n      index = ownProps[ownIndex];\n      if (callback(iterable[index], index, collection) === false) return result;\n    }\n  return result\n};\n\nmodule.exports = forOwn;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar isObject = require('lodash.isobject'),\n    noop = require('lodash.noop'),\n    reNative = require('lodash._renative');\n\n/* Native method shortcuts for methods with the same name as other `lodash` methods */\nvar nativeCreate = reNative.test(nativeCreate = Object.create) && nativeCreate;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} prototype The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nfunction baseCreate(prototype, properties) {\n  return isObject(prototype) ? nativeCreate(prototype) : {};\n}\n// fallback for browsers without `Object.create`\nif (!nativeCreate) {\n  baseCreate = (function() {\n    function Object() {}\n    return function(prototype) {\n      if (isObject(prototype)) {\n        Object.prototype = prototype;\n        var result = new Object;\n        Object.prototype = null;\n      }\n      return result || global.Object();\n    };\n  }());\n}\n\nmodule.exports = baseCreate;\n","var metric\n  , imperial;\n\nmetric = {\n  ea: {\n    name: {\n      singular: 'Each'\n    , plural: 'Each'\n    }\n  , to_anchor: 1\n  },\n  dz: {\n    name: {\n      singular: 'Dozen'\n    , plural: 'Dozens'\n    }\n  , to_anchor: 12\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: {}\n, _anchors: {\n    metric: {\n      unit: 'ea'\n    , ratio: 1\n    }\n  }\n};\n","var reactivePower;\n\nreactivePower = {\n  VAR: {\n    name: {\n      singular: 'Volt-Ampere Reactive'\n    , plural: 'Volt-Amperes Reactive'\n    }\n  , to_anchor: 1\n  }\n, mVAR: {\n    name: {\n      singular: 'Millivolt-Ampere Reactive'\n      , plural: 'Millivolt-Amperes Reactive'\n    }\n    , to_anchor: .001\n  }\n, kVAR: {\n    name: {\n      singular: 'Kilovolt-Ampere Reactive'\n    , plural: 'Kilovolt-Amperes Reactive'\n    }\n  , to_anchor: 1000\n  }\n, MVAR: {\n    name: {\n      singular: 'Megavolt-Ampere Reactive'\n    , plural: 'Megavolt-Amperes Reactive'\n    }\n  , to_anchor: 1000000\n  }\n, GVAR: {\n    name: {\n      singular: 'Gigavolt-Ampere Reactive'\n    , plural: 'Gigavolt-Amperes Reactive'\n    }\n  , to_anchor: 1000000000\n  }\n};\n\nmodule.exports = {\n  metric: reactivePower\n, _anchors: {\n    metric: {\n      unit: 'VAR'\n    , ratio: 1\n    }\n  }\n};\n","var angle;\n\nangle = {\n  rad: {\n    name: {\n      singular: 'radian'\n    , plural: 'radians'\n    }\n  , to_anchor: 180/Math.PI\n  }\n, deg: {\n    name: {\n      singular: 'degree'\n    , plural: 'degrees'\n    }\n  , to_anchor: 1\n  }\n, grad: {\n    name: {\n      singular: 'gradian'\n    , plural: 'gradians'\n    }\n  , to_anchor: 9/10\n  }\n, arcmin: {\n    name: {\n      singular: 'arcminute'\n    , plural: 'arcminutes'\n    }\n  , to_anchor: 1/60\n  }\n, arcsec: {\n    name: {\n      singular: 'arcsecond'\n    , plural: 'arcseconds'\n    }\n  , to_anchor: 1/3600\n  }\n};\n\nmodule.exports = {\n  metric: angle\n, _anchors: {\n    metric: {\n      unit: 'deg'\n    , ratio: 1\n    }\n  }\n};\n","var metric\n  , imperial;\n\nmetric = {\n  'm/s': {\n    name: {\n      singular: 'Metre per second'\n    , plural: 'Metres per second'\n    }\n  , to_anchor: 3.6\n  }\n, 'km/h': {\n    name: {\n      singular: 'Kilometre per hour'\n    , plural: 'Kilometres per hour'\n    }\n  , to_anchor: 1\n  }\n}\n\n  imperial = {\n    'm/h': {\n      name: {\n        singular: 'Mile per hour'\n      , plural: 'Miles per hour'\n      }\n    , to_anchor: 1\n    }\n  , knot: {\n      name: {\n        singular: 'Knot'\n      , plural: 'Knots'\n      }\n    , to_anchor: 1.150779\n    }\n  , 'ft/s': {\n      name: {\n        singular: 'Foot per second'\n      , plural: 'Feet per second'\n      }\n    , to_anchor: 0.681818\n      }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'km/h'\n    , ratio: 1/1.609344\n    }\n  , imperial: {\n      unit: 'm/h'\n    , ratio: 1.609344\n    }\n  }\n};\n","var metric\n  , imperial;\n\nmetric = {\n  mcg: {\n    name: {\n      singular: 'Microgram'\n    , plural: 'Micrograms'\n    }\n  , to_anchor: 1/1000000\n  }\n, mg: {\n    name: {\n      singular: 'Milligram'\n    , plural: 'Milligrams'\n    }\n  , to_anchor: 1/1000\n  }\n, g: {\n    name: {\n      singular: 'Gram'\n    , plural: 'Grams'\n    }\n  , to_anchor: 1\n  }\n, kg: {\n    name: {\n      singular: 'Kilogram'\n    , plural: 'Kilograms'\n    }\n  , to_anchor: 1000\n}\n, mt: {\n    name: {\n      singular: 'Metric Tonne'\n    , plural: 'Metric Tonnes'\n    }\n  , to_anchor: 1000000\n  }\n};\n\nimperial = {\n  oz: {\n    name: {\n      singular: 'Ounce'\n    , plural: 'Ounces'\n    }\n  , to_anchor: 1/16\n  }\n, lb: {\n    name: {\n      singular: 'Pound'\n    , plural: 'Pounds'\n    }\n  , to_anchor: 1\n}, t: {\n  name: {\n    singular: 'Ton',\n    plural: 'Tons',\n  },\n    to_anchor: 2000,\n  },\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'g'\n    , ratio: 1/453.592\n    }\n  , imperial: {\n      unit: 'lb'\n    , ratio: 453.592\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar baseBind = require('lodash._basebind'),\n    baseCreateWrapper = require('lodash._basecreatewrapper'),\n    isFunction = require('lodash.isfunction');\n\n/**\n * Used for `Array` method references.\n *\n * Normally `Array.prototype` would suffice, however, using an array literal\n * avoids issues in Narwhal.\n */\nvar arrayRef = [];\n\n/** Native method shortcuts */\nvar push = arrayRef.push;\n\n/**\n * Creates a function that, when called, either curries or invokes `func`\n * with an optional `this` binding and partially applied arguments.\n *\n * @private\n * @param {Function|string} func The function or method name to reference.\n * @param {number} bitmask The bitmask of method flags to compose.\n *  The bitmask may be composed of the following flags:\n *  1 - `_.bind`\n *  2 - `_.bindKey`\n *  4 - `_.curry`\n *  8 - `_.curry` (bound)\n *  16 - `_.partial`\n *  32 - `_.partialRight`\n * @param {Array} [partialArgs] An array of arguments to prepend to those\n *  provided to the new function.\n * @param {Array} [partialRightArgs] An array of arguments to append to those\n *  provided to the new function.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new function.\n */\nfunction createWrapper(func, bitmask, partialArgs, partialRightArgs, thisArg, arity) {\n  var isBind = bitmask & 1,\n      isBindKey = bitmask & 2,\n      isCurry = bitmask & 4,\n      isCurryBound = bitmask & 8,\n      isPartial = bitmask & 16,\n      isPartialRight = bitmask & 32;\n\n  if (!isBindKey && !isFunction(func)) {\n    throw new TypeError;\n  }\n  if (isPartial && !partialArgs.length) {\n    bitmask &= ~16;\n    isPartial = partialArgs = false;\n  }\n  if (isPartialRight && !partialRightArgs.length) {\n    bitmask &= ~32;\n    isPartialRight = partialRightArgs = false;\n  }\n  var bindData = func && func.__bindData__;\n  if (bindData && bindData !== true) {\n    bindData = bindData.slice();\n\n    // set `thisBinding` is not previously bound\n    if (isBind && !(bindData[1] & 1)) {\n      bindData[4] = thisArg;\n    }\n    // set if previously bound but not currently (subsequent curried functions)\n    if (!isBind && bindData[1] & 1) {\n      bitmask |= 8;\n    }\n    // set curried arity if not yet set\n    if (isCurry && !(bindData[1] & 4)) {\n      bindData[5] = arity;\n    }\n    // append partial left arguments\n    if (isPartial) {\n      push.apply(bindData[2] || (bindData[2] = []), partialArgs);\n    }\n    // append partial right arguments\n    if (isPartialRight) {\n      push.apply(bindData[3] || (bindData[3] = []), partialRightArgs);\n    }\n    // merge flags\n    bindData[1] |= bitmask;\n    return createWrapper.apply(null, bindData);\n  }\n  // fast path for `_.bind`\n  var creater = (bitmask == 1 || bitmask === 17) ? baseBind : baseCreateWrapper;\n  return creater([func, bitmask, partialArgs, partialRightArgs, thisArg, arity]);\n}\n\nmodule.exports = createWrapper;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar baseCreate = require('lodash._basecreate'),\n    isObject = require('lodash.isobject'),\n    setBindData = require('lodash._setbinddata');\n\n/**\n * Used for `Array` method references.\n *\n * Normally `Array.prototype` would suffice, however, using an array literal\n * avoids issues in Narwhal.\n */\nvar arrayRef = [];\n\n/** Native method shortcuts */\nvar push = arrayRef.push;\n\n/**\n * The base implementation of `_.bind` that creates the bound function and\n * sets its meta data.\n *\n * @private\n * @param {Array} bindData The bind data array.\n * @returns {Function} Returns the new bound function.\n */\nfunction baseBind(bindData) {\n  var func = bindData[0],\n      partialArgs = bindData[2],\n      thisArg = bindData[4];\n\n  function bound() {\n    // `Function#bind` spec\n    // http://es5.github.io/#x15.3.4.5\n    if (partialArgs) {\n      var args = partialArgs.slice();\n      push.apply(args, arguments);\n    }\n    // mimic the constructor's `return` behavior\n    // http://es5.github.io/#x13.2.2\n    if (this instanceof bound) {\n      // ensure `new bound` is an instance of `func`\n      var thisBinding = baseCreate(func.prototype),\n          result = func.apply(thisBinding, args || arguments);\n      return isObject(result) ? result : thisBinding;\n    }\n    return func.apply(thisArg, args || arguments);\n  }\n  setBindData(bound, bindData);\n  return bound;\n}\n\nmodule.exports = baseBind;\n","var time;\nvar daysInYear = 365.25;\n\ntime = {\n  ns: {\n    name: {\n      singular: 'Nanosecond'\n    , plural: 'Nanoseconds'\n    }\n  , to_anchor: 1/1000000000\n  }\n, mu: {\n    name: {\n      singular: 'Microsecond'\n    , plural: 'Microseconds'\n    }\n  , to_anchor: 1/1000000\n  }\n, ms: {\n    name: {\n      singular: 'Millisecond'\n    , plural: 'Milliseconds'\n    }\n  , to_anchor: 1/1000\n  }\n, s: {\n    name: {\n      singular: 'Second'\n    , plural: 'Seconds'\n    }\n  , to_anchor: 1\n  }\n, min: {\n    name: {\n      singular: 'Minute'\n    , plural: 'Minutes'\n    }\n  , to_anchor: 60\n  }\n, h: {\n    name: {\n      singular: 'Hour'\n    , plural: 'Hours'\n    }\n  , to_anchor: 60 * 60 \n  }\n, d: {\n    name: {\n      singular: 'Day'\n    , plural: 'Days'\n    }\n  , to_anchor: 60 * 60 * 24\n  }\n, week: {\n    name: {\n      singular: 'Week'\n    , plural: 'Weeks'\n    }\n  , to_anchor: 60 * 60 * 24 * 7\n  }\n, month: {\n    name: {\n      singular: 'Month'\n    , plural: 'Months'\n    }\n  , to_anchor: 60 * 60 * 24 * daysInYear / 12\n  }\n, year: {\n    name: {\n      singular: 'Year'\n    , plural: 'Years'\n    }\n  , to_anchor: 60 * 60 * 24 * daysInYear\n  }\n};\n\n\nmodule.exports = {\n  metric: time \n, _anchors: {\n    metric: {\n      unit: 's'\n    , ratio: 1\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar isObject = require('lodash.isobject'),\n    reNative = require('lodash._renative'),\n    shimKeys = require('lodash._shimkeys');\n\n/* Native method shortcuts for methods with the same name as other `lodash` methods */\nvar nativeKeys = reNative.test(nativeKeys = Object.keys) && nativeKeys;\n\n/**\n * Creates an array composed of the own enumerable property names of an object.\n *\n * @static\n * @memberOf _\n * @category Objects\n * @param {Object} object The object to inspect.\n * @returns {Array} Returns an array of property names.\n * @example\n *\n * _.keys({ 'one': 1, 'two': 2, 'three': 3 });\n * // => ['one', 'two', 'three'] (property order is not guaranteed across environments)\n */\nvar keys = !nativeKeys ? shimKeys : function(object) {\n  if (!isObject(object)) {\n    return [];\n  }\n  return nativeKeys(object);\n};\n\nmodule.exports = keys;\n","module.exports.RADIUS = 6378137;\nmodule.exports.FLATTENING = 1/298.257223563;\nmodule.exports.POLAR_RADIUS = 6356752.3142;\n","var metric\n  , imperial;\n\nmetric = {\n  C: {\n    name: {\n      singular: 'degree Celsius'\n    , plural: 'degrees Celsius'\n    }\n  , to_anchor: 1\n  , anchor_shift: 0\n  },\n  K: {\n    name: {\n      singular: 'degree Kelvin'\n    , plural: 'degrees Kelvin'\n    }\n  , to_anchor: 1\n  , anchor_shift: 273.15\n  }\n};\n\nimperial = {\n  F: {\n    name: {\n      singular: 'degree Fahrenheit'\n    , plural: 'degrees Fahrenheit'\n    }\n  , to_anchor: 1\n  },\n  R: {\n    name: {\n      singular: 'degree Rankine'\n    , plural: 'degrees Rankine'\n    }\n  , to_anchor: 1\n  , anchor_shift: 459.67\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'C'\n    , transform: function (C) { return C / (5/9) + 32 }\n    }\n  , imperial: {\n      unit: 'F'\n    , transform: function (F) { return (F - 32) * (5/9) }\n    }\n  }\n};\n\n","var convert\n  , keys = require('lodash.keys')\n  , each = require('lodash.foreach')\n  , measures = {\n      length: require('./definitions/length')\n    , area: require('./definitions/area')\n    , mass: require('./definitions/mass')\n    , volume: require('./definitions/volume')\n    , each: require('./definitions/each')\n    , temperature: require('./definitions/temperature')\n    , time: require('./definitions/time')\n    , digital: require('./definitions/digital')\n    , partsPer: require('./definitions/partsPer')\n    , speed: require('./definitions/speed')\n    , pace: require('./definitions/pace')\n    , pressure: require('./definitions/pressure')\n    , current: require('./definitions/current')\n    , voltage: require('./definitions/voltage')\n    , power: require('./definitions/power')\n    , reactivePower: require('./definitions/reactivePower')\n    , apparentPower: require('./definitions/apparentPower')\n    , energy: require('./definitions/energy')\n    , reactiveEnergy: require('./definitions/reactiveEnergy')\n    , volumeFlowRate: require('./definitions/volumeFlowRate')\n    , illuminance: require('./definitions/illuminance')\n    , frequency: require('./definitions/frequency')\n    , angle : require('./definitions/angle')\n    }\n  , Converter;\n\nConverter = function (numerator, denominator) {\n  if(denominator)\n    this.val = numerator / denominator;\n  else\n    this.val = numerator;\n};\n\n/**\n* Lets the converter know the source unit abbreviation\n*/\nConverter.prototype.from = function (from) {\n  if(this.destination)\n    throw new Error('.from must be called before .to');\n\n  this.origin = this.getUnit(from);\n\n  if(!this.origin) {\n    this.throwUnsupportedUnitError(from);\n  }\n\n  return this;\n};\n\n/**\n* Converts the unit and returns the value\n*/\nConverter.prototype.to = function (to) {\n  if(!this.origin)\n    throw new Error('.to must be called after .from');\n\n  this.destination = this.getUnit(to);\n\n  var result\n    , transform;\n\n  if(!this.destination) {\n    this.throwUnsupportedUnitError(to);\n  }\n\n  // Don't change the value if origin and destination are the same\n  if (this.origin.abbr === this.destination.abbr) {\n    return this.val;\n  }\n\n  // You can't go from liquid to mass, for example\n  if(this.destination.measure != this.origin.measure) {\n    throw new Error('Cannot convert incompatible measures of '\n      + this.destination.measure + ' and ' + this.origin.measure);\n  }\n\n  /**\n  * Convert from the source value to its anchor inside the system\n  */\n  result = this.val * this.origin.unit.to_anchor;\n\n  /**\n  * For some changes it's a simple shift (C to K)\n  * So we'll add it when convering into the unit (later)\n  * and subtract it when converting from the unit\n  */\n  if (this.origin.unit.anchor_shift) {\n    result -= this.origin.unit.anchor_shift\n  }\n\n  /**\n  * Convert from one system to another through the anchor ratio. Some conversions\n  * aren't ratio based or require more than a simple shift. We can provide a custom\n  * transform here to provide the direct result\n  */\n  if(this.origin.system != this.destination.system) {\n    transform = measures[this.origin.measure]._anchors[this.origin.system].transform;\n    if (typeof transform === 'function') {\n      result = transform(result)\n    }\n    else {\n      result *= measures[this.origin.measure]._anchors[this.origin.system].ratio;\n    }\n  }\n\n  /**\n  * This shift has to be done after the system conversion business\n  */\n  if (this.destination.unit.anchor_shift) {\n    result += this.destination.unit.anchor_shift;\n  }\n\n  /**\n  * Convert to another unit inside the destination system\n  */\n  return result / this.destination.unit.to_anchor;\n};\n\n/**\n* Converts the unit to the best available unit.\n*/\nConverter.prototype.toBest = function(options) {\n  if(!this.origin)\n    throw new Error('.toBest must be called after .from');\n\n  var options = Object.assign({\n    exclude: [],\n    cutOffNumber: 1,\n  }, options)\n\n  var best;\n  /**\n    Looks through every possibility for the 'best' available unit.\n    i.e. Where the value has the fewest numbers before the decimal point,\n    but is still higher than 1.\n  */\n  each(this.possibilities(), function(possibility) {\n    var unit = this.describe(possibility);\n    var isIncluded = options.exclude.indexOf(possibility) === -1;\n\n    if (isIncluded && unit.system === this.origin.system) {\n      var result = this.to(possibility);\n      if (!best || (result >= options.cutOffNumber && result < best.val)) {\n        best = {\n          val: result,\n          unit: possibility,\n          singular: unit.singular,\n          plural: unit.plural\n        };\n      }\n    }\n  }.bind(this));\n\n  return best;\n}\n\n/**\n* Finds the unit\n*/\nConverter.prototype.getUnit = function (abbr) {\n  var found;\n\n  each(measures, function (systems, measure) {\n    each(systems, function (units, system) {\n      if(system == '_anchors')\n        return false;\n\n      each(units, function (unit, testAbbr) {\n        if(testAbbr == abbr) {\n          found = {\n            abbr: abbr\n          , measure: measure\n          , system: system\n          , unit: unit\n          };\n          return false;\n        }\n      });\n\n      if(found)\n        return false;\n    });\n\n    if(found)\n      return false;\n  });\n\n  return found;\n};\n\nvar describe = function(resp) {\n  return {\n    abbr: resp.abbr\n  , measure: resp.measure\n  , system: resp.system\n  , singular: resp.unit.name.singular\n  , plural: resp.unit.name.plural\n  };\n}\n\n/**\n* An alias for getUnit\n*/\nConverter.prototype.describe = function (abbr) {\n  var resp = Converter.prototype.getUnit(abbr);\n  var desc = null;\n\n  try {\n    desc = describe(resp);\n  } catch(err) {\n    this.throwUnsupportedUnitError(abbr);\n  }\n\n  return desc;\n};\n\n/**\n* Detailed list of all supported units\n*/\nConverter.prototype.list = function (measure) {\n  var list = [];\n\n  each(measures, function (systems, testMeasure) {\n    if(measure && measure !== testMeasure)\n      return;\n\n    each(systems, function (units, system) {\n      if(system == '_anchors')\n        return false;\n\n      each(units, function (unit, abbr) {\n        list = list.concat(describe({\n          abbr: abbr,\n          measure: testMeasure\n        , system: system\n        , unit: unit\n        }));\n      });\n    });\n  });\n\n  return list;\n};\n\nConverter.prototype.throwUnsupportedUnitError = function (what) {\n  var validUnits = [];\n\n  each(measures, function (systems, measure) {\n    each(systems, function (units, system) {\n      if(system == '_anchors')\n        return false;\n\n      validUnits = validUnits.concat(keys(units));\n    });\n  });\n\n  throw new Error('Unsupported unit ' + what + ', use one of: ' + validUnits.join(', '));\n}\n\n/**\n* Returns the abbreviated measures that the value can be\n* converted to.\n*/\nConverter.prototype.possibilities = function (measure) {\n  var possibilities = [];\n  if(!this.origin && !measure) {\n\t  each(keys(measures), function (measure){\n\t\t  each(measures[measure], function (units, system) {\n\t\t    if(system == '_anchors')\n\t\t      return false;\n\n\t\t    possibilities = possibilities.concat(keys(units));\n\t\t  });\n\t  });\n  } else {\n\t  measure = measure || this.origin.measure;\n\t  each(measures[measure], function (units, system) {\n\t    if(system == '_anchors')\n\t      return false;\n\n\t    possibilities = possibilities.concat(keys(units));\n\t  });\n  }\n\n  return possibilities;\n};\n\n/**\n* Returns the abbreviated measures that the value can be\n* converted to.\n*/\nConverter.prototype.measures = function () {\n  return keys(measures);\n};\n\nconvert = function (value) {\n  return new Converter(value);\n};\n\nmodule.exports = convert;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar objectTypes = require('lodash._objecttypes');\n\n/**\n * Checks if `value` is the language type of Object.\n * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @category Objects\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if the `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(1);\n * // => false\n */\nfunction isObject(value) {\n  // check if the value is the ECMAScript language type of Object\n  // http://es5.github.io/#x8\n  // and avoid a V8 bug\n  // http://code.google.com/p/v8/issues/detail?id=2291\n  return !!(value && objectTypes[typeof value]);\n}\n\nmodule.exports = isObject;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/**\n * Checks if `value` is a function.\n *\n * @static\n * @memberOf _\n * @category Objects\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if the `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n */\nfunction isFunction(value) {\n  return typeof value == 'function';\n}\n\nmodule.exports = isFunction;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/**\n * A no-operation function.\n *\n * @static\n * @memberOf _\n * @category Utilities\n * @example\n *\n * var object = { 'name': 'fred' };\n * _.noop(object) === undefined;\n * // => true\n */\nfunction noop() {\n  // no operation performed\n}\n\nmodule.exports = noop;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar baseCreate = require('lodash._basecreate'),\n    isObject = require('lodash.isobject'),\n    setBindData = require('lodash._setbinddata'),\n    slice = require('lodash._slice');\n\n/**\n * Used for `Array` method references.\n *\n * Normally `Array.prototype` would suffice, however, using an array literal\n * avoids issues in Narwhal.\n */\nvar arrayRef = [];\n\n/** Native method shortcuts */\nvar push = arrayRef.push;\n\n/**\n * The base implementation of `createWrapper` that creates the wrapper and\n * sets its meta data.\n *\n * @private\n * @param {Array} bindData The bind data array.\n * @returns {Function} Returns the new function.\n */\nfunction baseCreateWrapper(bindData) {\n  var func = bindData[0],\n      bitmask = bindData[1],\n      partialArgs = bindData[2],\n      partialRightArgs = bindData[3],\n      thisArg = bindData[4],\n      arity = bindData[5];\n\n  var isBind = bitmask & 1,\n      isBindKey = bitmask & 2,\n      isCurry = bitmask & 4,\n      isCurryBound = bitmask & 8,\n      key = func;\n\n  function bound() {\n    var thisBinding = isBind ? thisArg : this;\n    if (partialArgs) {\n      var args = partialArgs.slice();\n      push.apply(args, arguments);\n    }\n    if (partialRightArgs || isCurry) {\n      args || (args = slice(arguments));\n      if (partialRightArgs) {\n        push.apply(args, partialRightArgs);\n      }\n      if (isCurry && args.length < arity) {\n        bitmask |= 16 & ~32;\n        return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3), args, null, thisArg, arity]);\n      }\n    }\n    args || (args = arguments);\n    if (isBindKey) {\n      func = thisBinding[key];\n    }\n    if (this instanceof bound) {\n      thisBinding = baseCreate(func.prototype);\n      var result = func.apply(thisBinding, args);\n      return isObject(result) ? result : thisBinding;\n    }\n    return func.apply(thisBinding, args);\n  }\n  setBindData(bound, bindData);\n  return bound;\n}\n\nmodule.exports = baseCreateWrapper;\n","var wgs84 = require('wgs84');\n\nmodule.exports.geometry = geometry;\nmodule.exports.ring = ringArea;\n\nfunction geometry(_) {\n    var area = 0, i;\n    switch (_.type) {\n        case 'Polygon':\n            return polygonArea(_.coordinates);\n        case 'MultiPolygon':\n            for (i = 0; i < _.coordinates.length; i++) {\n                area += polygonArea(_.coordinates[i]);\n            }\n            return area;\n        case 'Point':\n        case 'MultiPoint':\n        case 'LineString':\n        case 'MultiLineString':\n            return 0;\n        case 'GeometryCollection':\n            for (i = 0; i < _.geometries.length; i++) {\n                area += geometry(_.geometries[i]);\n            }\n            return area;\n    }\n}\n\nfunction polygonArea(coords) {\n    var area = 0;\n    if (coords && coords.length > 0) {\n        area += Math.abs(ringArea(coords[0]));\n        for (var i = 1; i < coords.length; i++) {\n            area -= Math.abs(ringArea(coords[i]));\n        }\n    }\n    return area;\n}\n\n/**\n * Calculate the approximate area of the polygon were it projected onto\n *     the earth.  Note that this area will be positive if ring is oriented\n *     clockwise, otherwise it will be negative.\n *\n * Reference:\n * Robert. G. Chamberlain and William H. Duquette, \"Some Algorithms for\n *     Polygons on a Sphere\", JPL Publication 07-03, Jet Propulsion\n *     Laboratory, Pasadena, CA, June 2007 http://trs-new.jpl.nasa.gov/dspace/handle/2014/40409\n *\n * Returns:\n * {float} The approximate signed geodesic area of the polygon in square\n *     meters.\n */\n\nfunction ringArea(coords) {\n    var p1, p2, p3, lowerIndex, middleIndex, upperIndex, i,\n    area = 0,\n    coordsLength = coords.length;\n\n    if (coordsLength > 2) {\n        for (i = 0; i < coordsLength; i++) {\n            if (i === coordsLength - 2) {// i = N-2\n                lowerIndex = coordsLength - 2;\n                middleIndex = coordsLength -1;\n                upperIndex = 0;\n            } else if (i === coordsLength - 1) {// i = N-1\n                lowerIndex = coordsLength - 1;\n                middleIndex = 0;\n                upperIndex = 1;\n            } else { // i = 0 to N-3\n                lowerIndex = i;\n                middleIndex = i+1;\n                upperIndex = i+2;\n            }\n            p1 = coords[lowerIndex];\n            p2 = coords[middleIndex];\n            p3 = coords[upperIndex];\n            area += ( rad(p3[0]) - rad(p1[0]) ) * Math.sin( rad(p2[1]));\n        }\n\n        area = area * wgs84.RADIUS * wgs84.RADIUS / 2;\n    }\n\n    return area;\n}\n\nfunction rad(_) {\n    return _ * Math.PI / 180;\n}","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar noop = require('lodash.noop'),\n    reNative = require('lodash._renative');\n\n/** Used as the property descriptor for `__bindData__` */\nvar descriptor = {\n  'configurable': false,\n  'enumerable': false,\n  'value': null,\n  'writable': false\n};\n\n/** Used to set meta data on functions */\nvar defineProperty = (function() {\n  // IE 8 only accepts DOM elements\n  try {\n    var o = {},\n        func = reNative.test(func = Object.defineProperty) && func,\n        result = func(o, o, o) && func;\n  } catch(e) { }\n  return result;\n}());\n\n/**\n * Sets `this` binding data on a given function.\n *\n * @private\n * @param {Function} func The function to set data on.\n * @param {Array} value The data array to set.\n */\nvar setBindData = !defineProperty ? noop : function(func, value) {\n  descriptor.value = value;\n  defineProperty(func, '__bindData__', descriptor);\n};\n\nmodule.exports = setBindData;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar baseCreateCallback = require('lodash._basecreatecallback'),\n    forOwn = require('lodash.forown');\n\n/**\n * Iterates over elements of a collection, executing the callback for each\n * element. The callback is bound to `thisArg` and invoked with three arguments;\n * (value, index|key, collection). Callbacks may exit iteration early by\n * explicitly returning `false`.\n *\n * Note: As with other \"Collections\" methods, objects with a `length` property\n * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n * may be used for object iteration.\n *\n * @static\n * @memberOf _\n * @alias each\n * @category Collections\n * @param {Array|Object|string} collection The collection to iterate over.\n * @param {Function} [callback=identity] The function called per iteration.\n * @param {*} [thisArg] The `this` binding of `callback`.\n * @returns {Array|Object|string} Returns `collection`.\n * @example\n *\n * _([1, 2, 3]).forEach(function(num) { console.log(num); }).join(',');\n * // => logs each number and returns '1,2,3'\n *\n * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { console.log(num); });\n * // => logs each number and returns the object (property order is not guaranteed across environments)\n */\nfunction forEach(collection, callback, thisArg) {\n  var index = -1,\n      length = collection ? collection.length : 0;\n\n  callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n  if (typeof length == 'number') {\n    while (++index < length) {\n      if (callback(collection[index], index, collection) === false) {\n        break;\n      }\n    }\n  } else {\n    forOwn(collection, callback);\n  }\n  return collection;\n}\n\nmodule.exports = forEach;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/** Used to determine if values are of the language type Object */\nvar objectTypes = {\n  'boolean': false,\n  'function': true,\n  'object': true,\n  'number': false,\n  'string': false,\n  'undefined': false\n};\n\nmodule.exports = objectTypes;\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar reNative = require('lodash._renative');\n\n/** Used to detect functions containing a `this` reference */\nvar reThis = /\\bthis\\b/;\n\n/**\n * An object used to flag environments features.\n *\n * @static\n * @memberOf _\n * @type Object\n */\nvar support = {};\n\n/**\n * Detect if functions can be decompiled by `Function#toString`\n * (all but PS3 and older Opera mobile browsers & avoided in Windows 8 apps).\n *\n * @memberOf _.support\n * @type boolean\n */\nsupport.funcDecomp = !reNative.test(global.WinRTError) && reThis.test(function() { return this; });\n\n/**\n * Detect if `Function#name` is supported (all but IE).\n *\n * @memberOf _.support\n * @type boolean\n */\nsupport.funcNames = typeof Function.name == 'string';\n\nmodule.exports = support;\n","var metric\n  , imperial;\n\nmetric = {\n  'mm3/s': {\n      name: {\n        singular: 'Cubic Millimeter per second'\n      , plural: 'Cubic Millimeters per second'\n      }\n    , to_anchor: 1/1000000\n  }\n, 'cm3/s': {\n    name: {\n      singular: 'Cubic Centimeter per second'\n    , plural: 'Cubic Centimeters per second'\n    }\n  , to_anchor: 1/1000\n  }\n, 'ml/s': {\n    name: {\n      singular: 'Millilitre per second'\n    , plural: 'Millilitres per second'\n    }\n  , to_anchor: 1/1000\n  }\n, 'cl/s': {\n    name: {\n      singular: 'Centilitre per second'\n    , plural: 'Centilitres per second'\n    }\n  , to_anchor: 1/100\n  }\n, 'dl/s': {\n    name: {\n      singular: 'Decilitre per second'\n    , plural: 'Decilitres per second'\n    }\n  , to_anchor: 1/10\n  }\n, 'l/s': {\n    name: {\n      singular: 'Litre per second'\n    , plural: 'Litres per second'\n    }\n  , to_anchor: 1\n  }\n, 'l/min': {\n    name: {\n      singular: 'Litre per minute'\n    , plural: 'Litres per minute'\n    }\n  , to_anchor: 1/60\n  }\n, 'l/h': {\n    name: {\n      singular: 'Litre per hour'\n    , plural: 'Litres per hour'\n    }\n  , to_anchor: 1/3600\n  }\n, 'kl/s': {\n    name: {\n      singular: 'Kilolitre per second'\n    , plural: 'Kilolitres per second'\n    }\n  , to_anchor: 1000\n  }\n, 'kl/min': {\n    name: {\n      singular: 'Kilolitre per minute'\n    , plural: 'Kilolitres per minute'\n    }\n  , to_anchor: 50/3\n  }\n, 'kl/h': {\n    name: {\n      singular: 'Kilolitre per hour'\n    , plural: 'Kilolitres per hour'\n    }\n  , to_anchor: 5/18\n  }\n, 'm3/s': {\n    name: {\n      singular: 'Cubic meter per second'\n    , plural: 'Cubic meters per second'\n    }\n  , to_anchor: 1000\n  }\n, 'm3/min': {\n    name: {\n      singular: 'Cubic meter per minute'\n    , plural: 'Cubic meters per minute'\n    }\n  , to_anchor: 50/3\n  }\n, 'm3/h': {\n    name: {\n      singular: 'Cubic meter per hour'\n    , plural: 'Cubic meters per hour'\n    }\n  , to_anchor: 5/18\n  }\n, 'km3/s': {\n    name: {\n      singular: 'Cubic kilometer per second'\n    , plural: 'Cubic kilometers per second'\n    }\n  , to_anchor: 1000000000000\n  }\n};\n\nimperial = {\n  'tsp/s': {\n    name: {\n      singular: 'Teaspoon per second'\n    , plural: 'Teaspoons per second'\n    }\n  , to_anchor: 1/6\n  }\n, 'Tbs/s': {\n    name: {\n      singular: 'Tablespoon per second'\n    , plural: 'Tablespoons per second'\n    }\n  , to_anchor: 1/2\n  }\n, 'in3/s': {\n    name: {\n      singular: 'Cubic inch per second'\n    , plural: 'Cubic inches per second'\n    }\n  , to_anchor: 0.55411\n  }\n, 'in3/min': {\n    name: {\n      singular: 'Cubic inch per minute'\n    , plural: 'Cubic inches per minute'\n    }\n  , to_anchor: 0.55411/60\n  }\n, 'in3/h': {\n    name: {\n      singular: 'Cubic inch per hour'\n    , plural: 'Cubic inches per hour'\n    }\n  , to_anchor: 0.55411/3600\n  }\n, 'fl-oz/s': {\n    name: {\n      singular: 'Fluid Ounce per second'\n    , plural: 'Fluid Ounces per second'\n    }\n  , to_anchor: 1\n  }\n, 'fl-oz/min': {\n    name: {\n      singular: 'Fluid Ounce per minute'\n    , plural: 'Fluid Ounces per minute'\n    }\n  , to_anchor: 1/60\n  }\n, 'fl-oz/h': {\n    name: {\n      singular: 'Fluid Ounce per hour'\n    , plural: 'Fluid Ounces per hour'\n    }\n  , to_anchor: 1/3600\n  }\n, 'cup/s': {\n    name: {\n      singular: 'Cup per second'\n    , plural: 'Cups per second'\n    }\n  , to_anchor: 8\n  }\n, 'pnt/s': {\n    name: {\n      singular: 'Pint per second'\n    , plural: 'Pints per second'\n    }\n  , to_anchor: 16\n  }\n, 'pnt/min': {\n    name: {\n      singular: 'Pint per minute'\n    , plural: 'Pints per minute'\n    }\n  , to_anchor: 4/15\n  }\n, 'pnt/h': {\n    name: {\n      singular: 'Pint per hour'\n    , plural: 'Pints per hour'\n    }\n  , to_anchor: 1/225\n  }\n, 'qt/s': {\n    name: {\n      singular: 'Quart per second'\n    , plural: 'Quarts per second'\n    }\n  , to_anchor: 32\n  }\n, 'gal/s': {\n    name: {\n      singular: 'Gallon per second'\n    , plural: 'Gallons per second'\n    }\n  , to_anchor: 128\n  }\n, 'gal/min': {\n    name: {\n      singular: 'Gallon per minute'\n    , plural: 'Gallons per minute'\n    }\n  , to_anchor: 32/15\n  }\n, 'gal/h': {\n    name: {\n      singular: 'Gallon per hour'\n    , plural: 'Gallons per hour'\n    }\n  , to_anchor: 8/225\n  }\n, 'ft3/s': {\n    name: {\n      singular: 'Cubic foot per second'\n    , plural: 'Cubic feet per second'\n    }\n  , to_anchor: 957.506\n  }\n, 'ft3/min': {\n    name: {\n      singular: 'Cubic foot per minute'\n    , plural: 'Cubic feet per minute'\n    }\n  , to_anchor: 957.506/60\n  }\n, 'ft3/h': {\n    name: {\n      singular: 'Cubic foot per hour'\n    , plural: 'Cubic feet per hour'\n    }\n  , to_anchor: 957.506/3600\n  }\n, 'yd3/s': {\n    name: {\n      singular: 'Cubic yard per second'\n    , plural: 'Cubic yards per second'\n    }\n  , to_anchor: 25852.7\n  }\n, 'yd3/min': {\n    name: {\n      singular: 'Cubic yard per minute'\n    , plural: 'Cubic yards per minute'\n    }\n  , to_anchor: 25852.7/60\n  }\n, 'yd3/h': {\n    name: {\n      singular: 'Cubic yard per hour'\n    , plural: 'Cubic yards per hour'\n    }\n  , to_anchor: 25852.7/3600\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'l/s'\n    , ratio: 33.8140227\n    }\n  , imperial: {\n      unit: 'fl-oz/s'\n    , ratio: 1/33.8140227\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\nvar bind = require('lodash.bind'),\n    identity = require('lodash.identity'),\n    setBindData = require('lodash._setbinddata'),\n    support = require('lodash.support');\n\n/** Used to detected named functions */\nvar reFuncName = /^\\s*function[ \\n\\r\\t]+\\w/;\n\n/** Used to detect functions containing a `this` reference */\nvar reThis = /\\bthis\\b/;\n\n/** Native method shortcuts */\nvar fnToString = Function.prototype.toString;\n\n/**\n * The base implementation of `_.createCallback` without support for creating\n * \"_.pluck\" or \"_.where\" style callbacks.\n *\n * @private\n * @param {*} [func=identity] The value to convert to a callback.\n * @param {*} [thisArg] The `this` binding of the created callback.\n * @param {number} [argCount] The number of arguments the callback accepts.\n * @returns {Function} Returns a callback function.\n */\nfunction baseCreateCallback(func, thisArg, argCount) {\n  if (typeof func != 'function') {\n    return identity;\n  }\n  // exit early for no `thisArg` or already bound by `Function#bind`\n  if (typeof thisArg == 'undefined' || !('prototype' in func)) {\n    return func;\n  }\n  var bindData = func.__bindData__;\n  if (typeof bindData == 'undefined') {\n    if (support.funcNames) {\n      bindData = !func.name;\n    }\n    bindData = bindData || !support.funcDecomp;\n    if (!bindData) {\n      var source = fnToString.call(func);\n      if (!support.funcNames) {\n        bindData = !reFuncName.test(source);\n      }\n      if (!bindData) {\n        // checks if `func` references the `this` keyword and stores the result\n        bindData = reThis.test(source);\n        setBindData(func, bindData);\n      }\n    }\n  }\n  // exit early if there are no `this` references or `func` is bound\n  if (bindData === false || (bindData !== true && bindData[1] & 1)) {\n    return func;\n  }\n  switch (argCount) {\n    case 1: return function(value) {\n      return func.call(thisArg, value);\n    };\n    case 2: return function(a, b) {\n      return func.call(thisArg, a, b);\n    };\n    case 3: return function(value, index, collection) {\n      return func.call(thisArg, value, index, collection);\n    };\n    case 4: return function(accumulator, value, index, collection) {\n      return func.call(thisArg, accumulator, value, index, collection);\n    };\n  }\n  return bind(func, thisArg);\n}\n\nmodule.exports = baseCreateCallback;\n","var reactiveEnergy;\n\nreactiveEnergy = {\n  VARh: {\n    name: {\n      singular: 'Volt-Ampere Reactive Hour'\n    , plural: 'Volt-Amperes Reactive Hour'\n    }\n  , to_anchor: 1\n  }\n, mVARh: {\n    name: {\n      singular: 'Millivolt-Ampere Reactive Hour'\n      , plural: 'Millivolt-Amperes Reactive Hour'\n    }\n    , to_anchor: .001\n  }\n, kVARh: {\n    name: {\n      singular: 'Kilovolt-Ampere Reactive Hour'\n    , plural: 'Kilovolt-Amperes Reactive Hour'\n    }\n  , to_anchor: 1000\n  }\n, MVARh: {\n    name: {\n      singular: 'Megavolt-Ampere Reactive Hour'\n    , plural: 'Megavolt-Amperes Reactive Hour'\n    }\n  , to_anchor: 1000000\n  }\n, GVARh: {\n    name: {\n      singular: 'Gigavolt-Ampere Reactive Hour'\n    , plural: 'Gigavolt-Amperes Reactive Hour'\n    }\n  , to_anchor: 1000000000\n  }\n};\n\nmodule.exports = {\n  metric: reactiveEnergy\n, _anchors: {\n    metric: {\n      unit: 'VARh'\n    , ratio: 1\n    }\n  }\n};\n","/**\n * Lo-Dash 2.3.0 (Custom Build) <http://lodash.com/>\n * Build: `lodash modularize modern exports=\"npm\" -o ./npm/`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n\n/**\n * Slices the `collection` from the `start` index up to, but not including,\n * the `end` index.\n *\n * Note: This function is used instead of `Array#slice` to support node lists\n * in IE < 9 and to ensure dense arrays are returned.\n *\n * @private\n * @param {Array|Object|string} collection The collection to slice.\n * @param {number} start The start index.\n * @param {number} end The end index.\n * @returns {Array} Returns the new array.\n */\nfunction slice(array, start, end) {\n  start || (start = 0);\n  if (typeof end == 'undefined') {\n    end = array ? array.length : 0;\n  }\n  var index = -1,\n      length = end - start || 0,\n      result = Array(length < 0 ? 0 : length);\n\n  while (++index < length) {\n    result[index] = array[start + index];\n  }\n  return result;\n}\n\nmodule.exports = slice;\n","var metric\n  , imperial;\n\nmetric = {\n  mm2: {\n    name: {\n      singular: 'Square Millimeter'\n    , plural: 'Square Millimeters'\n    }\n  , to_anchor: 1/1000000\n  }\n, cm2: {\n    name: {\n      singular: 'Centimeter'\n    , plural: 'Centimeters'\n    }\n  , to_anchor: 1/10000\n  }\n, m2: {\n    name: {\n      singular: 'Square Meter'\n    , plural: 'Square Meters'\n    }\n  , to_anchor: 1\n  }\n, ha: {\n    name: {\n      singular: 'Hectare'\n    , plural: 'Hectares'\n    }\n  , to_anchor: 10000\n  }\n, km2: {\n    name: {\n      singular: 'Square Kilometer'\n    , plural: 'Square Kilometers'\n    }\n  , to_anchor: 1000000\n  }\n};\n\nimperial = {\n  'in2': {\n    name: {\n      singular: 'Square Inch'\n    , plural: 'Square Inches'\n    }\n  , to_anchor: 1/144\n  }\n, yd2: {\n    name: {\n      singular: 'Square Yard'\n    , plural: 'Square Yards'  \n    }\n  , to_anchor: 9\n  }\n, ft2: {\n    name: {\n      singular: 'Square Foot'\n    , plural: 'Square Feet'\n    }\n  , to_anchor: 1\n  }\n, ac: {\n    name: {\n      singular: 'Acre'\n    , plural: 'Acres'\n    }\n  , to_anchor: 43560\n  }\n, mi2: {\n    name: {\n      singular: 'Square Mile'\n    , plural: 'Square Miles'\n    }\n  , to_anchor: 27878400\n  }\n};\n\nmodule.exports = {\n  metric: metric\n, imperial: imperial\n, _anchors: {\n    metric: {\n      unit: 'm2'\n    , ratio: 10.7639\n    }\n  , imperial: {\n      unit: 'ft2'\n    , ratio: 1/10.7639\n    }\n  }\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\nconst ModeHandler = function(mode, DrawContext) {\n\n  const handlers = {\n    drag: [],\n    click: [],\n    mousemove: [],\n    mousedown: [],\n    mouseup: [],\n    mouseout: [],\n    keydown: [],\n    keyup: [],\n    touchstart: [],\n    touchmove: [],\n    touchend: [],\n    tap: []\n  };\n\n  const ctx = {\n    on(event, selector, fn) {\n      if (handlers[event] === undefined) {\n        throw new Error(`Invalid event type: ${event}`);\n      }\n      handlers[event].push({\n        selector,\n        fn\n      });\n    },\n    render(id) {\n      DrawContext.store.featureChanged(id);\n    }\n  };\n\n  const delegate = function (eventName, event) {\n    const handles = handlers[eventName];\n    let iHandle = handles.length;\n    while (iHandle--) {\n      const handle = handles[iHandle];\n      if (handle.selector(event)) {\n        const skipRender = handle.fn.call(ctx, event);\n        if (!skipRender) {\n          DrawContext.store.render();\n        }\n        DrawContext.ui.updateMapClasses();\n\n        // ensure an event is only handled once\n        // we do this to let modes have multiple overlapping selectors\n        // and relay on order of oppertations to filter\n        break;\n      }\n    }\n  };\n\n  mode.start.call(ctx);\n\n  return {\n    render: mode.render,\n    stop() {\n      if (mode.stop) mode.stop();\n    },\n    trash() {\n      if (mode.trash) {\n        mode.trash();\n        DrawContext.store.render();\n      }\n    },\n    combineFeatures() {\n      if (mode.combineFeatures) {\n        mode.combineFeatures();\n      }\n    },\n    uncombineFeatures() {\n      if (mode.uncombineFeatures) {\n        mode.uncombineFeatures();\n      }\n    },\n    drag(event) {\n      delegate('drag', event);\n    },\n    click(event) {\n      delegate('click', event);\n    },\n    mousemove(event) {\n      delegate('mousemove', event);\n    },\n    mousedown(event) {\n      delegate('mousedown', event);\n    },\n    mouseup(event) {\n      delegate('mouseup', event);\n    },\n    mouseout(event) {\n      delegate('mouseout', event);\n    },\n    keydown(event) {\n      delegate('keydown', event);\n    },\n    keyup(event) {\n      delegate('keyup', event);\n    },\n    touchstart(event) {\n      delegate('touchstart', event);\n    },\n    touchmove(event) {\n      delegate('touchmove', event);\n    },\n    touchend(event) {\n      delegate('touchend', event);\n    },\n    tap(event) {\n      delegate('tap', event);\n    }\n  };\n};\n\nexport default ModeHandler;\n","export const classes = {\n  CANVAS: 'mapboxgl-canvas',\n  CONTROL_BASE: 'mapboxgl-ctrl',\n  CONTROL_PREFIX: 'mapboxgl-ctrl-',\n  CONTROL_BUTTON: 'mapbox-gl-draw_ctrl-draw-btn',\n  CONTROL_BUTTON_LINE: 'mapbox-gl-draw_line',\n  CONTROL_BUTTON_POLYGON: 'mapbox-gl-draw_polygon',\n  CONTROL_BUTTON_POINT: 'mapbox-gl-draw_point',\n  CONTROL_BUTTON_TRASH: 'mapbox-gl-draw_trash',\n  CONTROL_BUTTON_COMBINE_FEATURES: 'mapbox-gl-draw_combine',\n  CONTROL_BUTTON_UNCOMBINE_FEATURES: 'mapbox-gl-draw_uncombine',\n  CONTROL_GROUP: 'mapboxgl-ctrl-group',\n  ATTRIBUTION: 'mapboxgl-ctrl-attrib',\n  ACTIVE_BUTTON: 'active',\n  BOX_SELECT: 'mapbox-gl-draw_boxselect'\n};\n\nexport const sources = {\n  HOT: 'mapbox-gl-draw-hot',\n  COLD: 'mapbox-gl-draw-cold'\n};\n\nexport const cursors = {\n  ADD: 'add',\n  MOVE: 'move',\n  DRAG: 'drag',\n  POINTER: 'pointer',\n  NONE: 'none'\n};\n\nexport const types = {\n  POLYGON: 'polygon',\n  LINE: 'line_string',\n  POINT: 'point'\n};\n\nexport const geojsonTypes = {\n  FEATURE: 'Feature',\n  POLYGON: 'Polygon',\n  LINE_STRING: 'LineString',\n  POINT: 'Point',\n  FEATURE_COLLECTION: 'FeatureCollection',\n  MULTI_PREFIX: 'Multi',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon'\n};\n\nexport const modes = {\n  DRAW_LINE_STRING: 'draw_line_string',\n  DRAW_POLYGON: 'draw_polygon',\n  DRAW_POINT: 'draw_point',\n  SIMPLE_SELECT: 'simple_select',\n  DIRECT_SELECT: 'direct_select'\n};\n\nexport const events = {\n  CREATE: 'draw.create',\n  DELETE: 'draw.delete',\n  UPDATE: 'draw.update',\n  SELECTION_CHANGE: 'draw.selectionchange',\n  MODE_CHANGE: 'draw.modechange',\n  ACTIONABLE: 'draw.actionable',\n  RENDER: 'draw.render',\n  COMBINE_FEATURES: 'draw.combine',\n  UNCOMBINE_FEATURES: 'draw.uncombine'\n};\n\nexport const updateActions = {\n  MOVE: 'move',\n  CHANGE_PROPERTIES: 'change_properties',\n  CHANGE_COORDINATES: 'change_coordinates'\n};\n\nexport const meta = {\n  FEATURE: 'feature',\n  MIDPOINT: 'midpoint',\n  VERTEX: 'vertex'\n};\n\nexport const activeStates = {\n  ACTIVE: 'true',\n  INACTIVE: 'false'\n};\n\nexport const interactions = [\n  'scrollZoom',\n  'boxZoom',\n  'dragRotate',\n  'dragPan',\n  'keyboard',\n  'doubleClickZoom',\n  'touchZoomRotate'\n];\n\nexport const LAT_MIN = -90;\nexport const LAT_RENDERED_MIN = -85;\nexport const LAT_MAX = 90;\nexport const LAT_RENDERED_MAX = 85;\nexport const LNG_MIN = -270;\nexport const LNG_MAX = 270;\n","import area from '@mapbox/geojson-area';\nimport * as Constants from '../constants.js';\n\nconst FEATURE_SORT_RANKS = {\n  Point: 0,\n  LineString: 1,\n  MultiLineString: 1,\n  Polygon: 2\n};\n\nfunction comparator(a, b) {\n  const score = FEATURE_SORT_RANKS[a.geometry.type] - FEATURE_SORT_RANKS[b.geometry.type];\n\n  if (score === 0 && a.geometry.type === Constants.geojsonTypes.POLYGON) {\n    return a.area - b.area;\n  }\n\n  return score;\n}\n\n// Sort in the order above, then sort polygons by area ascending.\nfunction sortFeatures(features) {\n  return features.map((feature) => {\n    if (feature.geometry.type === Constants.geojsonTypes.POLYGON) {\n      feature.area = area.geometry({\n        type: Constants.geojsonTypes.FEATURE,\n        property: {},\n        geometry: feature.geometry\n      });\n    }\n    return feature;\n  }).sort(comparator).map((feature) => {\n    delete feature.area;\n    return feature;\n  });\n}\n\nexport default sortFeatures;\n","/**\n * Returns a bounding box representing the event's location.\n *\n * @param {Event} mapEvent - Mapbox GL JS map event, with a point properties.\n * @return {Array<Array<number>>} Bounding box.\n */\nfunction mapEventToBoundingBox(mapEvent, buffer = 0) {\n  return [\n    [mapEvent.point.x - buffer, mapEvent.point.y - buffer],\n    [mapEvent.point.x + buffer, mapEvent.point.y + buffer]\n  ];\n}\n\nexport default mapEventToBoundingBox;\n","function StringSet(items) {\n  this._items = {};\n  this._nums = {};\n  this._length = items ? items.length : 0;\n  if (!items) return;\n  for (let i = 0, l = items.length; i < l; i++) {\n    this.add(items[i]);\n    if (items[i] === undefined) continue;\n    if (typeof items[i] === 'string') this._items[items[i]] = i;\n    else this._nums[items[i]] = i;\n\n  }\n}\n\nStringSet.prototype.add = function(x) {\n  if (this.has(x)) return this;\n  this._length++;\n  if (typeof x === 'string') this._items[x] = this._length;\n  else this._nums[x] = this._length;\n  return this;\n};\n\nStringSet.prototype.delete = function(x) {\n  if (this.has(x) === false) return this;\n  this._length--;\n  delete this._items[x];\n  delete this._nums[x];\n  return this;\n};\n\nStringSet.prototype.has = function(x) {\n  if (typeof x !== 'string' && typeof x !== 'number') return false;\n  return this._items[x] !== undefined || this._nums[x] !== undefined;\n};\n\nStringSet.prototype.values = function() {\n  const values = [];\n  Object.keys(this._items).forEach((k) => {\n    values.push({ k, v: this._items[k] });\n  });\n  Object.keys(this._nums).forEach((k) => {\n    values.push({ k: JSON.parse(k), v: this._nums[k] });\n  });\n\n  return values.sort((a, b) => a.v - b.v).map(a => a.k);\n};\n\nStringSet.prototype.clear = function() {\n  this._length = 0;\n  this._items = {};\n  this._nums = {};\n  return this;\n};\n\nexport default StringSet;\n","import sortFeatures from './sort_features.js';\nimport mapEventToBoundingBox from './map_event_to_bounding_box.js';\nimport * as Constants from '../constants.js';\nimport StringSet from './string_set.js';\n\nconst META_TYPES = [\n  Constants.meta.FEATURE,\n  Constants.meta.MIDPOINT,\n  Constants.meta.VERTEX\n];\n\n// Requires either event or bbox\nexport default {\n  click: featuresAtClick,\n  touch: featuresAtTouch\n};\n\nfunction featuresAtClick(event, bbox, ctx) {\n  return featuresAt(event, bbox, ctx, ctx.options.clickBuffer);\n}\n\nfunction featuresAtTouch(event, bbox, ctx) {\n  return featuresAt(event, bbox, ctx, ctx.options.touchBuffer);\n}\n\nfunction featuresAt(event, bbox, ctx, buffer) {\n  if (ctx.map === null) return [];\n\n  const box = (event) ? mapEventToBoundingBox(event, buffer) : bbox;\n\n  const queryParams = {};\n\n  if (ctx.options.styles) queryParams.layers = ctx.options.styles.map(s => s.id).filter(id => ctx.map.getLayer(id) != null);\n\n  const features = ctx.map.queryRenderedFeatures(box, queryParams)\n    .filter(feature => META_TYPES.indexOf(feature.properties.meta) !== -1);\n\n  const featureIds = new StringSet();\n  const uniqueFeatures = [];\n  features.forEach((feature) => {\n    const featureId = feature.properties.id;\n    if (featureIds.has(featureId)) return;\n    featureIds.add(featureId);\n    uniqueFeatures.push(feature);\n  });\n\n  return sortFeatures(uniqueFeatures);\n}\n","import featuresAt from './features_at.js';\nimport * as Constants from '../constants.js';\n\nexport default function getFeatureAtAndSetCursors(event, ctx) {\n  const features = featuresAt.click(event, null, ctx);\n  const classes = { mouse: Constants.cursors.NONE };\n\n  if (features[0]) {\n    classes.mouse = (features[0].properties.active === Constants.activeStates.ACTIVE) ?\n      Constants.cursors.MOVE : Constants.cursors.POINTER;\n    classes.feature = features[0].properties.meta;\n  }\n\n  if (ctx.events.currentModeName().indexOf('draw') !== -1) {\n    classes.mouse = Constants.cursors.ADD;\n  }\n\n  ctx.ui.queueMapClasses(classes);\n  ctx.ui.updateMapClasses();\n\n  return features[0];\n}\n","export default function(a, b) {\n  const x = a.x - b.x;\n  const y = a.y - b.y;\n  return Math.sqrt((x * x) + (y * y));\n}\n","import euclideanDistance from './euclidean_distance.js';\n\nconst FINE_TOLERANCE = 4;\nconst GROSS_TOLERANCE = 12;\nconst INTERVAL = 500;\n\nexport default function isClick(start, end, options = {}) {\n  const fineTolerance = (options.fineTolerance != null) ? options.fineTolerance : FINE_TOLERANCE;\n  const grossTolerance = (options.grossTolerance != null) ? options.grossTolerance : GROSS_TOLERANCE;\n  const interval = (options.interval != null) ? options.interval : INTERVAL;\n\n  start.point = start.point || end.point;\n  start.time = start.time || end.time;\n  const moveDistance = euclideanDistance(start.point, end.point);\n\n  return moveDistance < fineTolerance ||\n    (moveDistance < grossTolerance && (end.time - start.time) < interval);\n}\n","import euclideanDistance from './euclidean_distance.js';\n\nexport const TAP_TOLERANCE = 25;\nexport const TAP_INTERVAL = 250;\n\nexport default function isTap(start, end, options = {}) {\n  const tolerance = (options.tolerance != null) ? options.tolerance : TAP_TOLERANCE;\n  const interval = (options.interval != null) ? options.interval : TAP_INTERVAL;\n\n  start.point = start.point || end.point;\n  start.time = start.time || end.time;\n  const moveDistance = euclideanDistance(start.point, end.point);\n\n  return moveDistance < tolerance && (end.time - start.time) < interval;\n}\n","import {customAlphabet} from 'nanoid/non-secure';\n\nconst nanoid = customAlphabet('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz', 32);\n\nexport function generateID() {\n  return nanoid();\n}\n","let urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nexport let customAlphabet = (alphabet, defaultSize = 21) => {\n  return (size = defaultSize) => {\n    let id = ''\n    let i = size | 0\n    while (i--) {\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\nexport let nanoid = (size = 21) => {\n  let id = ''\n  let i = size | 0\n  while (i--) {\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\n","import {generateID} from '../lib/id.js';\nimport * as Constants from '../constants.js';\n\nconst Feature = function(ctx, geojson) {\n  this.ctx = ctx;\n  this.properties = geojson.properties || {};\n  this.coordinates = geojson.geometry.coordinates;\n  this.id = geojson.id || generateID();\n  this.type = geojson.geometry.type;\n};\n\nFeature.prototype.changed = function() {\n  this.ctx.store.featureChanged(this.id);\n};\n\nFeature.prototype.incomingCoords = function(coords) {\n  this.setCoordinates(coords);\n};\n\nFeature.prototype.setCoordinates = function(coords) {\n  this.coordinates = coords;\n  this.changed();\n};\n\nFeature.prototype.getCoordinates = function() {\n  return JSON.parse(JSON.stringify(this.coordinates));\n};\n\nFeature.prototype.setProperty = function(property, value) {\n  this.properties[property] = value;\n};\n\nFeature.prototype.toGeoJSON = function() {\n  return JSON.parse(JSON.stringify({\n    id: this.id,\n    type: Constants.geojsonTypes.FEATURE,\n    properties: this.properties,\n    geometry: {\n      coordinates: this.getCoordinates(),\n      type: this.type\n    }\n  }));\n};\n\nFeature.prototype.internal = function(mode) {\n  const properties = {\n    id: this.id,\n    meta: Constants.meta.FEATURE,\n    'meta:type': this.type,\n    active: Constants.activeStates.INACTIVE,\n    mode\n  };\n\n  if (this.ctx.options.userProperties) {\n    for (const name in this.properties) {\n      properties[`user_${name}`] = this.properties[name];\n    }\n  }\n\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties,\n    geometry: {\n      coordinates: this.getCoordinates(),\n      type: this.type\n    }\n  };\n};\n\nexport default Feature;\n","import Feature from './feature.js';\n\nconst Point = function(ctx, geojson) {\n  Feature.call(this, ctx, geojson);\n};\n\nPoint.prototype = Object.create(Feature.prototype);\n\nPoint.prototype.isValid = function() {\n  return typeof this.coordinates[0] === 'number' &&\n    typeof this.coordinates[1] === 'number';\n};\n\nPoint.prototype.updateCoordinate = function(pathOrLng, lngOrLat, lat) {\n  if (arguments.length === 3) {\n    this.coordinates = [lngOrLat, lat];\n  } else {\n    this.coordinates = [pathOrLng, lngOrLat];\n  }\n  this.changed();\n};\n\nPoint.prototype.getCoordinate = function() {\n  return this.getCoordinates();\n};\n\nexport default Point;\n","import Feature from './feature.js';\n\nconst LineString = function(ctx, geojson) {\n  Feature.call(this, ctx, geojson);\n};\n\nLineString.prototype = Object.create(Feature.prototype);\n\nLineString.prototype.isValid = function() {\n  return this.coordinates.length > 1;\n};\n\nLineString.prototype.addCoordinate = function(path, lng, lat) {\n  this.changed();\n  const id = parseInt(path, 10);\n  this.coordinates.splice(id, 0, [lng, lat]);\n};\n\nLineString.prototype.getCoordinate = function(path) {\n  const id = parseInt(path, 10);\n  return JSON.parse(JSON.stringify(this.coordinates[id]));\n};\n\nLineString.prototype.removeCoordinate = function(path) {\n  this.changed();\n  this.coordinates.splice(parseInt(path, 10), 1);\n};\n\nLineString.prototype.updateCoordinate = function(path, lng, lat) {\n  const id = parseInt(path, 10);\n  this.coordinates[id] = [lng, lat];\n  this.changed();\n};\n\nexport default LineString;\n","import Feature from './feature.js';\n\nconst Polygon = function(ctx, geojson) {\n  Feature.call(this, ctx, geojson);\n  this.coordinates = this.coordinates.map(ring => ring.slice(0, -1));\n};\n\nPolygon.prototype = Object.create(Feature.prototype);\n\nPolygon.prototype.isValid = function() {\n  if (this.coordinates.length === 0) return false;\n  return this.coordinates.every(ring => ring.length > 2);\n};\n\n// Expects valid geoJSON polygon geometry: first and last positions must be equivalent.\nPolygon.prototype.incomingCoords = function(coords) {\n  this.coordinates = coords.map(ring => ring.slice(0, -1));\n  this.changed();\n};\n\n// Does NOT expect valid geoJSON polygon geometry: first and last positions should not be equivalent.\nPolygon.prototype.setCoordinates = function(coords) {\n  this.coordinates = coords;\n  this.changed();\n};\n\nPolygon.prototype.addCoordinate = function(path, lng, lat) {\n  this.changed();\n  const ids = path.split('.').map(x => parseInt(x, 10));\n\n  const ring = this.coordinates[ids[0]];\n\n  ring.splice(ids[1], 0, [lng, lat]);\n};\n\nPolygon.prototype.removeCoordinate = function(path) {\n  this.changed();\n  const ids = path.split('.').map(x => parseInt(x, 10));\n  const ring = this.coordinates[ids[0]];\n  if (ring) {\n    ring.splice(ids[1], 1);\n    if (ring.length < 3) {\n      this.coordinates.splice(ids[0], 1);\n    }\n  }\n};\n\nPolygon.prototype.getCoordinate = function(path) {\n  const ids = path.split('.').map(x => parseInt(x, 10));\n  const ring = this.coordinates[ids[0]];\n  return JSON.parse(JSON.stringify(ring[ids[1]]));\n};\n\nPolygon.prototype.getCoordinates = function() {\n  return this.coordinates.map(coords => coords.concat([coords[0]]));\n};\n\nPolygon.prototype.updateCoordinate = function(path, lng, lat) {\n  this.changed();\n  const parts = path.split('.');\n  const ringId = parseInt(parts[0], 10);\n  const coordId = parseInt(parts[1], 10);\n\n  if (this.coordinates[ringId] === undefined) {\n    this.coordinates[ringId] = [];\n  }\n\n  this.coordinates[ringId][coordId] = [lng, lat];\n};\n\nexport default Polygon;\n","import {generateID} from '../lib/id.js';\nimport Feature from './feature.js';\nimport * as Constants from '../constants.js';\n\nimport MultiPoint from './point.js';\nimport MultiLineString from './line_string.js';\nimport MultiPolygon from './polygon.js';\n\nconst models = {\n  MultiPoint,\n  MultiLineString,\n  MultiPolygon\n};\n\nconst takeAction = (features, action, path, lng, lat) => {\n  const parts = path.split('.');\n  const idx = parseInt(parts[0], 10);\n  const tail = (!parts[1]) ? null : parts.slice(1).join('.');\n  return features[idx][action](tail, lng, lat);\n};\n\nconst MultiFeature = function(ctx, geojson) {\n  Feature.call(this, ctx, geojson);\n\n  delete this.coordinates;\n  this.model = models[geojson.geometry.type];\n  if (this.model === undefined) throw new TypeError(`${geojson.geometry.type} is not a valid type`);\n  this.features = this._coordinatesToFeatures(geojson.geometry.coordinates);\n};\n\nMultiFeature.prototype = Object.create(Feature.prototype);\n\nMultiFeature.prototype._coordinatesToFeatures = function(coordinates) {\n  const Model = this.model.bind(this);\n  return coordinates.map(coords => new Model(this.ctx, {\n    id: generateID(),\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      coordinates: coords,\n      type: this.type.replace('Multi', '')\n    }\n  }));\n};\n\nMultiFeature.prototype.isValid = function() {\n  return this.features.every(f => f.isValid());\n};\n\nMultiFeature.prototype.setCoordinates = function(coords) {\n  this.features = this._coordinatesToFeatures(coords);\n  this.changed();\n};\n\nMultiFeature.prototype.getCoordinate = function(path) {\n  return takeAction(this.features, 'getCoordinate', path);\n};\n\nMultiFeature.prototype.getCoordinates = function() {\n  return JSON.parse(JSON.stringify(this.features.map((f) => {\n    if (f.type === Constants.geojsonTypes.POLYGON) return f.getCoordinates();\n    return f.coordinates;\n  })));\n};\n\nMultiFeature.prototype.updateCoordinate = function(path, lng, lat) {\n  takeAction(this.features, 'updateCoordinate', path, lng, lat);\n  this.changed();\n};\n\nMultiFeature.prototype.addCoordinate = function(path, lng, lat) {\n  takeAction(this.features, 'addCoordinate', path, lng, lat);\n  this.changed();\n};\n\nMultiFeature.prototype.removeCoordinate = function(path) {\n  takeAction(this.features, 'removeCoordinate', path);\n  this.changed();\n};\n\nMultiFeature.prototype.getFeatures = function() {\n  return this.features;\n};\n\nexport default MultiFeature;\n","import * as Constants from '../constants.js';\nimport featuresAt from '../lib/features_at.js';\nimport Point from '../feature_types/point.js';\nimport LineString from '../feature_types/line_string.js';\nimport Polygon from '../feature_types/polygon.js';\nimport MultiFeature from '../feature_types/multi_feature.js';\n\nexport default function ModeInterface(ctx) {\n  this.map = ctx.map;\n  this.drawConfig = JSON.parse(JSON.stringify(ctx.options || {}));\n  this._ctx = ctx;\n}\n\n/**\n * Sets Draw's interal selected state\n * @name this.setSelected\n * @param {DrawFeature[]} - whats selected as a [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js)\n */\nModeInterface.prototype.setSelected = function(features) {\n  return this._ctx.store.setSelected(features);\n};\n\n/**\n * Sets Draw's internal selected coordinate state\n * @name this.setSelectedCoordinates\n * @param {Object[]} coords - a array of {coord_path: 'string', feature_id: 'string'}\n */\nModeInterface.prototype.setSelectedCoordinates = function(coords) {\n  this._ctx.store.setSelectedCoordinates(coords);\n  coords.reduce((m, c) => {\n    if (m[c.feature_id] === undefined) {\n      m[c.feature_id] = true;\n      this._ctx.store.get(c.feature_id).changed();\n    }\n    return m;\n  }, {});\n};\n\n/**\n * Get all selected features as a [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js)\n * @name this.getSelected\n * @returns {DrawFeature[]}\n */\nModeInterface.prototype.getSelected = function() {\n  return this._ctx.store.getSelected();\n};\n\n/**\n * Get the ids of all currently selected features\n * @name this.getSelectedIds\n * @returns {String[]}\n */\nModeInterface.prototype.getSelectedIds = function() {\n  return this._ctx.store.getSelectedIds();\n};\n\n/**\n * Check if a feature is selected\n * @name this.isSelected\n * @param {String} id - a feature id\n * @returns {Boolean}\n */\nModeInterface.prototype.isSelected = function(id) {\n  return this._ctx.store.isSelected(id);\n};\n\n/**\n * Get a [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js) by its id\n * @name this.getFeature\n * @param {String} id - a feature id\n * @returns {DrawFeature}\n */\nModeInterface.prototype.getFeature = function(id) {\n  return this._ctx.store.get(id);\n};\n\n/**\n * Add a feature to draw's internal selected state\n * @name this.select\n * @param {String} id\n */\nModeInterface.prototype.select = function(id) {\n  return this._ctx.store.select(id);\n};\n\n/**\n * Remove a feature from draw's internal selected state\n * @name this.delete\n * @param {String} id\n */\nModeInterface.prototype.deselect = function(id) {\n  return this._ctx.store.deselect(id);\n};\n\n/**\n * Delete a feature from draw\n * @name this.deleteFeature\n * @param {String} id - a feature id\n */\nModeInterface.prototype.deleteFeature = function(id, opts = {}) {\n  return this._ctx.store.delete(id, opts);\n};\n\n/**\n * Add a [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js) to draw.\n * See `this.newFeature` for converting geojson into a DrawFeature\n * @name this.addFeature\n * @param {DrawFeature} feature - the feature to add\n */\nModeInterface.prototype.addFeature = function(feature, opts = {}) {\n  return this._ctx.store.add(feature, opts);\n};\n\n/**\n * Clear all selected features\n */\nModeInterface.prototype.clearSelectedFeatures = function() {\n  return this._ctx.store.clearSelected();\n};\n\n/**\n * Clear all selected coordinates\n */\nModeInterface.prototype.clearSelectedCoordinates = function() {\n  return this._ctx.store.clearSelectedCoordinates();\n};\n\n/**\n * Indicate if the different action are currently possible with your mode\n * See [draw.actionalbe](https://github.com/mapbox/mapbox-gl-draw/blob/main/API.md#drawactionable) for a list of possible actions. All undefined actions are set to **false** by default\n * @name this.setActionableState\n * @param {Object} actions\n */\nModeInterface.prototype.setActionableState = function(actions = {}) {\n  const newSet = {\n    trash: actions.trash || false,\n    combineFeatures: actions.combineFeatures || false,\n    uncombineFeatures: actions.uncombineFeatures || false\n  };\n  return this._ctx.events.actionable(newSet);\n};\n\n/**\n * Trigger a mode change\n * @name this.changeMode\n * @param {String} mode - the mode to transition into\n * @param {Object} opts - the options object to pass to the new mode\n * @param {Object} eventOpts - used to control what kind of events are emitted.\n */\nModeInterface.prototype.changeMode = function(mode, opts = {}, eventOpts = {}) {\n  return this._ctx.events.changeMode(mode, opts, eventOpts);\n};\n\n/**\n * Fire a map event\n * @name this.fire\n * @param {String} eventName - the event name.\n * @param {Object} eventData - the event data object.\n */\nModeInterface.prototype.fire = function(eventName, eventData) {\n  return this._ctx.events.fire(eventName, eventData);\n};\n\n/**\n * Update the state of draw map classes\n * @name this.updateUIClasses\n * @param {Object} opts\n */\nModeInterface.prototype.updateUIClasses = function(opts) {\n  return this._ctx.ui.queueMapClasses(opts);\n};\n\n/**\n * If a name is provided it makes that button active, else if makes all buttons inactive\n * @name this.activateUIButton\n * @param {String?} name - name of the button to make active, leave as undefined to set buttons to be inactive\n */\nModeInterface.prototype.activateUIButton = function(name) {\n  return this._ctx.ui.setActiveButton(name);\n};\n\n/**\n * Get the features at the location of an event object or in a bbox\n * @name this.featuresAt\n * @param {Event||NULL} event - a mapbox-gl event object\n * @param {BBOX||NULL} bbox - the area to get features from\n * @param {String} bufferType - is this `click` or `tap` event, defaults to click\n */\nModeInterface.prototype.featuresAt = function(event, bbox, bufferType = 'click') {\n  if (bufferType !== 'click' && bufferType !== 'touch') throw new Error('invalid buffer type');\n  return featuresAt[bufferType](event, bbox, this._ctx);\n};\n\n/**\n * Create a new [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js) from geojson\n * @name this.newFeature\n * @param {GeoJSONFeature} geojson\n * @returns {DrawFeature}\n */\nModeInterface.prototype.newFeature = function(geojson) {\n  const type = geojson.geometry.type;\n  if (type === Constants.geojsonTypes.POINT) return new Point(this._ctx, geojson);\n  if (type === Constants.geojsonTypes.LINE_STRING) return new LineString(this._ctx, geojson);\n  if (type === Constants.geojsonTypes.POLYGON) return new Polygon(this._ctx, geojson);\n  return new MultiFeature(this._ctx, geojson);\n};\n\n/**\n * Check is an object is an instance of a [DrawFeature](https://github.com/mapbox/mapbox-gl-draw/blob/main/src/feature_types/feature.js)\n * @name this.isInstanceOf\n * @param {String} type - `Point`, `LineString`, `Polygon`, `MultiFeature`\n * @param {Object} feature - the object that needs to be checked\n * @returns {Boolean}\n */\nModeInterface.prototype.isInstanceOf = function(type, feature) {\n  if (type === Constants.geojsonTypes.POINT) return feature instanceof Point;\n  if (type === Constants.geojsonTypes.LINE_STRING) return feature instanceof LineString;\n  if (type === Constants.geojsonTypes.POLYGON) return feature instanceof Polygon;\n  if (type === 'MultiFeature') return feature instanceof MultiFeature;\n  throw new Error(`Unknown feature class: ${type}`);\n};\n\n/**\n * Force draw to rerender the feature of the provided id\n * @name this.doRender\n * @param {String} id - a feature id\n */\nModeInterface.prototype.doRender = function(id) {\n  return this._ctx.store.featureChanged(id);\n};\n\n","import ModeInterface from './mode_interface_accessors.js';\nexport default ModeInterface;\n\n/**\n * Triggered while a mode is being transitioned into.\n * @param opts {Object} - this is the object passed via `draw.changeMode('mode', opts)`;\n * @name MODE.onSetup\n * @returns {Object} - this object will be passed to all other life cycle functions\n */\nModeInterface.prototype.onSetup = function() {};\n\n/**\n * Triggered when a drag event is detected on the map\n * @name MODE.onDrag\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onDrag = function() {};\n\n/**\n * Triggered when the mouse is clicked\n * @name MODE.onClick\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onClick = function() {};\n\n/**\n * Triggered with the mouse is moved\n * @name MODE.onMouseMove\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onMouseMove = function() {};\n\n/**\n * Triggered when the mouse button is pressed down\n * @name MODE.onMouseDown\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onMouseDown = function() {};\n\n/**\n * Triggered when the mouse button is released\n * @name MODE.onMouseUp\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onMouseUp = function() {};\n\n/**\n * Triggered when the mouse leaves the map's container\n * @name MODE.onMouseOut\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onMouseOut = function() {};\n\n/**\n * Triggered when a key up event is detected\n * @name MODE.onKeyUp\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onKeyUp = function() {};\n\n/**\n * Triggered when a key down event is detected\n * @name MODE.onKeyDown\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onKeyDown = function() {};\n\n/**\n * Triggered when a touch event is started\n * @name MODE.onTouchStart\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onTouchStart = function() {};\n\n/**\n * Triggered when one drags thier finger on a mobile device\n * @name MODE.onTouchMove\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onTouchMove = function() {};\n\n/**\n * Triggered when one removes their finger from the map\n * @name MODE.onTouchEnd\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onTouchEnd = function() {};\n\n/**\n * Triggered when one quicly taps the map\n * @name MODE.onTap\n * @param state {Object} - a mutible state object created by onSetup\n * @param e {Object} - the captured event that is triggering this life cycle event\n */\nModeInterface.prototype.onTap = function() {};\n\n/**\n * Triggered when the mode is being exited, to be used for cleaning up artifacts such as invalid features\n * @name MODE.onStop\n * @param state {Object} - a mutible state object created by onSetup\n */\nModeInterface.prototype.onStop = function() {};\n\n/**\n * Triggered when [draw.trash()](https://github.com/mapbox/mapbox-gl-draw/blob/main/API.md#trash-draw) is called.\n * @name MODE.onTrash\n * @param state {Object} - a mutible state object created by onSetup\n */\nModeInterface.prototype.onTrash = function() {};\n\n/**\n * Triggered when [draw.combineFeatures()](https://github.com/mapbox/mapbox-gl-draw/blob/main/API.md#combinefeatures-draw) is called.\n * @name MODE.onCombineFeature\n * @param state {Object} - a mutible state object created by onSetup\n */\nModeInterface.prototype.onCombineFeature = function() {};\n\n/**\n * Triggered when [draw.uncombineFeatures()](https://github.com/mapbox/mapbox-gl-draw/blob/main/API.md#uncombinefeatures-draw) is called.\n * @name MODE.onUncombineFeature\n * @param state {Object} - a mutible state object created by onSetup\n */\nModeInterface.prototype.onUncombineFeature = function() {};\n\n/**\n * Triggered per feature on render to convert raw features into set of features for display on the map\n * See [styling draw](https://github.com/mapbox/mapbox-gl-draw/blob/main/API.md#styling-draw) for information about what geojson properties Draw uses as part of rendering.\n * @name MODE.toDisplayFeatures\n * @param state {Object} - a mutible state object created by onSetup\n * @param geojson {Object} - a geojson being evaulated. To render, pass to `display`.\n * @param display {Function} - all geojson objects passed to this be rendered onto the map\n */\nModeInterface.prototype.toDisplayFeatures = function() {\n  throw new Error('You must overwrite toDisplayFeatures');\n};\n\n","import ModeInterface from './mode_interface.js';\n\nconst eventMapper = {\n  drag: 'onDrag',\n  click: 'onClick',\n  mousemove: 'onMouseMove',\n  mousedown: 'onMouseDown',\n  mouseup: 'onMouseUp',\n  mouseout: 'onMouseOut',\n  keyup: 'onKeyUp',\n  keydown: 'onKeyDown',\n  touchstart: 'onTouchStart',\n  touchmove: 'onTouchMove',\n  touchend: 'onTouchEnd',\n  tap: 'onTap'\n};\n\nconst eventKeys = Object.keys(eventMapper);\n\nexport default function(modeObject) {\n  const modeObjectKeys = Object.keys(modeObject);\n\n  return function(ctx, startOpts = {}) {\n    let state = {};\n\n    const mode = modeObjectKeys.reduce((m, k) => {\n      m[k] = modeObject[k];\n      return m;\n    }, new ModeInterface(ctx));\n\n    function wrapper(eh) {\n      return e => mode[eh](state, e);\n    }\n\n    return {\n      start() {\n        state = mode.onSetup(startOpts); // this should set ui buttons\n\n        // Adds event handlers for all event options\n        // add sets the selector to false for all\n        // handlers that are not present in the mode\n        // to reduce on render calls for functions that\n        // have no logic\n        eventKeys.forEach((key) => {\n          const modeHandler = eventMapper[key];\n          let selector = () => false;\n          if (modeObject[modeHandler]) {\n            selector = () => true;\n          }\n          this.on(key, selector, wrapper(modeHandler));\n        });\n\n      },\n      stop() {\n        mode.onStop(state);\n      },\n      trash() {\n        mode.onTrash(state);\n      },\n      combineFeatures() {\n        mode.onCombineFeatures(state);\n      },\n      uncombineFeatures() {\n        mode.onUncombineFeatures(state);\n      },\n      render(geojson, push) {\n        mode.toDisplayFeatures(state, geojson, push);\n      }\n    };\n  };\n}\n","/**\n * Derive a dense array (no `undefined`s) from a single value or array.\n *\n * @param {any} x\n * @return {Array<any>}\n */\nfunction toDenseArray(x) {\n  return [].concat(x).filter(y => y !== undefined);\n}\n\nexport default toDenseArray;\n","import * as Constants from './constants.js';\n\nexport default function render() {\n  // eslint-disable-next-line no-invalid-this\n  const store = this;\n  const mapExists = store.ctx.map && store.ctx.map.getSource(Constants.sources.HOT) !== undefined;\n  if (!mapExists) return cleanup();\n\n  const mode = store.ctx.events.currentModeName();\n\n  store.ctx.ui.queueMapClasses({ mode });\n\n  let newHotIds = [];\n  let newColdIds = [];\n\n  if (store.isDirty) {\n    newColdIds = store.getAllIds();\n  } else {\n    newHotIds = store.getChangedIds().filter(id => store.get(id) !== undefined);\n    newColdIds = store.sources.hot.filter(geojson => geojson.properties.id && newHotIds.indexOf(geojson.properties.id) === -1 && store.get(geojson.properties.id) !== undefined).map(geojson => geojson.properties.id);\n  }\n\n  store.sources.hot = [];\n  const lastColdCount = store.sources.cold.length;\n  store.sources.cold = store.isDirty ? [] : store.sources.cold.filter((geojson) => {\n    const id = geojson.properties.id || geojson.properties.parent;\n    return newHotIds.indexOf(id) === -1;\n  });\n\n  const coldChanged = lastColdCount !== store.sources.cold.length || newColdIds.length > 0;\n  newHotIds.forEach(id => renderFeature(id, 'hot'));\n  newColdIds.forEach(id => renderFeature(id, 'cold'));\n\n  function renderFeature(id, source) {\n    const feature = store.get(id);\n    const featureInternal = feature.internal(mode);\n    store.ctx.events.currentModeRender(featureInternal, (geojson) => {\n      geojson.properties.mode = mode;\n      store.sources[source].push(geojson);\n    });\n  }\n\n  if (coldChanged) {\n    store.ctx.map.getSource(Constants.sources.COLD).setData({\n      type: Constants.geojsonTypes.FEATURE_COLLECTION,\n      features: store.sources.cold\n    });\n  }\n\n  store.ctx.map.getSource(Constants.sources.HOT).setData({\n    type: Constants.geojsonTypes.FEATURE_COLLECTION,\n    features: store.sources.hot\n  });\n\n  cleanup();\n\n  function cleanup() {\n    store.isDirty = false;\n    store.clearChangedIds();\n  }\n}\n","import toDenseArray from './lib/to_dense_array.js';\nimport StringSet from './lib/string_set.js';\nimport render from './render.js';\nimport * as Constants from './constants.js';\n\nexport default function Store(ctx) {\n  this._features = {};\n  this._featureIds = new StringSet();\n  this._selectedFeatureIds = new StringSet();\n  this._selectedCoordinates = [];\n  this._changedFeatureIds = new StringSet();\n  this._emitSelectionChange = false;\n  this._mapInitialConfig = {};\n  this.ctx = ctx;\n  this.sources = {\n    hot: [],\n    cold: []\n  };\n\n  // Deduplicate requests to render and tie them to animation frames.\n  let renderRequest;\n  this.render = () => {\n    if (!renderRequest) {\n      renderRequest = requestAnimationFrame(() => {\n        renderRequest = null;\n        render.call(this);\n\n        // Fire deduplicated selection change event\n        if (this._emitSelectionChange) {\n          this.ctx.events.fire(Constants.events.SELECTION_CHANGE, {\n            features: this.getSelected().map(feature => feature.toGeoJSON()),\n            points: this.getSelectedCoordinates().map(coordinate => ({\n              type: Constants.geojsonTypes.FEATURE,\n              properties: {},\n              geometry: {\n                type: Constants.geojsonTypes.POINT,\n                coordinates: coordinate.coordinates\n              }\n            }))\n          });\n\n          this._emitSelectionChange = false;\n        }\n\n        // Fire render event\n        this.ctx.events.fire(Constants.events.RENDER, {});\n      });\n    }\n  };\n\n  this.isDirty = false;\n}\n\n/**\n * Delays all rendering until the returned function is invoked\n * @return {Function} renderBatch\n */\nStore.prototype.createRenderBatch = function() {\n  const holdRender = this.render;\n  let numRenders = 0;\n  this.render = function() {\n    numRenders++;\n  };\n\n  return () => {\n    this.render = holdRender;\n    if (numRenders > 0) {\n      this.render();\n    }\n  };\n};\n\n/**\n * Sets the store's state to dirty.\n * @return {Store} this\n */\nStore.prototype.setDirty = function() {\n  this.isDirty = true;\n  return this;\n};\n\n/**\n * Sets a feature's state to changed.\n * @param {string} featureId\n * @return {Store} this\n */\nStore.prototype.featureCreated = function(featureId, options = {}) {\n  this._changedFeatureIds.add(featureId);\n\n  const silent = options.silent != null ? options.silent : this.ctx.options.suppressAPIEvents;\n  if (silent !== true) {\n    const feature = this.get(featureId);\n    this.ctx.events.fire(Constants.events.CREATE, {\n      features: [feature.toGeoJSON()]\n    });\n  }\n\n  return this;\n};\n\n/**\n * Sets a feature's state to changed.\n * @param {string} featureId\n * @return {Store} this\n */\nStore.prototype.featureChanged = function(featureId, options = {}) {\n  this._changedFeatureIds.add(featureId);\n\n  const silent = options.silent != null ? options.silent : this.ctx.options.suppressAPIEvents;\n  if (silent !== true) {\n    this.ctx.events.fire(Constants.events.UPDATE, {\n      action: options.action ? options.action : Constants.updateActions.CHANGE_COORDINATES,\n      features: [this.get(featureId).toGeoJSON()]\n    });\n  }\n\n  return this;\n};\n\n/**\n * Gets the ids of all features currently in changed state.\n * @return {Store} this\n */\nStore.prototype.getChangedIds = function() {\n  return this._changedFeatureIds.values();\n};\n\n/**\n * Sets all features to unchanged state.\n * @return {Store} this\n */\nStore.prototype.clearChangedIds = function() {\n  this._changedFeatureIds.clear();\n  return this;\n};\n\n/**\n * Gets the ids of all features in the store.\n * @return {Store} this\n */\nStore.prototype.getAllIds = function() {\n  return this._featureIds.values();\n};\n\n/**\n * Adds a feature to the store.\n * @param {Object} feature\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n *\n * @return {Store} this\n */\nStore.prototype.add = function(feature, options = {}) {\n  this._features[feature.id] = feature;\n  this._featureIds.add(feature.id);\n  this.featureCreated(feature.id, {silent: options.silent});\n  return this;\n};\n\n/**\n * Deletes a feature or array of features from the store.\n * Cleans up after the deletion by deselecting the features.\n * If changes were made, sets the state to the dirty\n * and fires an event.\n * @param {string | Array<string>} featureIds\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n * @return {Store} this\n */\nStore.prototype.delete = function(featureIds, options = {}) {\n  const deletedFeaturesToEmit = [];\n  toDenseArray(featureIds).forEach((id) => {\n    if (!this._featureIds.has(id)) return;\n    this._featureIds.delete(id);\n    this._selectedFeatureIds.delete(id);\n    if (!options.silent) {\n      if (deletedFeaturesToEmit.indexOf(this._features[id]) === -1) {\n        deletedFeaturesToEmit.push(this._features[id].toGeoJSON());\n      }\n    }\n    delete this._features[id];\n    this.isDirty = true;\n  });\n\n  if (deletedFeaturesToEmit.length) {\n    this.ctx.events.fire(Constants.events.DELETE, {features: deletedFeaturesToEmit});\n  }\n\n  refreshSelectedCoordinates(this, options);\n  return this;\n};\n\n/**\n * Returns a feature in the store matching the specified value.\n * @return {Object | undefined} feature\n */\nStore.prototype.get = function(id) {\n  return this._features[id];\n};\n\n/**\n * Returns all features in the store.\n * @return {Array<Object>}\n */\nStore.prototype.getAll = function() {\n  return Object.keys(this._features).map(id => this._features[id]);\n};\n\n/**\n * Adds features to the current selection.\n * @param {string | Array<string>} featureIds\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n * @return {Store} this\n */\nStore.prototype.select = function(featureIds, options = {}) {\n  toDenseArray(featureIds).forEach((id) => {\n    if (this._selectedFeatureIds.has(id)) return;\n    this._selectedFeatureIds.add(id);\n    this._changedFeatureIds.add(id);\n    if (!options.silent) {\n      this._emitSelectionChange = true;\n    }\n  });\n  return this;\n};\n\n/**\n * Deletes features from the current selection.\n * @param {string | Array<string>} featureIds\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n * @return {Store} this\n */\nStore.prototype.deselect = function(featureIds, options = {}) {\n  toDenseArray(featureIds).forEach((id) => {\n    if (!this._selectedFeatureIds.has(id)) return;\n    this._selectedFeatureIds.delete(id);\n    this._changedFeatureIds.add(id);\n    if (!options.silent) {\n      this._emitSelectionChange = true;\n    }\n  });\n  refreshSelectedCoordinates(this, options);\n  return this;\n};\n\n/**\n * Clears the current selection.\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n * @return {Store} this\n */\nStore.prototype.clearSelected = function(options = {}) {\n  this.deselect(this._selectedFeatureIds.values(), { silent: options.silent });\n  return this;\n};\n\n/**\n * Sets the store's selection, clearing any prior values.\n * If no feature ids are passed, the store is just cleared.\n * @param {string | Array<string> | undefined} featureIds\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n * @return {Store} this\n */\nStore.prototype.setSelected = function(featureIds, options = {}) {\n  featureIds = toDenseArray(featureIds);\n\n  // Deselect any features not in the new selection\n  this.deselect(this._selectedFeatureIds.values().filter(id => featureIds.indexOf(id) === -1), { silent: options.silent });\n\n  // Select any features in the new selection that were not already selected\n  this.select(featureIds.filter(id => !this._selectedFeatureIds.has(id)), { silent: options.silent });\n\n  return this;\n};\n\n/**\n * Sets the store's coordinates selection, clearing any prior values.\n * @param {Array<Array<string>>} coordinates\n * @return {Store} this\n */\nStore.prototype.setSelectedCoordinates = function(coordinates) {\n  this._selectedCoordinates = coordinates;\n  this._emitSelectionChange = true;\n  return this;\n};\n\n/**\n * Clears the current coordinates selection.\n * @param {Object} [options]\n * @return {Store} this\n */\nStore.prototype.clearSelectedCoordinates = function() {\n  this._selectedCoordinates = [];\n  this._emitSelectionChange = true;\n  return this;\n};\n\n/**\n * Returns the ids of features in the current selection.\n * @return {Array<string>} Selected feature ids.\n */\nStore.prototype.getSelectedIds = function() {\n  return this._selectedFeatureIds.values();\n};\n\n/**\n * Returns features in the current selection.\n * @return {Array<Object>} Selected features.\n */\nStore.prototype.getSelected = function() {\n  return this.getSelectedIds().map(id => this.get(id));\n};\n\n/**\n * Returns selected coordinates in the currently selected feature.\n * @return {Array<Object>} Selected coordinates.\n */\nStore.prototype.getSelectedCoordinates = function() {\n  const selected = this._selectedCoordinates.map((coordinate) => {\n    const feature = this.get(coordinate.feature_id);\n    return {\n      coordinates: feature.getCoordinate(coordinate.coord_path)\n    };\n  });\n  return selected;\n};\n\n/**\n * Indicates whether a feature is selected.\n * @param {string} featureId\n * @return {boolean} `true` if the feature is selected, `false` if not.\n */\nStore.prototype.isSelected = function(featureId) {\n  return this._selectedFeatureIds.has(featureId);\n};\n\n/**\n * Sets a property on the given feature\n * @param {string} featureId\n * @param {string} property property\n * @param {string} property value\n * @param {Object} [options]\n * @param {Object} [options.silent] - If `true`, this invocation will not fire an event.\n*/\nStore.prototype.setFeatureProperty = function(featureId, property, value, options = {}) {\n  this.get(featureId).setProperty(property, value);\n\n  this.featureChanged(featureId, {\n    silent: options.silent,\n    action: Constants.updateActions.CHANGE_PROPERTIES\n  });\n};\n\nfunction refreshSelectedCoordinates(store, options = {}) {\n  const newSelectedCoordinates = store._selectedCoordinates.filter(point => store._selectedFeatureIds.has(point.feature_id));\n  if (store._selectedCoordinates.length !== newSelectedCoordinates.length && !options.silent) {\n    store._emitSelectionChange = true;\n  }\n  store._selectedCoordinates = newSelectedCoordinates;\n}\n\n/**\n * Stores the initial config for a map, so that we can set it again after we're done.\n*/\nStore.prototype.storeMapConfig = function() {\n  Constants.interactions.forEach((interaction) => {\n    const interactionSet = this.ctx.map[interaction];\n    if (interactionSet) {\n      this._mapInitialConfig[interaction] = this.ctx.map[interaction].isEnabled();\n    }\n  });\n};\n\n/**\n * Restores the initial config for a map, ensuring all is well.\n*/\nStore.prototype.restoreMapConfig = function() {\n  Object.keys(this._mapInitialConfig).forEach((key) => {\n    const value = this._mapInitialConfig[key];\n    if (value) {\n      this.ctx.map[key].enable();\n    } else {\n      this.ctx.map[key].disable();\n    }\n  });\n};\n\n/**\n * Returns the initial state of an interaction setting.\n * @param {string} interaction\n * @return {boolean} `true` if the interaction is enabled, `false` if not.\n * Defaults to `true`. (Todo: include defaults.)\n*/\nStore.prototype.getInitialConfigValue = function(interaction) {\n  if (this._mapInitialConfig[interaction] !== undefined) {\n    return this._mapInitialConfig[interaction];\n  } else {\n    // This needs to be set to whatever the default is for that interaction\n    // It seems to be true for all cases currently, so let's send back `true`.\n    return true;\n  }\n};\n","import * as Constants from './constants.js';\n\nconst classTypes = ['mode', 'feature', 'mouse'];\n\nexport default function(ctx) {\n\n\n  const buttonElements = {};\n  let activeButton = null;\n\n  let currentMapClasses = {\n    mode: null, // e.g. mode-direct_select\n    feature: null, // e.g. feature-vertex\n    mouse: null // e.g. mouse-move\n  };\n\n  let nextMapClasses = {\n    mode: null,\n    feature: null,\n    mouse: null\n  };\n\n  function clearMapClasses() {\n    queueMapClasses({mode:null, feature:null, mouse:null});\n    updateMapClasses();\n  }\n\n  function queueMapClasses(options) {\n    nextMapClasses = Object.assign(nextMapClasses, options);\n  }\n\n  function updateMapClasses() {\n    if (!ctx.container) return;\n\n    const classesToRemove = [];\n    const classesToAdd = [];\n\n    classTypes.forEach((type) => {\n      if (nextMapClasses[type] === currentMapClasses[type]) return;\n\n      classesToRemove.push(`${type}-${currentMapClasses[type]}`);\n      if (nextMapClasses[type] !== null) {\n        classesToAdd.push(`${type}-${nextMapClasses[type]}`);\n      }\n    });\n\n    if (classesToRemove.length > 0) {\n      ctx.container.classList.remove(...classesToRemove);\n    }\n\n    if (classesToAdd.length > 0) {\n      ctx.container.classList.add(...classesToAdd);\n    }\n\n    currentMapClasses = Object.assign(currentMapClasses, nextMapClasses);\n  }\n\n  function createControlButton(id, options = {}) {\n    const button = document.createElement('button');\n    button.className = `${Constants.classes.CONTROL_BUTTON} ${options.className}`;\n    button.setAttribute('title', options.title);\n    options.container.appendChild(button);\n\n    button.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const clickedButton = e.target;\n      if (clickedButton === activeButton) {\n        deactivateButtons();\n        options.onDeactivate();\n        return;\n      }\n\n      setActiveButton(id);\n      options.onActivate();\n    }, true);\n\n    return button;\n  }\n\n  function deactivateButtons() {\n    if (!activeButton) return;\n    activeButton.classList.remove(Constants.classes.ACTIVE_BUTTON);\n    activeButton = null;\n  }\n\n  function setActiveButton(id) {\n    deactivateButtons();\n\n    const button = buttonElements[id];\n    if (!button) return;\n\n    if (button && id !== 'trash') {\n      button.classList.add(Constants.classes.ACTIVE_BUTTON);\n      activeButton = button;\n    }\n  }\n\n  function addButtons() {\n    const controls = ctx.options.controls;\n    const controlGroup = document.createElement('div');\n    controlGroup.className = `${Constants.classes.CONTROL_GROUP} ${Constants.classes.CONTROL_BASE}`;\n\n    if (!controls) return controlGroup;\n\n    if (controls[Constants.types.LINE]) {\n      buttonElements[Constants.types.LINE] = createControlButton(Constants.types.LINE, {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_LINE,\n        title: `LineString tool ${ctx.options.keybindings ? '(l)' : ''}`,\n        onActivate: () => ctx.events.changeMode(Constants.modes.DRAW_LINE_STRING),\n        onDeactivate: () => ctx.events.trash()\n      });\n    }\n\n    if (controls[Constants.types.POLYGON]) {\n      buttonElements[Constants.types.POLYGON] = createControlButton(Constants.types.POLYGON, {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_POLYGON,\n        title: `Polygon tool ${ctx.options.keybindings ? '(p)' : ''}`,\n        onActivate: () => ctx.events.changeMode(Constants.modes.DRAW_POLYGON),\n        onDeactivate: () => ctx.events.trash()\n      });\n    }\n\n    if (controls[Constants.types.POINT]) {\n      buttonElements[Constants.types.POINT] = createControlButton(Constants.types.POINT, {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_POINT,\n        title: `Marker tool ${ctx.options.keybindings ? '(m)' : ''}`,\n        onActivate: () => ctx.events.changeMode(Constants.modes.DRAW_POINT),\n        onDeactivate: () => ctx.events.trash()\n      });\n    }\n\n    if (controls.trash) {\n      buttonElements.trash = createControlButton('trash', {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_TRASH,\n        title: 'Delete',\n        onActivate: () => {\n          ctx.events.trash();\n        }\n      });\n    }\n\n    if (controls.combine_features) {\n      buttonElements.combine_features = createControlButton('combineFeatures', {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_COMBINE_FEATURES,\n        title: 'Combine',\n        onActivate: () => {\n          ctx.events.combineFeatures();\n        }\n      });\n    }\n\n    if (controls.uncombine_features) {\n      buttonElements.uncombine_features = createControlButton('uncombineFeatures', {\n        container: controlGroup,\n        className: Constants.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,\n        title: 'Uncombine',\n        onActivate: () => {\n          ctx.events.uncombineFeatures();\n        }\n      });\n    }\n\n    return controlGroup;\n  }\n\n  function removeButtons() {\n    Object.keys(buttonElements).forEach((buttonId) => {\n      const button = buttonElements[buttonId];\n      if (button.parentNode) {\n        button.parentNode.removeChild(button);\n      }\n      delete buttonElements[buttonId];\n    });\n  }\n\n  return {\n    setActiveButton,\n    queueMapClasses,\n    updateMapClasses,\n    clearMapClasses,\n    addButtons,\n    removeButtons\n  };\n}\n","import events from './events.js';\nimport Store from './store.js';\nimport ui from './ui.js';\nimport * as Constants from './constants.js';\n\nexport default function(ctx) {\n\n  let controlContainer = null;\n  let mapLoadedInterval = null;\n\n  const setup = {\n    onRemove() {\n      // Stop connect attempt in the event that control is removed before map is loaded\n      ctx.map.off('load', setup.connect);\n      clearInterval(mapLoadedInterval);\n\n      setup.removeLayers();\n      ctx.store.restoreMapConfig();\n      ctx.ui.removeButtons();\n      ctx.events.removeEventListeners();\n      ctx.ui.clearMapClasses();\n      if (ctx.boxZoomInitial) ctx.map.boxZoom.enable();\n      ctx.map = null;\n      ctx.container = null;\n      ctx.store = null;\n\n      if (controlContainer && controlContainer.parentNode) controlContainer.parentNode.removeChild(controlContainer);\n      controlContainer = null;\n\n      return this;\n    },\n    connect() {\n      ctx.map.off('load', setup.connect);\n      clearInterval(mapLoadedInterval);\n      setup.addLayers();\n      ctx.store.storeMapConfig();\n      ctx.events.addEventListeners();\n    },\n    onAdd(map) {\n      ctx.map = map;\n      ctx.events = events(ctx);\n      ctx.ui = ui(ctx);\n      ctx.container = map.getContainer();\n      ctx.store = new Store(ctx);\n\n\n      controlContainer = ctx.ui.addButtons();\n\n      if (ctx.options.boxSelect) {\n        ctx.boxZoomInitial = map.boxZoom.isEnabled();\n        map.boxZoom.disable();\n        const dragPanIsEnabled = map.dragPan.isEnabled();\n        // Need to toggle dragPan on and off or else first\n        // dragPan disable attempt in simple_select doesn't work\n        map.dragPan.disable();\n        map.dragPan.enable();\n        if (!dragPanIsEnabled) {\n          map.dragPan.disable();\n        }\n      }\n\n      if (map.loaded()) {\n        setup.connect();\n      } else {\n        map.on('load', setup.connect);\n        mapLoadedInterval = setInterval(() => { if (map.loaded()) setup.connect(); }, 16);\n      }\n\n      ctx.events.start();\n      return controlContainer;\n    },\n    addLayers() {\n      // drawn features style\n      ctx.map.addSource(Constants.sources.COLD, {\n        data: {\n          type: Constants.geojsonTypes.FEATURE_COLLECTION,\n          features: []\n        },\n        type: 'geojson'\n      });\n\n      // hot features style\n      ctx.map.addSource(Constants.sources.HOT, {\n        data: {\n          type: Constants.geojsonTypes.FEATURE_COLLECTION,\n          features: []\n        },\n        type: 'geojson'\n      });\n\n      ctx.options.styles.forEach((style) => {\n        ctx.map.addLayer(style);\n      });\n\n      ctx.store.setDirty(true);\n      ctx.store.render();\n    },\n    // Check for layers and sources before attempting to remove\n    // If user adds draw control and removes it before the map is loaded, layers and sources will be missing\n    removeLayers() {\n      ctx.options.styles.forEach((style) => {\n        if (ctx.map.getLayer(style.id)) {\n          ctx.map.removeLayer(style.id);\n        }\n      });\n\n      if (ctx.map.getSource(Constants.sources.COLD)) {\n        ctx.map.removeSource(Constants.sources.COLD);\n      }\n\n      if (ctx.map.getSource(Constants.sources.HOT)) {\n        ctx.map.removeSource(Constants.sources.HOT);\n      }\n    }\n  };\n\n  ctx.setup = setup;\n\n  return setup;\n}\n","import setupModeHandler from './lib/mode_handler.js';\nimport getFeaturesAndSetCursor from './lib/get_features_and_set_cursor.js';\nimport featuresAt from './lib/features_at.js';\nimport isClick from './lib/is_click.js';\nimport isTap from './lib/is_tap.js';\nimport * as Constants from './constants.js';\nimport objectToMode from './modes/object_to_mode.js';\n\nexport default function(ctx) {\n\n  const modes = Object.keys(ctx.options.modes).reduce((m, k) => {\n    m[k] = objectToMode(ctx.options.modes[k]);\n    return m;\n  }, {});\n\n  let mouseDownInfo = {};\n  let touchStartInfo = {};\n  const events = {};\n  let currentModeName = null;\n  let currentMode = null;\n\n  events.drag = function(event, isDrag) {\n    if (isDrag({\n      point: event.point,\n      time: new Date().getTime()\n    })) {\n      ctx.ui.queueMapClasses({ mouse: Constants.cursors.DRAG });\n      currentMode.drag(event);\n    } else {\n      event.originalEvent.stopPropagation();\n    }\n  };\n\n  events.mousedrag = function(event) {\n    events.drag(event, endInfo => !isClick(mouseDownInfo, endInfo));\n  };\n\n  events.touchdrag = function(event) {\n    events.drag(event, endInfo => !isTap(touchStartInfo, endInfo));\n  };\n\n  events.mousemove = function(event) {\n    const button = event.originalEvent.buttons !== undefined ? event.originalEvent.buttons : event.originalEvent.which;\n    if (button === 1) {\n      return events.mousedrag(event);\n    }\n    const target = getFeaturesAndSetCursor(event, ctx);\n    event.featureTarget = target;\n    currentMode.mousemove(event);\n  };\n\n  events.mousedown = function(event) {\n    mouseDownInfo = {\n      time: new Date().getTime(),\n      point: event.point\n    };\n    const target = getFeaturesAndSetCursor(event, ctx);\n    event.featureTarget = target;\n    currentMode.mousedown(event);\n  };\n\n  events.mouseup = function(event) {\n    const target = getFeaturesAndSetCursor(event, ctx);\n    event.featureTarget = target;\n\n    if (isClick(mouseDownInfo, {\n      point: event.point,\n      time: new Date().getTime()\n    })) {\n      currentMode.click(event);\n    } else {\n      currentMode.mouseup(event);\n    }\n  };\n\n  events.mouseout = function(event) {\n    currentMode.mouseout(event);\n  };\n\n  events.touchstart = function(event) {\n    if (!ctx.options.touchEnabled) {\n      return;\n    }\n\n    touchStartInfo = {\n      time: new Date().getTime(),\n      point: event.point\n    };\n    const target = featuresAt.touch(event, null, ctx)[0];\n    event.featureTarget = target;\n    currentMode.touchstart(event);\n  };\n\n  events.touchmove = function(event) {\n    if (!ctx.options.touchEnabled) {\n      return;\n    }\n\n    currentMode.touchmove(event);\n    return events.touchdrag(event);\n  };\n\n  events.touchend = function(event) {\n    // Prevent emulated mouse events because we will fully handle the touch here.\n    // This does not stop the touch events from propogating to mapbox though.\n    event.originalEvent.preventDefault();\n    if (!ctx.options.touchEnabled) {\n      return;\n    }\n\n    const target = featuresAt.touch(event, null, ctx)[0];\n    event.featureTarget = target;\n    if (isTap(touchStartInfo, {\n      time: new Date().getTime(),\n      point: event.point\n    })) {\n      currentMode.tap(event);\n    } else {\n      currentMode.touchend(event);\n    }\n  };\n\n  // 8 - Backspace\n  // 46 - Delete\n  const isKeyModeValid = code => !(code === 8 || code === 46 || (code >= 48 && code <= 57));\n\n  events.keydown = function(event) {\n    const isMapElement = (event.srcElement || event.target).classList.contains(Constants.classes.CANVAS);\n    if (!isMapElement) return; // we only handle events on the map\n\n    if ((event.keyCode === 8 || event.keyCode === 46) && ctx.options.controls.trash) {\n      event.preventDefault();\n      currentMode.trash();\n    } else if (isKeyModeValid(event.keyCode)) {\n      currentMode.keydown(event);\n    } else if (event.keyCode === 49 && ctx.options.controls.point) {\n      changeMode(Constants.modes.DRAW_POINT);\n    } else if (event.keyCode === 50 && ctx.options.controls.line_string) {\n      changeMode(Constants.modes.DRAW_LINE_STRING);\n    } else if (event.keyCode === 51 && ctx.options.controls.polygon) {\n      changeMode(Constants.modes.DRAW_POLYGON);\n    }\n  };\n\n  events.keyup = function(event) {\n    if (isKeyModeValid(event.keyCode)) {\n      currentMode.keyup(event);\n    }\n  };\n\n  events.zoomend = function() {\n    ctx.store.changeZoom();\n  };\n\n  events.data = function(event) {\n    if (event.dataType === 'style') {\n      const { setup, map, options, store } = ctx;\n      const hasLayers = options.styles.some(style => map.getLayer(style.id));\n      if (!hasLayers) {\n        setup.addLayers();\n        store.setDirty();\n        store.render();\n      }\n    }\n  };\n\n  function changeMode(modename, nextModeOptions, eventOptions = {}) {\n    currentMode.stop();\n\n    const modebuilder = modes[modename];\n    if (modebuilder === undefined) {\n      throw new Error(`${modename} is not valid`);\n    }\n    currentModeName = modename;\n    const mode = modebuilder(ctx, nextModeOptions);\n    currentMode = setupModeHandler(mode, ctx);\n\n    if (!eventOptions.silent) {\n      ctx.map.fire(Constants.events.MODE_CHANGE, { mode: modename});\n    }\n\n    ctx.store.setDirty();\n    ctx.store.render();\n  }\n\n  const actionState = {\n    trash: false,\n    combineFeatures: false,\n    uncombineFeatures: false\n  };\n\n  function actionable(actions) {\n    let changed = false;\n    Object.keys(actions).forEach((action) => {\n      if (actionState[action] === undefined) throw new Error('Invalid action type');\n      if (actionState[action] !== actions[action]) changed = true;\n      actionState[action] = actions[action];\n    });\n    if (changed) ctx.map.fire(Constants.events.ACTIONABLE, { actions: actionState });\n  }\n\n  const api = {\n    start() {\n      currentModeName = ctx.options.defaultMode;\n      currentMode = setupModeHandler(modes[currentModeName](ctx), ctx);\n    },\n    changeMode,\n    actionable,\n    currentModeName() {\n      return currentModeName;\n    },\n    currentModeRender(geojson, push) {\n      return currentMode.render(geojson, push);\n    },\n    fire(eventName, eventData) {\n      if (!ctx.map) return;\n      ctx.map.fire(eventName, eventData);\n    },\n    addEventListeners() {\n      ctx.map.on('mousemove', events.mousemove);\n      ctx.map.on('mousedown', events.mousedown);\n      ctx.map.on('mouseup', events.mouseup);\n      ctx.map.on('data', events.data);\n\n      ctx.map.on('touchmove', events.touchmove);\n      ctx.map.on('touchstart', events.touchstart);\n      ctx.map.on('touchend', events.touchend);\n\n      ctx.container.addEventListener('mouseout', events.mouseout);\n\n      if (ctx.options.keybindings) {\n        ctx.container.addEventListener('keydown', events.keydown);\n        ctx.container.addEventListener('keyup', events.keyup);\n      }\n    },\n    removeEventListeners() {\n      ctx.map.off('mousemove', events.mousemove);\n      ctx.map.off('mousedown', events.mousedown);\n      ctx.map.off('mouseup', events.mouseup);\n      ctx.map.off('data', events.data);\n\n      ctx.map.off('touchmove', events.touchmove);\n      ctx.map.off('touchstart', events.touchstart);\n      ctx.map.off('touchend', events.touchend);\n\n      ctx.container.removeEventListener('mouseout', events.mouseout);\n\n      if (ctx.options.keybindings) {\n        ctx.container.removeEventListener('keydown', events.keydown);\n        ctx.container.removeEventListener('keyup', events.keyup);\n      }\n    },\n    trash(options) {\n      currentMode.trash(options);\n    },\n    combineFeatures() {\n      currentMode.combineFeatures();\n    },\n    uncombineFeatures() {\n      currentMode.uncombineFeatures();\n    },\n    getMode() {\n      return currentModeName;\n    }\n  };\n\n  return api;\n}\n","/* eslint comma-dangle: [\"error\", \"always-multiline\"] */\n\nconst blue = '#3bb2d0';\nconst orange = '#fbb03b';\nconst white = '#fff';\n\nexport default [\n  // Polygons\n  //   Solid fill\n  //   Active state defines color\n  {\n    'id': 'gl-draw-polygon-fill',\n    'type': 'fill',\n    'filter': [\n      'all',\n      ['==', '$type', 'Polygon'],\n    ],\n    'paint': {\n      'fill-color': [\n        'case',\n        ['==', ['get', 'active'], 'true'], orange,\n        blue,\n      ],\n      'fill-opacity': 0.1,\n    },\n  },\n  // Lines\n  // Polygon\n  //   Matches Lines AND Polygons\n  //   Active state defines color\n  {\n    'id': 'gl-draw-lines',\n    'type': 'line',\n    'filter': [\n      'any',\n      ['==', '$type', 'LineString'],\n      ['==', '$type', 'Polygon'],\n    ],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round',\n    },\n    'paint': {\n      'line-color': [\n        'case',\n        ['==', ['get', 'active'], 'true'], orange,\n        blue,\n      ],\n      'line-dasharray': [\n        'case',\n        ['==', ['get', 'active'], 'true'], [0.2, 2],\n        [2, 0],\n      ],\n      'line-width': 2,\n    },\n  },\n  // Points\n  //   Circle with an outline\n  //   Active state defines size and color\n  {\n    'id': 'gl-draw-point-outer',\n    'type': 'circle',\n    'filter': [\n      'all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'feature'],\n    ],\n    'paint': {\n      'circle-radius': [\n        'case',\n        ['==', ['get', 'active'], 'true'], 7,\n        5,\n      ],\n      'circle-color': white,\n    },\n  },\n  {\n    'id': 'gl-draw-point-inner',\n    'type': 'circle',\n    'filter': [\n      'all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'feature'],\n    ],\n    'paint': {\n      'circle-radius': [\n        'case',\n        ['==', ['get', 'active'], 'true'], 5,\n        3,\n      ],\n      'circle-color': [\n        'case',\n        ['==', ['get', 'active'], 'true'], orange,\n        blue,\n      ],\n    },\n  },\n  // Vertex\n  //   Visible when editing polygons and lines\n  //   Similar behaviour to Points\n  //   Active state defines size\n  {\n    'id': 'gl-draw-vertex-outer',\n    'type': 'circle',\n    'filter': [\n      'all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'vertex'],\n      ['!=', 'mode', 'simple_select'],\n    ],\n    'paint': {\n      'circle-radius': [\n        'case',\n        ['==', ['get', 'active'], 'true'], 7,\n        5,\n      ],\n      'circle-color': white,\n    },\n  },\n  {\n    'id': 'gl-draw-vertex-inner',\n    'type': 'circle',\n    'filter': [\n      'all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'vertex'],\n      ['!=', 'mode', 'simple_select'],\n    ],\n    'paint': {\n      'circle-radius': [\n        'case',\n        ['==', ['get', 'active'], 'true'], 5,\n        3,\n      ],\n      'circle-color': orange,\n    },\n  },\n  // Midpoint\n  //   Visible when editing polygons and lines\n  //   Tapping or dragging them adds a new vertex to the feature\n  {\n    'id': 'gl-draw-midpoint',\n    'type': 'circle',\n    'filter': [\n      'all',\n      ['==', 'meta', 'midpoint'],\n    ],\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': orange,\n    },\n  },\n];\n","import * as Constants from '../constants.js';\n\nexport function isOfMetaType(type) {\n  return function(e) {\n    const featureTarget = e.featureTarget;\n    if (!featureTarget) return false;\n    if (!featureTarget.properties) return false;\n    return featureTarget.properties.meta === type;\n  };\n}\n\nexport function isShiftMousedown(e) {\n  if (!e.originalEvent) return false;\n  if (!e.originalEvent.shiftKey) return false;\n  return e.originalEvent.button === 0;\n}\n\nexport function isActiveFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return e.featureTarget.properties.active === Constants.activeStates.ACTIVE &&\n    e.featureTarget.properties.meta === Constants.meta.FEATURE;\n}\n\nexport function isInactiveFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return e.featureTarget.properties.active === Constants.activeStates.INACTIVE &&\n    e.featureTarget.properties.meta === Constants.meta.FEATURE;\n}\n\nexport function noTarget(e) {\n  return e.featureTarget === undefined;\n}\n\nexport function isFeature(e) {\n  if (!e.featureTarget) return false;\n  if (!e.featureTarget.properties) return false;\n  return e.featureTarget.properties.meta === Constants.meta.FEATURE;\n}\n\nexport function isVertex(e) {\n  const featureTarget = e.featureTarget;\n  if (!featureTarget) return false;\n  if (!featureTarget.properties) return false;\n  return featureTarget.properties.meta === Constants.meta.VERTEX;\n}\n\nexport function isShiftDown(e) {\n  if (!e.originalEvent) return false;\n  return e.originalEvent.shiftKey === true;\n}\n\nexport function isEscapeKey(e) {\n  return e.keyCode === 27;\n}\n\nexport function isEnterKey(e) {\n  return e.keyCode === 13;\n}\n\nexport function isTrue() {\n  return true;\n}\n","/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class\n * @param {number} x the x-coordinate. This could be longitude or screen pixels, or any other sort of unit.\n * @param {number} y the y-coordinate. This could be latitude or screen pixels, or any other sort of unit.\n *\n * @example\n * const point = new Point(-77, 38);\n */\nexport default function Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n    /**\n     * Clone this point, returning a new point that can be modified\n     * without affecting the old one.\n     * @return {Point} the clone\n     */\n    clone() { return new Point(this.x, this.y); },\n\n    /**\n     * Add this point's x & y coordinates to another point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    add(p) { return this.clone()._add(p); },\n\n    /**\n     * Subtract this point's x & y coordinates to from point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    sub(p) { return this.clone()._sub(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    multByPoint(p) { return this.clone()._multByPoint(p); },\n\n    /**\n     * Divide this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    divByPoint(p) { return this.clone()._divByPoint(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {number} k factor\n     * @return {Point} output point\n     */\n    mult(k) { return this.clone()._mult(k); },\n\n    /**\n     * Divide this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {number} k factor\n     * @return {Point} output point\n     */\n    div(k) { return this.clone()._div(k); },\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * @param {number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate(a) { return this.clone()._rotate(a); },\n\n    /**\n     * Rotate this point around p point by an angle a,\n     * given in radians\n     * @param {number} a angle to rotate around, in radians\n     * @param {Point} p Point to rotate around\n     * @return {Point} output point\n     */\n    rotateAround(a, p) { return this.clone()._rotateAround(a, p); },\n\n    /**\n     * Multiply this point by a 4x1 transformation matrix\n     * @param {[number, number, number, number]} m transformation matrix\n     * @return {Point} output point\n     */\n    matMult(m) { return this.clone()._matMult(m); },\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit() { return this.clone()._unit(); },\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp() { return this.clone()._perp(); },\n\n    /**\n     * Return a version of this point with the x & y coordinates\n     * rounded to integers.\n     * @return {Point} rounded point\n     */\n    round() { return this.clone()._round(); },\n\n    /**\n     * Return the magnitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {number} magnitude\n     */\n    mag() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    /**\n     * Judge whether this point is equal to another point, returning\n     * true or false.\n     * @param {Point} other the other point\n     * @return {boolean} whether the points are equal\n     */\n    equals(other) {\n        return this.x === other.x &&\n               this.y === other.y;\n    },\n\n    /**\n     * Calculate the distance from this point to another point\n     * @param {Point} p the other point\n     * @return {number} distance\n     */\n    dist(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    /**\n     * Calculate the distance from this point to another point,\n     * without the square root step. Useful if you're comparing\n     * relative distances.\n     * @param {Point} p the other point\n     * @return {number} distance\n     */\n    distSqr(p) {\n        const dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    /**\n     * Get the angle from the 0, 0 coordinate to this point, in radians\n     * coordinates.\n     * @return {number} angle\n     */\n    angle() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    /**\n     * Get the angle from this point to another point, in radians\n     * @param {Point} b the other point\n     * @return {number} angle\n     */\n    angleTo(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * @param {Point} b the other point\n     * @return {number} angle\n     */\n    angleWith(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    /**\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * @param {number} x the x-coordinate\n     * @param {number} y the y-coordinate\n     * @return {number} the angle in radians\n     */\n    angleWithSep(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    /** @param {[number, number, number, number]} m */\n    _matMult(m) {\n        const x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _add(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _sub(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    /** @param {number} k */\n    _mult(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    /** @param {number} k */\n    _div(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _multByPoint(p) {\n        this.x *= p.x;\n        this.y *= p.y;\n        return this;\n    },\n\n    /** @param {Point} p */\n    _divByPoint(p) {\n        this.x /= p.x;\n        this.y /= p.y;\n        return this;\n    },\n\n    _unit() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp() {\n        const y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    /** @param {number} angle */\n    _rotate(angle) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    /**\n     * @param {number} angle\n     * @param {Point} p\n     */\n    _rotateAround(angle, p) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n            y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    },\n\n    constructor: Point\n};\n\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, return it unchanged.\n * @param {Point | [number, number] | {x: number, y: number}} p input value\n * @return {Point} constructed point.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\nPoint.convert = function (p) {\n    if (p instanceof Point) {\n        return /** @type {Point} */ (p);\n    }\n    if (Array.isArray(p)) {\n        return new Point(+p[0], +p[1]);\n    }\n    if (p.x !== undefined && p.y !== undefined) {\n        return new Point(+p.x, +p.y);\n    }\n    throw new Error('Expected [x, y] or {x, y} point format');\n};\n","import Point from '@mapbox/point-geometry';\n\n/**\n * Returns a Point representing a mouse event's position\n * relative to a containing element.\n *\n * @param {MouseEvent} mouseEvent\n * @param {Node} container\n * @returns {Point}\n */\nfunction mouseEventPoint(mouseEvent, container) {\n  const rect = container.getBoundingClientRect();\n  return new Point(\n    mouseEvent.clientX - rect.left - (container.clientLeft || 0),\n    mouseEvent.clientY - rect.top - (container.clientTop || 0)\n  );\n}\n\nexport default mouseEventPoint;\n","import * as Constants from '../constants.js';\n\n/**\n * Returns GeoJSON for a Point representing the\n * vertex of another feature.\n *\n * @param {string} parentId\n * @param {Array<number>} coordinates\n * @param {string} path - Dot-separated numbers indicating exactly\n *   where the point exists within its parent feature's coordinates.\n * @param {boolean} selected\n * @return {GeoJSON} Point\n */\n\nexport default function(parentId, coordinates, path, selected) {\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.VERTEX,\n      parent: parentId,\n      coord_path: path,\n      active: (selected) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates\n    }\n  };\n}\n","import * as Constants from '../constants.js';\n\nexport default function(parent, startVertex, endVertex) {\n  const startCoord = startVertex.geometry.coordinates;\n  const endCoord = endVertex.geometry.coordinates;\n\n  // If a coordinate exceeds the projection, we can't calculate a midpoint,\n  // so run away\n  if (startCoord[1] > Constants.LAT_RENDERED_MAX ||\n    startCoord[1] < Constants.LAT_RENDERED_MIN ||\n    endCoord[1] > Constants.LAT_RENDERED_MAX ||\n    endCoord[1] < Constants.LAT_RENDERED_MIN) {\n    return null;\n  }\n\n  const mid = {\n    lng: (startCoord[0] + endCoord[0]) / 2,\n    lat: (startCoord[1] + endCoord[1]) / 2\n  };\n\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.MIDPOINT,\n      parent,\n      lng: mid.lng,\n      lat: mid.lat,\n      coord_path: endVertex.properties.coord_path\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: [mid.lng, mid.lat]\n    }\n  };\n}\n","import createVertex from './create_vertex.js';\nimport createMidpoint from './create_midpoint.js';\nimport * as Constants from '../constants.js';\n\nfunction createSupplementaryPoints(geojson, options = {}, basePath = null) {\n  const { type, coordinates } = geojson.geometry;\n  const featureId = geojson.properties && geojson.properties.id;\n\n  let supplementaryPoints = [];\n\n  if (type === Constants.geojsonTypes.POINT) {\n    // For points, just create a vertex\n    supplementaryPoints.push(createVertex(featureId, coordinates, basePath, isSelectedPath(basePath)));\n  } else if (type === Constants.geojsonTypes.POLYGON) {\n    // Cycle through a Polygon's rings and\n    // process each line\n    coordinates.forEach((line, lineIndex) => {\n      processLine(line, (basePath !== null) ? `${basePath}.${lineIndex}` : String(lineIndex));\n    });\n  } else if (type === Constants.geojsonTypes.LINE_STRING) {\n    processLine(coordinates, basePath);\n  } else if (type.indexOf(Constants.geojsonTypes.MULTI_PREFIX) === 0) {\n    processMultiGeometry();\n  }\n\n  function processLine(line, lineBasePath) {\n    let firstPointString = '';\n    let lastVertex = null;\n    line.forEach((point, pointIndex) => {\n      const pointPath = (lineBasePath !== undefined && lineBasePath !== null) ? `${lineBasePath}.${pointIndex}` : String(pointIndex);\n      const vertex = createVertex(featureId, point, pointPath, isSelectedPath(pointPath));\n\n      // If we're creating midpoints, check if there was a\n      // vertex before this one. If so, add a midpoint\n      // between that vertex and this one.\n      if (options.midpoints && lastVertex) {\n        const midpoint = createMidpoint(featureId, lastVertex, vertex);\n        if (midpoint) {\n          supplementaryPoints.push(midpoint);\n        }\n      }\n      lastVertex = vertex;\n\n      // A Polygon line's last point is the same as the first point. If we're on the last\n      // point, we want to draw a midpoint before it but not another vertex on it\n      // (since we already a vertex there, from the first point).\n      const stringifiedPoint = JSON.stringify(point);\n      if (firstPointString !== stringifiedPoint) {\n        supplementaryPoints.push(vertex);\n      }\n      if (pointIndex === 0) {\n        firstPointString = stringifiedPoint;\n      }\n    });\n  }\n\n  function isSelectedPath(path) {\n    if (!options.selectedPaths) return false;\n    return options.selectedPaths.indexOf(path) !== -1;\n  }\n\n  // Split a multi-geometry into constituent\n  // geometries, and accumulate the supplementary points\n  // for each of those constituents\n  function processMultiGeometry() {\n    const subType = type.replace(Constants.geojsonTypes.MULTI_PREFIX, '');\n    coordinates.forEach((subCoordinates, index) => {\n      const subFeature = {\n        type: Constants.geojsonTypes.FEATURE,\n        properties: geojson.properties,\n        geometry: {\n          type: subType,\n          coordinates: subCoordinates\n        }\n      };\n      supplementaryPoints = supplementaryPoints.concat(createSupplementaryPoints(subFeature, options, index));\n    });\n  }\n\n  return supplementaryPoints;\n}\n\nexport default createSupplementaryPoints;\n","export default {\n  enable(ctx) {\n    setTimeout(() => {\n      // First check we've got a map and some context.\n      if (!ctx.map || !ctx.map.doubleClickZoom || !ctx._ctx || !ctx._ctx.store || !ctx._ctx.store.getInitialConfigValue) return;\n      // Now check initial state wasn't false (we leave it disabled if so)\n      if (!ctx._ctx.store.getInitialConfigValue('doubleClickZoom')) return;\n      ctx.map.doubleClickZoom.enable();\n    }, 0);\n  },\n  disable(ctx) {\n    setTimeout(() => {\n      if (!ctx.map || !ctx.map.doubleClickZoom) return;\n      // Always disable here, as it's necessary in some cases.\n      ctx.map.doubleClickZoom.disable();\n    }, 0);\n  }\n};\n","import * as Constants from '../constants.js';\n\nconst {\n  LAT_MIN,\n  LAT_MAX,\n  LAT_RENDERED_MIN,\n  LAT_RENDERED_MAX,\n  LNG_MIN,\n  LNG_MAX,\n} = Constants;\nfunction extent(feature) {\n  const depth = {\n    Point: 0,\n    LineString: 1,\n    Polygon: 2,\n    MultiPoint: 1,\n    MultiLineString: 2,\n    MultiPolygon: 3,\n  }[feature.geometry.type];\n\n  const coords = [feature.geometry.coordinates].flat(depth);\n  const lngs = coords.map(coord => coord[0]);\n  const lats = coords.map(coord => coord[1]);\n  const min = vals => Math.min.apply(null, vals);\n  const max = vals => Math.max.apply(null, vals);\n  return [min(lngs), min(lats), max(lngs), max(lats)];\n}\n\n// Ensure that we do not drag north-south far enough for\n// - any part of any feature to exceed the poles\n// - any feature to be completely lost in the space between the projection's\n//   edge and the poles, such that it couldn't be re-selected and moved back\nexport default function(geojsonFeatures, delta) {\n  // \"inner edge\" = a feature's latitude closest to the equator\n  let northInnerEdge = LAT_MIN;\n  let southInnerEdge = LAT_MAX;\n  // \"outer edge\" = a feature's latitude furthest from the equator\n  let northOuterEdge = LAT_MIN;\n  let southOuterEdge = LAT_MAX;\n\n  let westEdge = LNG_MAX;\n  let eastEdge = LNG_MIN;\n\n  geojsonFeatures.forEach((feature) => {\n    const bounds = extent(feature);\n    const featureSouthEdge = bounds[1];\n    const featureNorthEdge = bounds[3];\n    const featureWestEdge = bounds[0];\n    const featureEastEdge = bounds[2];\n    if (featureSouthEdge > northInnerEdge) northInnerEdge = featureSouthEdge;\n    if (featureNorthEdge < southInnerEdge) southInnerEdge = featureNorthEdge;\n    if (featureNorthEdge > northOuterEdge) northOuterEdge = featureNorthEdge;\n    if (featureSouthEdge < southOuterEdge) southOuterEdge = featureSouthEdge;\n    if (featureWestEdge < westEdge) westEdge = featureWestEdge;\n    if (featureEastEdge > eastEdge) eastEdge = featureEastEdge;\n  });\n\n\n  // These changes are not mutually exclusive: we might hit the inner\n  // edge but also have hit the outer edge and therefore need\n  // another readjustment\n  const constrainedDelta = delta;\n  if (northInnerEdge + constrainedDelta.lat > LAT_RENDERED_MAX) {\n    constrainedDelta.lat = LAT_RENDERED_MAX - northInnerEdge;\n  }\n  if (northOuterEdge + constrainedDelta.lat > LAT_MAX) {\n    constrainedDelta.lat = LAT_MAX - northOuterEdge;\n  }\n  if (southInnerEdge + constrainedDelta.lat < LAT_RENDERED_MIN) {\n    constrainedDelta.lat = LAT_RENDERED_MIN - southInnerEdge;\n  }\n  if (southOuterEdge + constrainedDelta.lat < LAT_MIN) {\n    constrainedDelta.lat = LAT_MIN - southOuterEdge;\n  }\n  if (westEdge + constrainedDelta.lng <= LNG_MIN) {\n    constrainedDelta.lng += Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n  if (eastEdge + constrainedDelta.lng >= LNG_MAX) {\n    constrainedDelta.lng -= Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n\n  return constrainedDelta;\n}\n","import constrainFeatureMovement from './constrain_feature_movement.js';\nimport * as Constants from '../constants.js';\n\nexport default function(features, delta) {\n  const constrainedDelta = constrainFeatureMovement(features.map(feature => feature.toGeoJSON()), delta);\n\n  features.forEach((feature) => {\n    const currentCoordinates = feature.getCoordinates();\n\n    const moveCoordinate = (coord) => {\n      const point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat\n      };\n      return [point.lng, point.lat];\n    };\n    const moveRing = ring => ring.map(coord => moveCoordinate(coord));\n    const moveMultiPolygon = multi => multi.map(ring => moveRing(ring));\n\n    let nextCoordinates;\n    if (feature.type === Constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (feature.type === Constants.geojsonTypes.LINE_STRING || feature.type === Constants.geojsonTypes.MULTI_POINT) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (feature.type === Constants.geojsonTypes.POLYGON || feature.type === Constants.geojsonTypes.MULTI_LINE_STRING) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === Constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n}\n","import * as CommonSelectors from '../lib/common_selectors.js';\nimport mouseEventPoint from '../lib/mouse_event_point.js';\nimport createSupplementaryPoints from '../lib/create_supplementary_points.js';\nimport StringSet from '../lib/string_set.js';\nimport doubleClickZoom from '../lib/double_click_zoom.js';\nimport moveFeatures from '../lib/move_features.js';\nimport * as Constants from '../constants.js';\n\nconst SimpleSelect = {};\n\nSimpleSelect.onSetup = function(opts) {\n  // turn the opts into state.\n  const state = {\n    dragMoveLocation: null,\n    boxSelectStartLocation: null,\n    boxSelectElement: undefined,\n    boxSelecting: false,\n    canBoxSelect: false,\n    dragMoving: false,\n    canDragMove: false,\n    initialDragPanState: this.map.dragPan.isEnabled(),\n    initiallySelectedFeatureIds: opts.featureIds || []\n  };\n\n  this.setSelected(state.initiallySelectedFeatureIds.filter(id => this.getFeature(id) !== undefined));\n  this.fireActionable();\n\n  this.setActionableState({\n    combineFeatures: true,\n    uncombineFeatures: true,\n    trash: true\n  });\n\n  return state;\n};\n\nSimpleSelect.fireUpdate = function() {\n  this.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.MOVE,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nSimpleSelect.fireActionable = function() {\n  const selectedFeatures = this.getSelected();\n\n  const multiFeatures = selectedFeatures.filter(\n    feature => this.isInstanceOf('MultiFeature', feature)\n  );\n\n  let combineFeatures = false;\n\n  if (selectedFeatures.length > 1) {\n    combineFeatures = true;\n    const featureType = selectedFeatures[0].type.replace('Multi', '');\n    selectedFeatures.forEach((feature) => {\n      if (feature.type.replace('Multi', '') !== featureType) {\n        combineFeatures = false;\n      }\n    });\n  }\n\n  const uncombineFeatures = multiFeatures.length > 0;\n  const trash = selectedFeatures.length > 0;\n\n  this.setActionableState({\n    combineFeatures, uncombineFeatures, trash\n  });\n};\n\nSimpleSelect.getUniqueIds = function(allFeatures) {\n  if (!allFeatures.length) return [];\n  const ids = allFeatures.map(s => s.properties.id)\n    .filter(id => id !== undefined)\n    .reduce((memo, id) => {\n      memo.add(id);\n      return memo;\n    }, new StringSet());\n\n  return ids.values();\n};\n\nSimpleSelect.stopExtendedInteractions = function(state) {\n  if (state.boxSelectElement) {\n    if (state.boxSelectElement.parentNode) state.boxSelectElement.parentNode.removeChild(state.boxSelectElement);\n    state.boxSelectElement = null;\n  }\n\n  if ((state.canDragMove || state.canBoxSelect) && state.initialDragPanState === true) {\n    this.map.dragPan.enable();\n  }\n\n  state.boxSelecting = false;\n  state.canBoxSelect = false;\n  state.dragMoving = false;\n  state.canDragMove = false;\n};\n\nSimpleSelect.onStop = function() {\n  doubleClickZoom.enable(this);\n};\n\nSimpleSelect.onMouseMove = function(state, e) {\n  const isFeature = CommonSelectors.isFeature(e);\n  if (isFeature && state.dragMoving) this.fireUpdate();\n\n  // On mousemove that is not a drag, stop extended interactions.\n  // This is useful if you drag off the canvas, release the button,\n  // then move the mouse back over the canvas --- we don't allow the\n  // interaction to continue then, but we do let it continue if you held\n  // the mouse button that whole time\n  this.stopExtendedInteractions(state);\n\n  // Skip render\n  return true;\n};\n\nSimpleSelect.onMouseOut = function(state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) return this.fireUpdate();\n\n  // Skip render\n  return true;\n};\n\nSimpleSelect.onTap = SimpleSelect.onClick = function(state, e) {\n  // Click (with or without shift) on no feature\n  if (CommonSelectors.noTarget(e)) return this.clickAnywhere(state, e); // also tap\n  if (CommonSelectors.isOfMetaType(Constants.meta.VERTEX)(e)) return this.clickOnVertex(state, e); //tap\n  if (CommonSelectors.isFeature(e)) return this.clickOnFeature(state, e);\n};\n\nSimpleSelect.clickAnywhere = function (state) {\n  // Clear the re-render selection\n  const wasSelected = this.getSelectedIds();\n  if (wasSelected.length) {\n    this.clearSelectedFeatures();\n    wasSelected.forEach(id => this.doRender(id));\n  }\n  doubleClickZoom.enable(this);\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.clickOnVertex = function(state, e) {\n  // Enter direct select mode\n  this.changeMode(Constants.modes.DIRECT_SELECT, {\n    featureId: e.featureTarget.properties.parent,\n    coordPath: e.featureTarget.properties.coord_path,\n    startPos: e.lngLat\n  });\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n};\n\nSimpleSelect.startOnActiveFeature = function(state, e) {\n  // Stop any already-underway extended interactions\n  this.stopExtendedInteractions(state);\n\n  // Disable map.dragPan immediately so it can't start\n  this.map.dragPan.disable();\n\n  // Re-render it and enable drag move\n  this.doRender(e.featureTarget.properties.id);\n\n  // Set up the state for drag moving\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.clickOnFeature = function(state, e) {\n  // Stop everything\n  doubleClickZoom.disable(this);\n  this.stopExtendedInteractions(state);\n\n  const isShiftClick = CommonSelectors.isShiftDown(e);\n  const selectedFeatureIds = this.getSelectedIds();\n  const featureId = e.featureTarget.properties.id;\n  const isFeatureSelected = this.isSelected(featureId);\n\n  // Click (without shift) on any selected feature but a point\n  if (!isShiftClick && isFeatureSelected && this.getFeature(featureId).type !== Constants.geojsonTypes.POINT) {\n    // Enter direct select mode\n    return this.changeMode(Constants.modes.DIRECT_SELECT, {\n      featureId\n    });\n  }\n\n  // Shift-click on a selected feature\n  if (isFeatureSelected && isShiftClick) {\n    // Deselect it\n    this.deselect(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n    if (selectedFeatureIds.length === 1) {\n      doubleClickZoom.enable(this);\n    }\n  // Shift-click on an unselected feature\n  } else if (!isFeatureSelected && isShiftClick) {\n    // Add it to the selection\n    this.select(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  // Click (without shift) on an unselected feature\n  } else if (!isFeatureSelected && !isShiftClick) {\n    // Make it the only selected feature\n    selectedFeatureIds.forEach(id => this.doRender(id));\n    this.setSelected(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  }\n\n  // No matter what, re-render the clicked feature\n  this.doRender(featureId);\n};\n\nSimpleSelect.onMouseDown = function(state, e) {\n  state.initialDragPanState = this.map.dragPan.isEnabled();\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n  if (this.drawConfig.boxSelect && CommonSelectors.isShiftMousedown(e)) return this.startBoxSelect(state, e);\n};\n\nSimpleSelect.startBoxSelect = function(state, e) {\n  this.stopExtendedInteractions(state);\n  this.map.dragPan.disable();\n  // Enable box select\n  state.boxSelectStartLocation = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  state.canBoxSelect = true;\n};\n\nSimpleSelect.onTouchStart = function(state, e) {\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n};\n\nSimpleSelect.onDrag = function(state, e) {\n  if (state.canDragMove) return this.dragMove(state, e);\n  if (this.drawConfig.boxSelect && state.canBoxSelect) return this.whileBoxSelect(state, e);\n};\n\nSimpleSelect.whileBoxSelect = function(state, e) {\n  state.boxSelecting = true;\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n\n  // Create the box node if it doesn't exist\n  if (!state.boxSelectElement) {\n    state.boxSelectElement = document.createElement('div');\n    state.boxSelectElement.classList.add(Constants.classes.BOX_SELECT);\n    this.map.getContainer().appendChild(state.boxSelectElement);\n  }\n\n  // Adjust the box node's width and xy position\n  const current = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  const minX = Math.min(state.boxSelectStartLocation.x, current.x);\n  const maxX = Math.max(state.boxSelectStartLocation.x, current.x);\n  const minY = Math.min(state.boxSelectStartLocation.y, current.y);\n  const maxY = Math.max(state.boxSelectStartLocation.y, current.y);\n  const translateValue = `translate(${minX}px, ${minY}px)`;\n  state.boxSelectElement.style.transform = translateValue;\n  state.boxSelectElement.style.WebkitTransform = translateValue;\n  state.boxSelectElement.style.width = `${maxX - minX}px`;\n  state.boxSelectElement.style.height = `${maxY - minY}px`;\n};\n\nSimpleSelect.dragMove = function(state, e) {\n  // Dragging when drag move is enabled\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n\n  moveFeatures(this.getSelected(), delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.onTouchEnd = SimpleSelect.onMouseUp = function(state, e) {\n  // End any extended interactions\n  if (state.dragMoving) {\n    this.fireUpdate();\n  } else if (state.boxSelecting) {\n    const bbox = [\n      state.boxSelectStartLocation,\n      mouseEventPoint(e.originalEvent, this.map.getContainer())\n    ];\n    const featuresInBox = this.featuresAt(null, bbox, 'click');\n    const idsToSelect = this.getUniqueIds(featuresInBox)\n      .filter(id => !this.isSelected(id));\n\n    if (idsToSelect.length) {\n      this.select(idsToSelect);\n      idsToSelect.forEach(id => this.doRender(id));\n      this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    }\n  }\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.toDisplayFeatures = function(state, geojson, display) {\n  geojson.properties.active = (this.isSelected(geojson.properties.id)) ?\n    Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  display(geojson);\n  this.fireActionable();\n  if (geojson.properties.active !== Constants.activeStates.ACTIVE ||\n    geojson.geometry.type === Constants.geojsonTypes.POINT) return;\n  createSupplementaryPoints(geojson).forEach(display);\n};\n\nSimpleSelect.onTrash = function() {\n  this.deleteFeature(this.getSelectedIds());\n  this.fireActionable();\n};\n\nSimpleSelect.onCombineFeatures = function() {\n  const selectedFeatures = this.getSelected();\n\n  if (selectedFeatures.length === 0 || selectedFeatures.length < 2) return;\n\n  const coordinates = [], featuresCombined = [];\n  const featureType = selectedFeatures[0].type.replace('Multi', '');\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (feature.type.replace('Multi', '') !== featureType) {\n      return;\n    }\n    if (feature.type.includes('Multi')) {\n      feature.getCoordinates().forEach((subcoords) => {\n        coordinates.push(subcoords);\n      });\n    } else {\n      coordinates.push(feature.getCoordinates());\n    }\n\n    featuresCombined.push(feature.toGeoJSON());\n  }\n\n  if (featuresCombined.length > 1) {\n    const multiFeature = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: featuresCombined[0].properties,\n      geometry: {\n        type: `Multi${featureType}`,\n        coordinates\n      }\n    });\n\n    this.addFeature(multiFeature);\n    this.deleteFeature(this.getSelectedIds(), { silent: true });\n    this.setSelected([multiFeature.id]);\n\n    this.fire(Constants.events.COMBINE_FEATURES, {\n      createdFeatures: [multiFeature.toGeoJSON()],\n      deletedFeatures: featuresCombined\n    });\n  }\n  this.fireActionable();\n};\n\nSimpleSelect.onUncombineFeatures = function() {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0) return;\n\n  const createdFeatures = [];\n  const featuresUncombined = [];\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (this.isInstanceOf('MultiFeature', feature)) {\n      feature.getFeatures().forEach((subFeature) => {\n        this.addFeature(subFeature);\n        subFeature.properties = feature.properties;\n        createdFeatures.push(subFeature.toGeoJSON());\n        this.select([subFeature.id]);\n      });\n      this.deleteFeature(feature.id, { silent: true });\n      featuresUncombined.push(feature.toGeoJSON());\n    }\n  }\n\n  if (createdFeatures.length > 1) {\n    this.fire(Constants.events.UNCOMBINE_FEATURES, {\n      createdFeatures,\n      deletedFeatures: featuresUncombined\n    });\n  }\n  this.fireActionable();\n};\n\nexport default SimpleSelect;\n","import { noTarget, isOfMetaType, isActiveFeature, isInactiveFeature, isShiftDown } from '../lib/common_selectors.js';\nimport createSupplementaryPoints from '../lib/create_supplementary_points.js';\nimport constrainFeatureMovement from '../lib/constrain_feature_movement.js';\nimport doubleClickZoom from '../lib/double_click_zoom.js';\nimport * as Constants from '../constants.js';\nimport moveFeatures from '../lib/move_features.js';\n\nconst isVertex = isOfMetaType(Constants.meta.VERTEX);\nconst isMidpoint = isOfMetaType(Constants.meta.MIDPOINT);\n\nconst DirectSelect = {};\n\n// INTERNAL FUCNTIONS\n\nDirectSelect.fireUpdate = function() {\n  this.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.CHANGE_COORDINATES,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nDirectSelect.fireActionable = function(state) {\n  this.setActionableState({\n    combineFeatures: false,\n    uncombineFeatures: false,\n    trash: state.selectedCoordPaths.length > 0\n  });\n};\n\nDirectSelect.startDragging = function(state, e) {\n  state.initialDragPanState = this.map.dragPan.isEnabled();\n\n  this.map.dragPan.disable();\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.stopDragging = function(state) {\n  if (state.canDragMove && state.initialDragPanState === true) {\n    this.map.dragPan.enable();\n  }\n  state.dragMoving = false;\n  state.canDragMove = false;\n  state.dragMoveLocation = null;\n};\n\nDirectSelect.onVertex = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  const selectedIndex = state.selectedCoordPaths.indexOf(about.coord_path);\n  if (!isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths = [about.coord_path];\n  } else if (isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths.push(about.coord_path);\n  }\n\n  const selectedCoordinates = this.pathsToCoordinates(state.featureId, state.selectedCoordPaths);\n  this.setSelectedCoordinates(selectedCoordinates);\n};\n\nDirectSelect.onMidpoint = function(state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  state.feature.addCoordinate(about.coord_path, about.lng, about.lat);\n  this.fireUpdate();\n  state.selectedCoordPaths = [about.coord_path];\n};\n\nDirectSelect.pathsToCoordinates = function(featureId, paths) {\n  return paths.map(coord_path => ({ feature_id: featureId, coord_path }));\n};\n\nDirectSelect.onFeature = function(state, e) {\n  if (state.selectedCoordPaths.length === 0) this.startDragging(state, e);\n  else this.stopDragging(state);\n};\n\nDirectSelect.dragFeature = function(state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.dragVertex = function(state, e, delta) {\n  const selectedCoords = state.selectedCoordPaths.map(coord_path => state.feature.getCoordinate(coord_path));\n  const selectedCoordPoints = selectedCoords.map(coords => ({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: coords\n    }\n  }));\n\n  const constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n  for (let i = 0; i < selectedCoords.length; i++) {\n    const coord = selectedCoords[i];\n    state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n  }\n};\n\nDirectSelect.clickNoTarget = function () {\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickInactive = function () {\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickActiveFeature = function (state) {\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  state.feature.changed();\n};\n\n// EXTERNAL FUNCTIONS\n\nDirectSelect.onSetup = function(opts) {\n  const featureId = opts.featureId;\n  const feature = this.getFeature(featureId);\n\n  if (!feature) {\n    throw new Error('You must provide a featureId to enter direct_select mode');\n  }\n\n  if (feature.type === Constants.geojsonTypes.POINT) {\n    throw new TypeError('direct_select mode doesn\\'t handle point features');\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : [],\n  };\n\n  this.setSelectedCoordinates(this.pathsToCoordinates(featureId, state.selectedCoordPaths));\n  this.setSelected(featureId);\n  doubleClickZoom.disable(this);\n\n  this.setActionableState({\n    trash: true\n  });\n\n  return state;\n};\n\nDirectSelect.onStop = function() {\n  doubleClickZoom.enable(this);\n  this.clearSelectedCoordinates();\n};\n\nDirectSelect.toDisplayFeatures = function(state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths\n    }).forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\n\nDirectSelect.onTrash = function(state) {\n  // Uses number-aware sorting to make sure '9' < '10'. Comparison is reversed because we want them\n  // in reverse order so that we can remove by index safely.\n  state.selectedCoordPaths\n    .sort((a, b) => b.localeCompare(a, 'en', { numeric: true }))\n    .forEach(id => state.feature.removeCoordinate(id));\n  this.fireUpdate();\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  this.fireActionable(state);\n  if (state.feature.isValid() === false) {\n    this.deleteFeature([state.featureId]);\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {});\n  }\n};\n\nDirectSelect.onMouseMove = function(state, e) {\n  // On mousemove that is not a drag, stop vertex movement.\n  const isFeature = isActiveFeature(e);\n  const onVertex = isVertex(e);\n  const isMidPoint = isMidpoint(e);\n  const noCoords = state.selectedCoordPaths.length === 0;\n  if (isFeature && noCoords) this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else if (onVertex && !noCoords) this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else this.updateUIClasses({ mouse: Constants.cursors.NONE });\n\n  const isDraggableItem = onVertex || isFeature || isMidPoint;\n  if (isDraggableItem && state.dragMoving) this.fireUpdate();\n\n  this.stopDragging(state);\n\n  // Skip render\n  return true;\n};\n\nDirectSelect.onMouseOut = function(state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) this.fireUpdate();\n\n  // Skip render\n  return true;\n};\n\nDirectSelect.onTouchStart = DirectSelect.onMouseDown = function(state, e) {\n  if (isVertex(e)) return this.onVertex(state, e);\n  if (isActiveFeature(e)) return this.onFeature(state, e);\n  if (isMidpoint(e)) return this.onMidpoint(state, e);\n};\n\nDirectSelect.onDrag = function(state, e) {\n  if (state.canDragMove !== true) return;\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n  if (state.selectedCoordPaths.length > 0) this.dragVertex(state, e, delta);\n  else this.dragFeature(state, e, delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.onClick = function(state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n  this.stopDragging(state);\n};\n\nDirectSelect.onTap = function(state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n};\n\nDirectSelect.onTouchEnd = DirectSelect.onMouseUp = function(state) {\n  if (state.dragMoving) {\n    this.fireUpdate();\n  }\n  this.stopDragging(state);\n};\n\nexport default DirectSelect;\n\n","import * as CommonSelectors from '../lib/common_selectors.js';\nimport * as Constants from '../constants.js';\n\nconst DrawPoint = {};\n\nDrawPoint.onSetup = function() {\n  const point = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: []\n    }\n  });\n\n  this.addFeature(point);\n\n  this.clearSelectedFeatures();\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POINT);\n\n  this.setActionableState({\n    trash: true\n  });\n\n  return { point };\n};\n\nDrawPoint.stopDrawingAndRemove = function(state) {\n  this.deleteFeature([state.point.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDrawPoint.onTap = DrawPoint.onClick = function(state, e) {\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  state.point.updateCoordinate('', e.lngLat.lng, e.lngLat.lat);\n  this.fire(Constants.events.CREATE, {\n    features: [state.point.toGeoJSON()]\n  });\n  this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.point.id] });\n};\n\nDrawPoint.onStop = function(state) {\n  this.activateUIButton();\n  if (!state.point.getCoordinate().length) {\n    this.deleteFeature([state.point.id], { silent: true });\n  }\n};\n\nDrawPoint.toDisplayFeatures = function(state, geojson, display) {\n  // Never render the point we're drawing\n  const isActivePoint = geojson.properties.id === state.point.id;\n  geojson.properties.active = (isActivePoint) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActivePoint) return display(geojson);\n};\n\nDrawPoint.onTrash = DrawPoint.stopDrawingAndRemove;\n\nDrawPoint.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEscapeKey(e) || CommonSelectors.isEnterKey(e)) {\n    return this.stopDrawingAndRemove(state, e);\n  }\n};\n\nexport default DrawPoint;\n","function isEventAtCoordinates(event, coordinates) {\n  if (!event.lngLat) return false;\n  return event.lngLat.lng === coordinates[0] && event.lngLat.lat === coordinates[1];\n}\n\nexport default isEventAtCoordinates;\n","import * as CommonSelectors from '../lib/common_selectors.js';\nimport doubleClickZoom from '../lib/double_click_zoom.js';\nimport * as Constants from '../constants.js';\nimport isEventAtCoordinates from '../lib/is_event_at_coordinates.js';\nimport createVertex from '../lib/create_vertex.js';\n\nconst DrawPolygon = {};\n\nDrawPolygon.onSetup = function() {\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n\n  this.addFeature(polygon);\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n\n  return {\n    polygon,\n    currentVertexPosition: 0\n  };\n};\n\nDrawPolygon.clickAnywhere = function(state, e) {\n  if (state.currentVertexPosition > 0 && isEventAtCoordinates(e, state.polygon.coordinates[0][state.currentVertexPosition - 1])) {\n    return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n  state.currentVertexPosition++;\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n};\n\nDrawPolygon.clickOnVertex = function(state) {\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n};\n\nDrawPolygon.onMouseMove = function(state, e) {\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nDrawPolygon.onTap = DrawPolygon.onClick = function(state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  return this.clickAnywhere(state, e);\n};\n\nDrawPolygon.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT);\n  } else if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n  }\n};\n\nDrawPolygon.onStop = function(state) {\n  this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.polygon.id) === undefined) return;\n\n  //remove last added coordinate\n  state.polygon.removeCoordinate(`0.${state.currentVertexPosition}`);\n  if (state.polygon.isValid()) {\n    this.fire(Constants.events.CREATE, {\n      features: [state.polygon.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {}, { silent: true });\n  }\n};\n\nDrawPolygon.toDisplayFeatures = function(state, geojson, display) {\n  const isActivePolygon = geojson.properties.id === state.polygon.id;\n  geojson.properties.active = (isActivePolygon) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActivePolygon) return display(geojson);\n\n  // Don't render a polygon until it has two positions\n  // (and a 3rd which is just the first repeated)\n  if (geojson.geometry.coordinates.length === 0) return;\n\n  const coordinateCount = geojson.geometry.coordinates[0].length;\n  // 2 coordinates after selecting a draw type\n  // 3 after creating the first point\n  if (coordinateCount < 3) {\n    return;\n  }\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(createVertex(state.polygon.id, geojson.geometry.coordinates[0][0], '0.0', false));\n  if (coordinateCount > 3) {\n    // Add a start position marker to the map, clicking on this will finish the feature\n    // This should only be shown when we're in a valid spot\n    const endPos = geojson.geometry.coordinates[0].length - 3;\n    display(createVertex(state.polygon.id, geojson.geometry.coordinates[0][endPos], `0.${endPos}`, false));\n  }\n  if (coordinateCount <= 4) {\n    // If we've only drawn two positions (plus the closer),\n    // make a LineString instead of a Polygon\n    const lineCoordinates = [\n      [geojson.geometry.coordinates[0][0][0], geojson.geometry.coordinates[0][0][1]], [geojson.geometry.coordinates[0][1][0], geojson.geometry.coordinates[0][1][1]]\n    ];\n    // create an initial vertex so that we can track the first point on mobile devices\n    display({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: geojson.properties,\n      geometry: {\n        coordinates: lineCoordinates,\n        type: Constants.geojsonTypes.LINE_STRING\n      }\n    });\n    if (coordinateCount === 3) {\n      return;\n    }\n  }\n  // render the Polygon\n  return display(geojson);\n};\n\nDrawPolygon.onTrash = function(state) {\n  this.deleteFeature([state.polygon.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nexport default DrawPolygon;\n","import * as CommonSelectors from '../lib/common_selectors.js';\nimport isEventAtCoordinates from '../lib/is_event_at_coordinates.js';\nimport doubleClickZoom from '../lib/double_click_zoom.js';\nimport * as Constants from '../constants.js';\nimport createVertex from '../lib/create_vertex.js';\n\nconst DrawLineString = {};\n\nDrawLineString.onSetup = function(opts) {\n  opts = opts || {};\n  const featureId = opts.featureId;\n\n  let line, currentVertexPosition;\n  let direction = 'forward';\n  if (featureId) {\n    line = this.getFeature(featureId);\n    if (!line) {\n      throw new Error('Could not find a feature with the provided featureId');\n    }\n    let from = opts.from;\n    if (from && from.type === 'Feature' && from.geometry && from.geometry.type === 'Point') {\n      from = from.geometry;\n    }\n    if (from && from.type === 'Point' && from.coordinates && from.coordinates.length === 2) {\n      from = from.coordinates;\n    }\n    if (!from || !Array.isArray(from)) {\n      throw new Error('Please use the `from` property to indicate which point to continue the line from');\n    }\n    const lastCoord = line.coordinates.length - 1;\n    if (line.coordinates[lastCoord][0] === from[0] && line.coordinates[lastCoord][1] === from[1]) {\n      currentVertexPosition = lastCoord + 1;\n      // add one new coordinate to continue from\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[lastCoord]);\n    } else if (line.coordinates[0][0] === from[0] && line.coordinates[0][1] === from[1]) {\n      direction = 'backwards';\n      currentVertexPosition = 0;\n      // add one new coordinate to continue from\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[0]);\n    } else {\n      throw new Error('`from` should match the point at either the start or the end of the provided LineString');\n    }\n  } else {\n    line = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: {},\n      geometry: {\n        type: Constants.geojsonTypes.LINE_STRING,\n        coordinates: []\n      }\n    });\n    currentVertexPosition = 0;\n    this.addFeature(line);\n  }\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.LINE);\n  this.setActionableState({\n    trash: true\n  });\n\n  return {\n    line,\n    currentVertexPosition,\n    direction\n  };\n};\n\nDrawLineString.clickAnywhere = function(state, e) {\n  if (state.currentVertexPosition > 0 && isEventAtCoordinates(e, state.line.coordinates[state.currentVertexPosition - 1]) ||\n      state.direction === 'backwards' && isEventAtCoordinates(e, state.line.coordinates[state.currentVertexPosition + 1])) {\n    return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  if (state.direction === 'forward') {\n    state.currentVertexPosition++;\n    state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  } else {\n    state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n  }\n};\n\nDrawLineString.clickOnVertex = function(state) {\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n};\n\nDrawLineString.onMouseMove = function(state, e) {\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nDrawLineString.onTap = DrawLineString.onClick = function(state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  this.clickAnywhere(state, e);\n};\n\nDrawLineString.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n  } else if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.line.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT);\n  }\n};\n\nDrawLineString.onStop = function(state) {\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.line.id) === undefined) return;\n\n  //remove last added coordinate\n  state.line.removeCoordinate(`${state.currentVertexPosition}`);\n  if (state.line.isValid()) {\n    this.fire(Constants.events.CREATE, {\n      features: [state.line.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.line.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {}, { silent: true });\n  }\n};\n\nDrawLineString.onTrash = function(state) {\n  this.deleteFeature([state.line.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDrawLineString.toDisplayFeatures = function(state, geojson, display) {\n  const isActiveLine = geojson.properties.id === state.line.id;\n  geojson.properties.active = (isActiveLine) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActiveLine) return display(geojson);\n  // Only render the line if it has at least one real coordinate\n  if (geojson.geometry.coordinates.length < 2) return;\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(createVertex(\n    state.line.id,\n    geojson.geometry.coordinates[state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1],\n    `${state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1}`,\n    false\n  ));\n\n  display(geojson);\n};\n\nexport default DrawLineString;\n","\nimport simple_select from './simple_select.js';\nimport direct_select from './direct_select.js';\nimport draw_point from './draw_point.js';\nimport draw_polygon from './draw_polygon.js';\nimport draw_line_string from './draw_line_string.js';\n\nexport default {\n  simple_select,\n  direct_select,\n  draw_point,\n  draw_polygon,\n  draw_line_string,\n};\n","import * as Constants from './constants.js';\n\nimport styles from './lib/theme.js';\nimport modes from './modes/index.js';\n\nconst defaultOptions = {\n  defaultMode: Constants.modes.SIMPLE_SELECT,\n  keybindings: true,\n  touchEnabled: true,\n  clickBuffer: 2,\n  touchBuffer: 25,\n  boxSelect: true,\n  displayControlsDefault: true,\n  styles,\n  modes,\n  controls: {},\n  userProperties: false,\n  suppressAPIEvents: true\n};\n\nconst showControls = {\n  point: true,\n  line_string: true,\n  polygon: true,\n  trash: true,\n  combine_features: true,\n  uncombine_features: true\n};\n\nconst hideControls = {\n  point: false,\n  line_string: false,\n  polygon: false,\n  trash: false,\n  combine_features: false,\n  uncombine_features: false\n};\n\nfunction addSources(styles, sourceBucket) {\n  return styles.map((style) => {\n    if (style.source) return style;\n    return Object.assign({}, style, {\n      id: `${style.id}.${sourceBucket}`,\n      source: (sourceBucket === 'hot') ? Constants.sources.HOT : Constants.sources.COLD\n    });\n  });\n}\n\nexport default function(options = {}) {\n  let withDefaults = Object.assign({}, options);\n\n  if (!options.controls) {\n    withDefaults.controls = {};\n  }\n\n  if (options.displayControlsDefault === false) {\n    withDefaults.controls = Object.assign({}, hideControls, options.controls);\n  } else {\n    withDefaults.controls = Object.assign({}, showControls, options.controls);\n  }\n\n  withDefaults = Object.assign({}, defaultOptions, withDefaults);\n\n  // Layers with a shared source should be adjacent for performance reasons\n  withDefaults.styles = addSources(withDefaults.styles, 'cold').concat(addSources(withDefaults.styles, 'hot'));\n\n  return withDefaults;\n}\n","export default function(a, b) {\n  if (a.length !== b.length) return false;\n  return JSON.stringify(a.map(id => id).sort()) === JSON.stringify(b.map(id => id).sort());\n}\n","import isEqual from 'fast-deep-equal';\nimport normalize from '@mapbox/geojson-normalize';\nimport {generateID} from './lib/id.js';\nimport featuresAt from './lib/features_at.js';\nimport stringSetsAreEqual from './lib/string_sets_are_equal.js';\nimport * as Constants from './constants.js';\nimport StringSet from './lib/string_set.js';\n\nimport Polygon from './feature_types/polygon.js';\nimport LineString from './feature_types/line_string.js';\nimport Point from './feature_types/point.js';\nimport MultiFeature from './feature_types/multi_feature.js';\n\nconst featureTypes = {\n  Polygon,\n  LineString,\n  Point,\n  MultiPolygon: MultiFeature,\n  MultiLineString: MultiFeature,\n  MultiPoint: MultiFeature\n};\n\nexport default function(ctx, api) {\n  api.modes = Constants.modes;\n\n  // API doesn't emit events by default\n  const silent = ctx.options.suppressAPIEvents !== undefined ? !!ctx.options.suppressAPIEvents : true;\n\n  api.getFeatureIdsAt = function(point) {\n    const features = featuresAt.click({ point }, null, ctx);\n    return features.map(feature => feature.properties.id);\n  };\n\n  api.getSelectedIds = function() {\n    return ctx.store.getSelectedIds();\n  };\n\n  api.getSelected = function() {\n    return {\n      type: Constants.geojsonTypes.FEATURE_COLLECTION,\n      features: ctx.store.getSelectedIds().map(id => ctx.store.get(id)).map(feature => feature.toGeoJSON())\n    };\n  };\n\n  api.getSelectedPoints = function() {\n    return {\n      type: Constants.geojsonTypes.FEATURE_COLLECTION,\n      features: ctx.store.getSelectedCoordinates().map(coordinate => ({\n        type: Constants.geojsonTypes.FEATURE,\n        properties: {},\n        geometry: {\n          type: Constants.geojsonTypes.POINT,\n          coordinates: coordinate.coordinates\n        }\n      }))\n    };\n  };\n\n  api.set = function(featureCollection) {\n    if (featureCollection.type === undefined || featureCollection.type !== Constants.geojsonTypes.FEATURE_COLLECTION || !Array.isArray(featureCollection.features)) {\n      throw new Error('Invalid FeatureCollection');\n    }\n    const renderBatch = ctx.store.createRenderBatch();\n    let toDelete = ctx.store.getAllIds().slice();\n    const newIds = api.add(featureCollection);\n    const newIdsLookup = new StringSet(newIds);\n\n    toDelete = toDelete.filter(id => !newIdsLookup.has(id));\n    if (toDelete.length) {\n      api.delete(toDelete);\n    }\n\n    renderBatch();\n    return newIds;\n  };\n\n  api.add = function(geojson) {\n    const featureCollection = JSON.parse(JSON.stringify(normalize(geojson)));\n\n    const ids = featureCollection.features.map((feature) => {\n      feature.id = feature.id || generateID();\n\n      if (feature.geometry === null) {\n        throw new Error('Invalid geometry: null');\n      }\n\n      if (ctx.store.get(feature.id) === undefined || ctx.store.get(feature.id).type !== feature.geometry.type) {\n        // If the feature has not yet been created ...\n        const Model = featureTypes[feature.geometry.type];\n        if (Model === undefined) {\n          throw new Error(`Invalid geometry type: ${feature.geometry.type}.`);\n        }\n        const internalFeature = new Model(ctx, feature);\n        ctx.store.add(internalFeature, { silent });\n      } else {\n        // If a feature of that id has already been created, and we are swapping it out ...\n        const internalFeature = ctx.store.get(feature.id);\n        const originalProperties = internalFeature.properties;\n        internalFeature.properties = feature.properties;\n        if (!isEqual(originalProperties, feature.properties)) {\n          ctx.store.featureChanged(internalFeature.id, { silent });\n        }\n        if (!isEqual(internalFeature.getCoordinates(), feature.geometry.coordinates)) {\n          internalFeature.incomingCoords(feature.geometry.coordinates);\n        }\n      }\n      return feature.id;\n    });\n\n    ctx.store.render();\n    return ids;\n  };\n\n\n  api.get = function(id) {\n    const feature = ctx.store.get(id);\n    if (feature) {\n      return feature.toGeoJSON();\n    }\n  };\n\n  api.getAll = function() {\n    return {\n      type: Constants.geojsonTypes.FEATURE_COLLECTION,\n      features: ctx.store.getAll().map(feature => feature.toGeoJSON())\n    };\n  };\n\n  api.delete = function(featureIds) {\n    ctx.store.delete(featureIds, { silent });\n    // If we were in direct select mode and our selected feature no longer exists\n    // (because it was deleted), we need to get out of that mode.\n    if (api.getMode() === Constants.modes.DIRECT_SELECT && !ctx.store.getSelectedIds().length) {\n      ctx.events.changeMode(Constants.modes.SIMPLE_SELECT, undefined, { silent });\n    } else {\n      ctx.store.render();\n    }\n\n    return api;\n  };\n\n  api.deleteAll = function() {\n    ctx.store.delete(ctx.store.getAllIds(), { silent });\n    // If we were in direct select mode, now our selected feature no longer exists,\n    // so escape that mode.\n    if (api.getMode() === Constants.modes.DIRECT_SELECT) {\n      ctx.events.changeMode(Constants.modes.SIMPLE_SELECT, undefined, { silent });\n    } else {\n      ctx.store.render();\n    }\n\n    return api;\n  };\n\n  api.changeMode = function(mode, modeOptions = {}) {\n    // Avoid changing modes just to re-select what's already selected\n    if (mode === Constants.modes.SIMPLE_SELECT && api.getMode() === Constants.modes.SIMPLE_SELECT) {\n      if (stringSetsAreEqual((modeOptions.featureIds || []), ctx.store.getSelectedIds())) return api;\n      // And if we are changing the selection within simple_select mode, just change the selection,\n      // instead of stopping and re-starting the mode\n      ctx.store.setSelected(modeOptions.featureIds, { silent });\n      ctx.store.render();\n      return api;\n    }\n\n    if (mode === Constants.modes.DIRECT_SELECT && api.getMode() === Constants.modes.DIRECT_SELECT &&\n      modeOptions.featureId === ctx.store.getSelectedIds()[0]) {\n      return api;\n    }\n\n    ctx.events.changeMode(mode, modeOptions, { silent });\n    return api;\n  };\n\n  api.getMode = function() {\n    return ctx.events.getMode();\n  };\n\n  api.trash = function() {\n    ctx.events.trash({ silent });\n    return api;\n  };\n\n  api.combineFeatures = function() {\n    ctx.events.combineFeatures({ silent });\n    return api;\n  };\n\n  api.uncombineFeatures = function() {\n    ctx.events.uncombineFeatures({ silent });\n    return api;\n  };\n\n  api.setFeatureProperty = function(featureId, property, value) {\n    ctx.store.setFeatureProperty(featureId, property, value, { silent });\n    return api;\n  };\n\n  return api;\n}\n","import runSetup from './src/setup.js';\nimport setupOptions from './src/options.js';\nimport setupAPI from './src/api.js';\nimport modes from './src/modes/index.js';\nimport * as Constants from './src/constants.js';\nimport * as lib from './src/lib/index.js';\n\nconst setupDraw = function(options, api) {\n  options = setupOptions(options);\n\n  const ctx = {\n    options\n  };\n\n  api = setupAPI(ctx, api);\n  ctx.api = api;\n\n  const setup = runSetup(ctx);\n\n  api.onAdd = setup.onAdd;\n  api.onRemove = setup.onRemove;\n  api.types = Constants.types;\n  api.options = options;\n\n  return api;\n};\n\nfunction MapboxDraw(options) {\n  setupDraw(options, this);\n}\n\nMapboxDraw.modes = modes;\nMapboxDraw.constants = Constants;\nMapboxDraw.lib = lib;\n\nexport default MapboxDraw;\n","// index.ts\nvar earthRadius = 63710088e-1;\nvar factors = {\n  centimeters: earthRadius * 100,\n  centimetres: earthRadius * 100,\n  degrees: 360 / (2 * Math.PI),\n  feet: earthRadius * 3.28084,\n  inches: earthRadius * 39.37,\n  kilometers: earthRadius / 1e3,\n  kilometres: earthRadius / 1e3,\n  meters: earthRadius,\n  metres: earthRadius,\n  miles: earthRadius / 1609.344,\n  millimeters: earthRadius * 1e3,\n  millimetres: earthRadius * 1e3,\n  nauticalmiles: earthRadius / 1852,\n  radians: 1,\n  yards: earthRadius * 1.0936\n};\nvar areaFactors = {\n  acres: 247105e-9,\n  centimeters: 1e4,\n  centimetres: 1e4,\n  feet: 10.763910417,\n  hectares: 1e-4,\n  inches: 1550.003100006,\n  kilometers: 1e-6,\n  kilometres: 1e-6,\n  meters: 1,\n  metres: 1,\n  miles: 386e-9,\n  nauticalmiles: 29155334959812285e-23,\n  millimeters: 1e6,\n  millimetres: 1e6,\n  yards: 1.195990046\n};\nfunction feature(geom, properties, options = {}) {\n  const feat = { type: \"Feature\" };\n  if (options.id === 0 || options.id) {\n    feat.id = options.id;\n  }\n  if (options.bbox) {\n    feat.bbox = options.bbox;\n  }\n  feat.properties = properties || {};\n  feat.geometry = geom;\n  return feat;\n}\nfunction geometry(type, coordinates, _options = {}) {\n  switch (type) {\n    case \"Point\":\n      return point(coordinates).geometry;\n    case \"LineString\":\n      return lineString(coordinates).geometry;\n    case \"Polygon\":\n      return polygon(coordinates).geometry;\n    case \"MultiPoint\":\n      return multiPoint(coordinates).geometry;\n    case \"MultiLineString\":\n      return multiLineString(coordinates).geometry;\n    case \"MultiPolygon\":\n      return multiPolygon(coordinates).geometry;\n    default:\n      throw new Error(type + \" is invalid\");\n  }\n}\nfunction point(coordinates, properties, options = {}) {\n  if (!coordinates) {\n    throw new Error(\"coordinates is required\");\n  }\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"coordinates must be an Array\");\n  }\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be at least 2 numbers long\");\n  }\n  if (!isNumber(coordinates[0]) || !isNumber(coordinates[1])) {\n    throw new Error(\"coordinates must contain numbers\");\n  }\n  const geom = {\n    type: \"Point\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction points(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return point(coords, properties);\n    }),\n    options\n  );\n}\nfunction polygon(coordinates, properties, options = {}) {\n  for (const ring of coordinates) {\n    if (ring.length < 4) {\n      throw new Error(\n        \"Each LinearRing of a Polygon must have 4 or more Positions.\"\n      );\n    }\n    if (ring[ring.length - 1].length !== ring[0].length) {\n      throw new Error(\"First and last Position are not equivalent.\");\n    }\n    for (let j = 0; j < ring[ring.length - 1].length; j++) {\n      if (ring[ring.length - 1][j] !== ring[0][j]) {\n        throw new Error(\"First and last Position are not equivalent.\");\n      }\n    }\n  }\n  const geom = {\n    type: \"Polygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction polygons(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return polygon(coords, properties);\n    }),\n    options\n  );\n}\nfunction lineString(coordinates, properties, options = {}) {\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be an array of two or more positions\");\n  }\n  const geom = {\n    type: \"LineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction lineStrings(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return lineString(coords, properties);\n    }),\n    options\n  );\n}\nfunction featureCollection(features, options = {}) {\n  const fc = { type: \"FeatureCollection\" };\n  if (options.id) {\n    fc.id = options.id;\n  }\n  if (options.bbox) {\n    fc.bbox = options.bbox;\n  }\n  fc.features = features;\n  return fc;\n}\nfunction multiLineString(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiLineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPoint(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPoint\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPolygon(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPolygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction geometryCollection(geometries, properties, options = {}) {\n  const geom = {\n    type: \"GeometryCollection\",\n    geometries\n  };\n  return feature(geom, properties, options);\n}\nfunction round(num, precision = 0) {\n  if (precision && !(precision >= 0)) {\n    throw new Error(\"precision must be a positive number\");\n  }\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.round(num * multiplier) / multiplier;\n}\nfunction radiansToLength(radians, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return radians * factor;\n}\nfunction lengthToRadians(distance, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return distance / factor;\n}\nfunction lengthToDegrees(distance, units) {\n  return radiansToDegrees(lengthToRadians(distance, units));\n}\nfunction bearingToAzimuth(bearing) {\n  let angle = bearing % 360;\n  if (angle < 0) {\n    angle += 360;\n  }\n  return angle;\n}\nfunction azimuthToBearing(angle) {\n  angle = angle % 360;\n  if (angle > 180) {\n    return angle - 360;\n  } else if (angle < -180) {\n    return angle + 360;\n  }\n  return angle;\n}\nfunction radiansToDegrees(radians) {\n  const normalisedRadians = radians % (2 * Math.PI);\n  return normalisedRadians * 180 / Math.PI;\n}\nfunction degreesToRadians(degrees) {\n  const normalisedDegrees = degrees % 360;\n  return normalisedDegrees * Math.PI / 180;\n}\nfunction convertLength(length, originalUnit = \"kilometers\", finalUnit = \"kilometers\") {\n  if (!(length >= 0)) {\n    throw new Error(\"length must be a positive number\");\n  }\n  return radiansToLength(lengthToRadians(length, originalUnit), finalUnit);\n}\nfunction convertArea(area, originalUnit = \"meters\", finalUnit = \"kilometers\") {\n  if (!(area >= 0)) {\n    throw new Error(\"area must be a positive number\");\n  }\n  const startFactor = areaFactors[originalUnit];\n  if (!startFactor) {\n    throw new Error(\"invalid original units\");\n  }\n  const finalFactor = areaFactors[finalUnit];\n  if (!finalFactor) {\n    throw new Error(\"invalid final units\");\n  }\n  return area / startFactor * finalFactor;\n}\nfunction isNumber(num) {\n  return !isNaN(num) && num !== null && !Array.isArray(num);\n}\nfunction isObject(input) {\n  return input !== null && typeof input === \"object\" && !Array.isArray(input);\n}\nfunction validateBBox(bbox) {\n  if (!bbox) {\n    throw new Error(\"bbox is required\");\n  }\n  if (!Array.isArray(bbox)) {\n    throw new Error(\"bbox must be an Array\");\n  }\n  if (bbox.length !== 4 && bbox.length !== 6) {\n    throw new Error(\"bbox must be an Array of 4 or 6 numbers\");\n  }\n  bbox.forEach((num) => {\n    if (!isNumber(num)) {\n      throw new Error(\"bbox must only contain numbers\");\n    }\n  });\n}\nfunction validateId(id) {\n  if (!id) {\n    throw new Error(\"id is required\");\n  }\n  if ([\"string\", \"number\"].indexOf(typeof id) === -1) {\n    throw new Error(\"id must be a number or a string\");\n  }\n}\nexport {\n  areaFactors,\n  azimuthToBearing,\n  bearingToAzimuth,\n  convertArea,\n  convertLength,\n  degreesToRadians,\n  earthRadius,\n  factors,\n  feature,\n  featureCollection,\n  geometry,\n  geometryCollection,\n  isNumber,\n  isObject,\n  lengthToDegrees,\n  lengthToRadians,\n  lineString,\n  lineStrings,\n  multiLineString,\n  multiPoint,\n  multiPolygon,\n  point,\n  points,\n  polygon,\n  polygons,\n  radiansToDegrees,\n  radiansToLength,\n  round,\n  validateBBox,\n  validateId\n};\n//# sourceMappingURL=index.js.map","// index.js\nimport { feature, point, lineString, isObject } from \"@turf/helpers\";\nfunction coordEach(geojson, callback, excludeWrapCoord) {\n  if (geojson === null) return;\n  var j, k, l, geometry, stopG, coords, geometryMaybeCollection, wrapShrink = 0, coordIndex = 0, isGeometryCollection, type = geojson.type, isFeatureCollection = type === \"FeatureCollection\", isFeature = type === \"Feature\", stop = isFeatureCollection ? geojson.features.length : 1;\n  for (var featureIndex = 0; featureIndex < stop; featureIndex++) {\n    geometryMaybeCollection = isFeatureCollection ? geojson.features[featureIndex].geometry : isFeature ? geojson.geometry : geojson;\n    isGeometryCollection = geometryMaybeCollection ? geometryMaybeCollection.type === \"GeometryCollection\" : false;\n    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;\n    for (var geomIndex = 0; geomIndex < stopG; geomIndex++) {\n      var multiFeatureIndex = 0;\n      var geometryIndex = 0;\n      geometry = isGeometryCollection ? geometryMaybeCollection.geometries[geomIndex] : geometryMaybeCollection;\n      if (geometry === null) continue;\n      coords = geometry.coordinates;\n      var geomType = geometry.type;\n      wrapShrink = excludeWrapCoord && (geomType === \"Polygon\" || geomType === \"MultiPolygon\") ? 1 : 0;\n      switch (geomType) {\n        case null:\n          break;\n        case \"Point\":\n          if (callback(\n            coords,\n            coordIndex,\n            featureIndex,\n            multiFeatureIndex,\n            geometryIndex\n          ) === false)\n            return false;\n          coordIndex++;\n          multiFeatureIndex++;\n          break;\n        case \"LineString\":\n        case \"MultiPoint\":\n          for (j = 0; j < coords.length; j++) {\n            if (callback(\n              coords[j],\n              coordIndex,\n              featureIndex,\n              multiFeatureIndex,\n              geometryIndex\n            ) === false)\n              return false;\n            coordIndex++;\n            if (geomType === \"MultiPoint\") multiFeatureIndex++;\n          }\n          if (geomType === \"LineString\") multiFeatureIndex++;\n          break;\n        case \"Polygon\":\n        case \"MultiLineString\":\n          for (j = 0; j < coords.length; j++) {\n            for (k = 0; k < coords[j].length - wrapShrink; k++) {\n              if (callback(\n                coords[j][k],\n                coordIndex,\n                featureIndex,\n                multiFeatureIndex,\n                geometryIndex\n              ) === false)\n                return false;\n              coordIndex++;\n            }\n            if (geomType === \"MultiLineString\") multiFeatureIndex++;\n            if (geomType === \"Polygon\") geometryIndex++;\n          }\n          if (geomType === \"Polygon\") multiFeatureIndex++;\n          break;\n        case \"MultiPolygon\":\n          for (j = 0; j < coords.length; j++) {\n            geometryIndex = 0;\n            for (k = 0; k < coords[j].length; k++) {\n              for (l = 0; l < coords[j][k].length - wrapShrink; l++) {\n                if (callback(\n                  coords[j][k][l],\n                  coordIndex,\n                  featureIndex,\n                  multiFeatureIndex,\n                  geometryIndex\n                ) === false)\n                  return false;\n                coordIndex++;\n              }\n              geometryIndex++;\n            }\n            multiFeatureIndex++;\n          }\n          break;\n        case \"GeometryCollection\":\n          for (j = 0; j < geometry.geometries.length; j++)\n            if (coordEach(geometry.geometries[j], callback, excludeWrapCoord) === false)\n              return false;\n          break;\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n  }\n}\nfunction coordReduce(geojson, callback, initialValue, excludeWrapCoord) {\n  var previousValue = initialValue;\n  coordEach(\n    geojson,\n    function(currentCoord, coordIndex, featureIndex, multiFeatureIndex, geometryIndex) {\n      if (coordIndex === 0 && initialValue === void 0)\n        previousValue = currentCoord;\n      else\n        previousValue = callback(\n          previousValue,\n          currentCoord,\n          coordIndex,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    },\n    excludeWrapCoord\n  );\n  return previousValue;\n}\nfunction propEach(geojson, callback) {\n  var i;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      for (i = 0; i < geojson.features.length; i++) {\n        if (callback(geojson.features[i].properties, i) === false) break;\n      }\n      break;\n    case \"Feature\":\n      callback(geojson.properties, 0);\n      break;\n  }\n}\nfunction propReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  propEach(geojson, function(currentProperties, featureIndex) {\n    if (featureIndex === 0 && initialValue === void 0)\n      previousValue = currentProperties;\n    else\n      previousValue = callback(previousValue, currentProperties, featureIndex);\n  });\n  return previousValue;\n}\nfunction featureEach(geojson, callback) {\n  if (geojson.type === \"Feature\") {\n    callback(geojson, 0);\n  } else if (geojson.type === \"FeatureCollection\") {\n    for (var i = 0; i < geojson.features.length; i++) {\n      if (callback(geojson.features[i], i) === false) break;\n    }\n  }\n}\nfunction featureReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  featureEach(geojson, function(currentFeature, featureIndex) {\n    if (featureIndex === 0 && initialValue === void 0)\n      previousValue = currentFeature;\n    else previousValue = callback(previousValue, currentFeature, featureIndex);\n  });\n  return previousValue;\n}\nfunction coordAll(geojson) {\n  var coords = [];\n  coordEach(geojson, function(coord) {\n    coords.push(coord);\n  });\n  return coords;\n}\nfunction geomEach(geojson, callback) {\n  var i, j, g, geometry, stopG, geometryMaybeCollection, isGeometryCollection, featureProperties, featureBBox, featureId, featureIndex = 0, isFeatureCollection = geojson.type === \"FeatureCollection\", isFeature = geojson.type === \"Feature\", stop = isFeatureCollection ? geojson.features.length : 1;\n  for (i = 0; i < stop; i++) {\n    geometryMaybeCollection = isFeatureCollection ? geojson.features[i].geometry : isFeature ? geojson.geometry : geojson;\n    featureProperties = isFeatureCollection ? geojson.features[i].properties : isFeature ? geojson.properties : {};\n    featureBBox = isFeatureCollection ? geojson.features[i].bbox : isFeature ? geojson.bbox : void 0;\n    featureId = isFeatureCollection ? geojson.features[i].id : isFeature ? geojson.id : void 0;\n    isGeometryCollection = geometryMaybeCollection ? geometryMaybeCollection.type === \"GeometryCollection\" : false;\n    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;\n    for (g = 0; g < stopG; g++) {\n      geometry = isGeometryCollection ? geometryMaybeCollection.geometries[g] : geometryMaybeCollection;\n      if (geometry === null) {\n        if (callback(\n          null,\n          featureIndex,\n          featureProperties,\n          featureBBox,\n          featureId\n        ) === false)\n          return false;\n        continue;\n      }\n      switch (geometry.type) {\n        case \"Point\":\n        case \"LineString\":\n        case \"MultiPoint\":\n        case \"Polygon\":\n        case \"MultiLineString\":\n        case \"MultiPolygon\": {\n          if (callback(\n            geometry,\n            featureIndex,\n            featureProperties,\n            featureBBox,\n            featureId\n          ) === false)\n            return false;\n          break;\n        }\n        case \"GeometryCollection\": {\n          for (j = 0; j < geometry.geometries.length; j++) {\n            if (callback(\n              geometry.geometries[j],\n              featureIndex,\n              featureProperties,\n              featureBBox,\n              featureId\n            ) === false)\n              return false;\n          }\n          break;\n        }\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n    featureIndex++;\n  }\n}\nfunction geomReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  geomEach(\n    geojson,\n    function(currentGeometry, featureIndex, featureProperties, featureBBox, featureId) {\n      if (featureIndex === 0 && initialValue === void 0)\n        previousValue = currentGeometry;\n      else\n        previousValue = callback(\n          previousValue,\n          currentGeometry,\n          featureIndex,\n          featureProperties,\n          featureBBox,\n          featureId\n        );\n    }\n  );\n  return previousValue;\n}\nfunction flattenEach(geojson, callback) {\n  geomEach(geojson, function(geometry, featureIndex, properties, bbox, id) {\n    var type = geometry === null ? null : geometry.type;\n    switch (type) {\n      case null:\n      case \"Point\":\n      case \"LineString\":\n      case \"Polygon\":\n        if (callback(\n          feature(geometry, properties, { bbox, id }),\n          featureIndex,\n          0\n        ) === false)\n          return false;\n        return;\n    }\n    var geomType;\n    switch (type) {\n      case \"MultiPoint\":\n        geomType = \"Point\";\n        break;\n      case \"MultiLineString\":\n        geomType = \"LineString\";\n        break;\n      case \"MultiPolygon\":\n        geomType = \"Polygon\";\n        break;\n    }\n    for (var multiFeatureIndex = 0; multiFeatureIndex < geometry.coordinates.length; multiFeatureIndex++) {\n      var coordinate = geometry.coordinates[multiFeatureIndex];\n      var geom = {\n        type: geomType,\n        coordinates: coordinate\n      };\n      if (callback(feature(geom, properties), featureIndex, multiFeatureIndex) === false)\n        return false;\n    }\n  });\n}\nfunction flattenReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  flattenEach(\n    geojson,\n    function(currentFeature, featureIndex, multiFeatureIndex) {\n      if (featureIndex === 0 && multiFeatureIndex === 0 && initialValue === void 0)\n        previousValue = currentFeature;\n      else\n        previousValue = callback(\n          previousValue,\n          currentFeature,\n          featureIndex,\n          multiFeatureIndex\n        );\n    }\n  );\n  return previousValue;\n}\nfunction segmentEach(geojson, callback) {\n  flattenEach(geojson, function(feature2, featureIndex, multiFeatureIndex) {\n    var segmentIndex = 0;\n    if (!feature2.geometry) return;\n    var type = feature2.geometry.type;\n    if (type === \"Point\" || type === \"MultiPoint\") return;\n    var previousCoords;\n    var previousFeatureIndex = 0;\n    var previousMultiIndex = 0;\n    var prevGeomIndex = 0;\n    if (coordEach(\n      feature2,\n      function(currentCoord, coordIndex, featureIndexCoord, multiPartIndexCoord, geometryIndex) {\n        if (previousCoords === void 0 || featureIndex > previousFeatureIndex || multiPartIndexCoord > previousMultiIndex || geometryIndex > prevGeomIndex) {\n          previousCoords = currentCoord;\n          previousFeatureIndex = featureIndex;\n          previousMultiIndex = multiPartIndexCoord;\n          prevGeomIndex = geometryIndex;\n          segmentIndex = 0;\n          return;\n        }\n        var currentSegment = lineString(\n          [previousCoords, currentCoord],\n          feature2.properties\n        );\n        if (callback(\n          currentSegment,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex,\n          segmentIndex\n        ) === false)\n          return false;\n        segmentIndex++;\n        previousCoords = currentCoord;\n      }\n    ) === false)\n      return false;\n  });\n}\nfunction segmentReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  var started = false;\n  segmentEach(\n    geojson,\n    function(currentSegment, featureIndex, multiFeatureIndex, geometryIndex, segmentIndex) {\n      if (started === false && initialValue === void 0)\n        previousValue = currentSegment;\n      else\n        previousValue = callback(\n          previousValue,\n          currentSegment,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex,\n          segmentIndex\n        );\n      started = true;\n    }\n  );\n  return previousValue;\n}\nfunction lineEach(geojson, callback) {\n  if (!geojson) throw new Error(\"geojson is required\");\n  flattenEach(geojson, function(feature2, featureIndex, multiFeatureIndex) {\n    if (feature2.geometry === null) return;\n    var type = feature2.geometry.type;\n    var coords = feature2.geometry.coordinates;\n    switch (type) {\n      case \"LineString\":\n        if (callback(feature2, featureIndex, multiFeatureIndex, 0, 0) === false)\n          return false;\n        break;\n      case \"Polygon\":\n        for (var geometryIndex = 0; geometryIndex < coords.length; geometryIndex++) {\n          if (callback(\n            lineString(coords[geometryIndex], feature2.properties),\n            featureIndex,\n            multiFeatureIndex,\n            geometryIndex\n          ) === false)\n            return false;\n        }\n        break;\n    }\n  });\n}\nfunction lineReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  lineEach(\n    geojson,\n    function(currentLine, featureIndex, multiFeatureIndex, geometryIndex) {\n      if (featureIndex === 0 && initialValue === void 0)\n        previousValue = currentLine;\n      else\n        previousValue = callback(\n          previousValue,\n          currentLine,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    }\n  );\n  return previousValue;\n}\nfunction findSegment(geojson, options) {\n  options = options || {};\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var segmentIndex = options.segmentIndex || 0;\n  var properties = options.properties;\n  var geometry;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n  if (geometry === null) return null;\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n      if (segmentIndex < 0) segmentIndex = coords.length + segmentIndex - 1;\n      return lineString(\n        [coords[segmentIndex], coords[segmentIndex + 1]],\n        properties,\n        options\n      );\n    case \"Polygon\":\n      if (geometryIndex < 0) geometryIndex = coords.length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[geometryIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          coords[geometryIndex][segmentIndex],\n          coords[geometryIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[multiFeatureIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          coords[multiFeatureIndex][segmentIndex],\n          coords[multiFeatureIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[multiFeatureIndex][geometryIndex].length - segmentIndex - 1;\n      return lineString(\n        [\n          coords[multiFeatureIndex][geometryIndex][segmentIndex],\n          coords[multiFeatureIndex][geometryIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\nfunction findPoint(geojson, options) {\n  options = options || {};\n  if (!isObject(options)) throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var coordIndex = options.coordIndex || 0;\n  var properties = options.properties;\n  var geometry;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n  if (geometry === null) return null;\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\":\n      return point(coords, properties, options);\n    case \"MultiPoint\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      return point(coords[multiFeatureIndex], properties, options);\n    case \"LineString\":\n      if (coordIndex < 0) coordIndex = coords.length + coordIndex;\n      return point(coords[coordIndex], properties, options);\n    case \"Polygon\":\n      if (geometryIndex < 0) geometryIndex = coords.length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[geometryIndex].length + coordIndex;\n      return point(coords[geometryIndex][coordIndex], properties, options);\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[multiFeatureIndex].length + coordIndex;\n      return point(coords[multiFeatureIndex][coordIndex], properties, options);\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[multiFeatureIndex][geometryIndex].length - coordIndex;\n      return point(\n        coords[multiFeatureIndex][geometryIndex][coordIndex],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\nexport {\n  coordAll,\n  coordEach,\n  coordReduce,\n  featureEach,\n  featureReduce,\n  findPoint,\n  findSegment,\n  flattenEach,\n  flattenReduce,\n  geomEach,\n  geomReduce,\n  lineEach,\n  lineReduce,\n  propEach,\n  propReduce,\n  segmentEach,\n  segmentReduce\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { earthRadius } from \"@turf/helpers\";\nimport { geomReduce } from \"@turf/meta\";\nfunction area(geojson) {\n  return geomReduce(\n    geojson,\n    (value, geom) => {\n      return value + calculateArea(geom);\n    },\n    0\n  );\n}\nfunction calculateArea(geom) {\n  let total = 0;\n  let i;\n  switch (geom.type) {\n    case \"Polygon\":\n      return polygonArea(geom.coordinates);\n    case \"MultiPolygon\":\n      for (i = 0; i < geom.coordinates.length; i++) {\n        total += polygonArea(geom.coordinates[i]);\n      }\n      return total;\n    case \"Point\":\n    case \"MultiPoint\":\n    case \"LineString\":\n    case \"MultiLineString\":\n      return 0;\n  }\n  return 0;\n}\nfunction polygonArea(coords) {\n  let total = 0;\n  if (coords && coords.length > 0) {\n    total += Math.abs(ringArea(coords[0]));\n    for (let i = 1; i < coords.length; i++) {\n      total -= Math.abs(ringArea(coords[i]));\n    }\n  }\n  return total;\n}\nvar FACTOR = earthRadius * earthRadius / 2;\nvar PI_OVER_180 = Math.PI / 180;\nfunction ringArea(coords) {\n  const coordsLength = coords.length - 1;\n  if (coordsLength <= 2) return 0;\n  let total = 0;\n  let i = 0;\n  while (i < coordsLength) {\n    const lower = coords[i];\n    const middle = coords[i + 1 === coordsLength ? 0 : i + 1];\n    const upper = coords[i + 2 >= coordsLength ? (i + 2) % coordsLength : i + 2];\n    const lowerX = lower[0] * PI_OVER_180;\n    const middleY = middle[1] * PI_OVER_180;\n    const upperX = upper[0] * PI_OVER_180;\n    total += (upperX - lowerX) * Math.sin(middleY);\n    i++;\n  }\n  return total * FACTOR;\n}\nvar turf_area_default = area;\nexport {\n  area,\n  turf_area_default as default\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { point } from \"@turf/helpers\";\nimport { coordEach } from \"@turf/meta\";\nfunction centroid(geojson, options = {}) {\n  let xSum = 0;\n  let ySum = 0;\n  let len = 0;\n  coordEach(\n    geojson,\n    function(coord) {\n      xSum += coord[0];\n      ySum += coord[1];\n      len++;\n    },\n    true\n  );\n  return point([xSum / len, ySum / len], options.properties);\n}\nvar turf_centroid_default = centroid;\nexport {\n  centroid,\n  turf_centroid_default as default\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { isNumber } from \"@turf/helpers\";\nfunction getCoord(coord) {\n  if (!coord) {\n    throw new Error(\"coord is required\");\n  }\n  if (!Array.isArray(coord)) {\n    if (coord.type === \"Feature\" && coord.geometry !== null && coord.geometry.type === \"Point\") {\n      return [...coord.geometry.coordinates];\n    }\n    if (coord.type === \"Point\") {\n      return [...coord.coordinates];\n    }\n  }\n  if (Array.isArray(coord) && coord.length >= 2 && !Array.isArray(coord[0]) && !Array.isArray(coord[1])) {\n    return [...coord];\n  }\n  throw new Error(\"coord must be GeoJSON Point or an Array of numbers\");\n}\nfunction getCoords(coords) {\n  if (Array.isArray(coords)) {\n    return coords;\n  }\n  if (coords.type === \"Feature\") {\n    if (coords.geometry !== null) {\n      return coords.geometry.coordinates;\n    }\n  } else {\n    if (coords.coordinates) {\n      return coords.coordinates;\n    }\n  }\n  throw new Error(\n    \"coords must be GeoJSON Feature, Geometry Object or an Array\"\n  );\n}\nfunction containsNumber(coordinates) {\n  if (coordinates.length > 1 && isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n    return true;\n  }\n  if (Array.isArray(coordinates[0]) && coordinates[0].length) {\n    return containsNumber(coordinates[0]);\n  }\n  throw new Error(\"coordinates must only contain numbers\");\n}\nfunction geojsonType(value, type, name) {\n  if (!type || !name) {\n    throw new Error(\"type and name required\");\n  }\n  if (!value || value.type !== type) {\n    throw new Error(\n      \"Invalid input to \" + name + \": must be a \" + type + \", given \" + value.type\n    );\n  }\n}\nfunction featureOf(feature, type, name) {\n  if (!feature) {\n    throw new Error(\"No feature passed\");\n  }\n  if (!name) {\n    throw new Error(\".featureOf() requires a name\");\n  }\n  if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n    throw new Error(\n      \"Invalid input to \" + name + \", Feature with geometry required\"\n    );\n  }\n  if (!feature.geometry || feature.geometry.type !== type) {\n    throw new Error(\n      \"Invalid input to \" + name + \": must be a \" + type + \", given \" + feature.geometry.type\n    );\n  }\n}\nfunction collectionOf(featureCollection, type, name) {\n  if (!featureCollection) {\n    throw new Error(\"No featureCollection passed\");\n  }\n  if (!name) {\n    throw new Error(\".collectionOf() requires a name\");\n  }\n  if (!featureCollection || featureCollection.type !== \"FeatureCollection\") {\n    throw new Error(\n      \"Invalid input to \" + name + \", FeatureCollection required\"\n    );\n  }\n  for (const feature of featureCollection.features) {\n    if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n      throw new Error(\n        \"Invalid input to \" + name + \", Feature with geometry required\"\n      );\n    }\n    if (!feature.geometry || feature.geometry.type !== type) {\n      throw new Error(\n        \"Invalid input to \" + name + \": must be a \" + type + \", given \" + feature.geometry.type\n      );\n    }\n  }\n}\nfunction getGeom(geojson) {\n  if (geojson.type === \"Feature\") {\n    return geojson.geometry;\n  }\n  return geojson;\n}\nfunction getType(geojson, _name) {\n  if (geojson.type === \"FeatureCollection\") {\n    return \"FeatureCollection\";\n  }\n  if (geojson.type === \"GeometryCollection\") {\n    return \"GeometryCollection\";\n  }\n  if (geojson.type === \"Feature\" && geojson.geometry !== null) {\n    return geojson.geometry.type;\n  }\n  return geojson.type;\n}\nexport {\n  collectionOf,\n  containsNumber,\n  featureOf,\n  geojsonType,\n  getCoord,\n  getCoords,\n  getGeom,\n  getType\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { getCoord } from \"@turf/invariant\";\nimport { radiansToLength, degreesToRadians } from \"@turf/helpers\";\nfunction distance(from, to, options = {}) {\n  var coordinates1 = getCoord(from);\n  var coordinates2 = getCoord(to);\n  var dLat = degreesToRadians(coordinates2[1] - coordinates1[1]);\n  var dLon = degreesToRadians(coordinates2[0] - coordinates1[0]);\n  var lat1 = degreesToRadians(coordinates1[1]);\n  var lat2 = degreesToRadians(coordinates2[1]);\n  var a = Math.pow(Math.sin(dLat / 2), 2) + Math.pow(Math.sin(dLon / 2), 2) * Math.cos(lat1) * Math.cos(lat2);\n  return radiansToLength(\n    2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)),\n    options.units\n  );\n}\nvar turf_distance_default = distance;\nexport {\n  turf_distance_default as default,\n  distance\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { distance } from \"@turf/distance\";\nimport { segmentReduce } from \"@turf/meta\";\nfunction length(geojson, options = {}) {\n  return segmentReduce(\n    geojson,\n    (previousValue, segment) => {\n      const coords = segment.geometry.coordinates;\n      return previousValue + distance(coords[0], coords[1], options);\n    },\n    0\n  );\n}\nvar turf_length_default = length;\nexport {\n  turf_length_default as default,\n  length\n};\n//# sourceMappingURL=index.js.map","import MapboxDraw from \"@mapbox/mapbox-gl-draw\";\r\nimport * as turf from \"@turf/turf\";\r\n\r\nimport convert from 'convert-units';\r\n\r\nconst DRAW_LABELS_SOURCE_ID = \"source-draw-labels\";\r\nconst DRAW_LABELS_LAYER_ID = \"layer-draw-labels\";\r\nconst SOURCE_DATA = {\r\n    type: \"FeatureCollection\",\r\n    features: [],\r\n};\r\nexport default class MeasuresControl {\r\n    constructor(options) {\r\n        this.options = options;\r\n        this._drawCtrl = new MapboxDraw({\r\n            displayControlsDefault: false,\r\n            styles: [\r\n                // ACTIVE (being drawn)\r\n                // line stroke\r\n                {\r\n                    id: \"gl-draw-line\",\r\n                    type: \"line\",\r\n                    filter: [\r\n                        \"all\",\r\n                        [\"==\", \"$type\", \"LineString\"],\r\n                        [\"!=\", \"mode\", \"static\"],\r\n                    ],\r\n                    layout: {\r\n                        \"line-cap\": \"round\",\r\n                        \"line-join\": \"round\",\r\n                    },\r\n                    paint: {\r\n                        \"line-color\":\r\n                            this.options?.style?.lengthMeasurement?.lineColor ?? \"#D20C0C\",\r\n                        \"line-dasharray\": [0.2, 2],\r\n                        \"line-width\":\r\n                            this.options?.style?.lengthMeasurement?.lineWidth ?? 2,\r\n                    },\r\n                },\r\n                // polygon fill\r\n                {\r\n                    id: \"gl-draw-polygon-fill\",\r\n                    type: \"fill\",\r\n                    filter: [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\r\n                    paint: {\r\n                        \"fill-color\":\r\n                            this.options?.style?.areaMeasurement?.fillColor ?? \"#D20C0C\",\r\n                        \"fill-outline-color\":\r\n                            this.options?.style?.areaMeasurement?.fillOutlineColor ??\r\n                            \"#D20C0C\",\r\n                        \"fill-opacity\":\r\n                            this.options?.style?.areaMeasurement?.fillOpacity ?? 0.1,\r\n                    },\r\n                },\r\n                // polygon mid points\r\n                {\r\n                    id: \"gl-draw-polygon-midpoint\",\r\n                    type: \"circle\",\r\n                    filter: [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"meta\", \"midpoint\"]],\r\n                    paint: {\r\n                        \"circle-radius\": this.options?.style?.common?.midPointRadius ?? 3,\r\n                        \"circle-color\":\r\n                            this.options?.style?.common?.midPointColor ?? \"#fbb03b\",\r\n                    },\r\n                },\r\n                // polygon outline stroke\r\n                // This doesn't style the first edge of the polygon, which uses the line stroke styling instead\r\n                {\r\n                    id: \"gl-draw-polygon-stroke-active\",\r\n                    type: \"line\",\r\n                    filter: [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\r\n                    layout: {\r\n                        \"line-cap\": \"round\",\r\n                        \"line-join\": \"round\",\r\n                    },\r\n                    paint: {\r\n                        \"line-color\":\r\n                            this.options?.style?.areaMeasurement?.fillOutlineColor ??\r\n                            \"#D20C0C\",\r\n                        \"line-dasharray\": [0.2, 2],\r\n                        \"line-width\": this.options?.style?.areaMeasurement?.lineWidth ?? 2,\r\n                    },\r\n                },\r\n                // vertex point halos\r\n                {\r\n                    id: \"gl-draw-polygon-and-line-vertex-halo-active\",\r\n                    type: \"circle\",\r\n                    filter: [\r\n                        \"all\",\r\n                        [\"==\", \"meta\", \"vertex\"],\r\n                        [\"==\", \"$type\", \"Point\"],\r\n                        [\"!=\", \"mode\", \"static\"],\r\n                    ],\r\n                    paint: {\r\n                        \"circle-radius\":\r\n                            this.options?.style?.common?.midPointHaloRadius ?? 3,\r\n                        \"circle-color\":\r\n                            this.options?.style?.common?.midPointHaloColor ?? \"#FFF\",\r\n                    },\r\n                },\r\n                // vertex points\r\n                {\r\n                    id: \"gl-draw-polygon-and-line-vertex-active\",\r\n                    type: \"circle\",\r\n                    filter: [\r\n                        \"all\",\r\n                        [\"==\", \"meta\", \"vertex\"],\r\n                        [\"==\", \"$type\", \"Point\"],\r\n                        [\"!=\", \"mode\", \"static\"],\r\n                    ],\r\n                    paint: {\r\n                        \"circle-radius\": this.options?.style?.common?.midPointRadius ?? 3,\r\n                        \"circle-color\":\r\n                            this.options?.style?.common?.midPointColor ?? \"#fbb03b\",\r\n                    },\r\n                },\r\n\r\n                // INACTIVE (static, already drawn)\r\n                // line stroke\r\n                {\r\n                    id: \"gl-draw-line-static\",\r\n                    type: \"line\",\r\n                    filter: [\r\n                        \"all\",\r\n                        [\"==\", \"$type\", \"LineString\"],\r\n                        [\"==\", \"mode\", \"static\"],\r\n                    ],\r\n                    layout: {\r\n                        \"line-cap\": \"round\",\r\n                        \"line-join\": \"round\",\r\n                    },\r\n                    paint: {\r\n                        \"line-color\":\r\n                            this.options?.style?.lengthMeasurement?.lineColor ?? \"#D20C0C\",\r\n                        \"line-width\":\r\n                            this.options?.style?.lengthMeasurement?.lineWidth ?? 3,\r\n                    },\r\n                },\r\n                // polygon fill\r\n                {\r\n                    id: \"gl-draw-polygon-fill-static\",\r\n                    type: \"fill\",\r\n                    filter: [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"mode\", \"static\"]],\r\n                    paint: {\r\n                        \"fill-color\":\r\n                            this.options?.style?.areaMeasurement?.fillColor ?? \"#000\",\r\n                        \"fill-outline-color\":\r\n                            this.options?.style?.areaMeasurement?.fillOutlineColor ?? \"#000\",\r\n                        \"fill-opacity\":\r\n                            this.options?.style?.areaMeasurement?.fillOpacity ?? 0.1,\r\n                    },\r\n                },\r\n                // polygon outline\r\n                {\r\n                    id: \"gl-draw-polygon-stroke-static\",\r\n                    type: \"line\",\r\n                    filter: [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"mode\", \"static\"]],\r\n                    layout: {\r\n                        \"line-cap\": \"round\",\r\n                        \"line-join\": \"round\",\r\n                    },\r\n                    paint: {\r\n                        \"line-color\":\r\n                            this.options?.style?.areaMeasurement?.fillOutlineColor ?? \"#000\",\r\n                        \"line-width\": this.options?.style?.areaMeasurement?.lineWidth ?? 2,\r\n                    },\r\n                },\r\n            ],\r\n        });\r\n    }\r\n\r\n    onAdd(map) {\r\n        this._map = map;\r\n        this._map.addControl(this._drawCtrl, \"top-left\");\r\n        this._initControl();\r\n        this._registerEvents();\r\n        return this._container;\r\n    }\r\n\r\n    _initControl() {\r\n        this._container = document.createElement(\"div\");\r\n        this._container.className =\r\n            \"maplibregl-ctrl mapboxgl-ctrl maplibregl-measures maplibregl-ctrl-group mapboxgl-ctrl-group\";\r\n\r\n        this.initDrawBtn(this._drawCtrl.modes.DRAW_LINE_STRING);\r\n        this.initDrawBtn(this._drawCtrl.modes.DRAW_POLYGON);\r\n        this.initClearBtn();\r\n    }\r\n\r\n    _formatMeasure(dist, isAreaMeasurement = false) {\r\n        if (this.options?.units == \"imperial\") {\r\n            return isAreaMeasurement\r\n                ? this._formatAreaToImperialSystem(dist)\r\n                : this._formatToImperialSystem(dist);\r\n        } else {\r\n            return isAreaMeasurement\r\n                ? this._formatAreaToMetricSystem(dist)\r\n                : this._formatToMetricSystem(dist);\r\n        }\r\n    }\r\n\r\n    // area in sqm\r\n    _formatAreaToMetricSystem(dist) {\r\n        let measure = convert(dist).from(\"m2\").toBest({system: \"metric\"});\r\n        let unit = measure.unit.replaceAll(\"2\", \"²\");\r\n        let val = this._getLocaleNumber(measure.val);\r\n        return `${val} ${unit}`;\r\n    }\r\n\r\n    // area in sqm\r\n    _formatAreaToImperialSystem(dist) {\r\n        let measure = convert(dist).from(\"m2\").to(\"mi2\");\r\n        measure = convert(measure).from(\"mi2\").toBest({system: \"imperial\"});\r\n        let unit = measure.unit.replaceAll(\"2\", \"²\");\r\n        let val = this._getLocaleNumber(measure.val);\r\n        return `${val} ${unit}`;\r\n    }\r\n\r\n    _formatToMetricSystem(dist) {\r\n        let measure = convert(dist).from(\"m\").toBest({system: \"metric\"});\r\n        let val = this._getLocaleNumber(measure.val);\r\n        return `${val} ${measure.unit}`;\r\n    }\r\n\r\n    _formatToImperialSystem(dist) {\r\n        let measure = convert(dist).from(\"m\").to(\"mi\");\r\n        measure = convert(measure).from(\"mi\").toBest({system: \"imperial\"});\r\n        let val = this._getLocaleNumber(measure.val);\r\n        return `${val} ${measure.unit}`;\r\n    }\r\n\r\n    _getLocaleNumber(val) {\r\n        // Format without grouping separator\r\n        let formattedNumber = val.toLocaleString(undefined, {\r\n            minimumFractionDigits: 2,\r\n            maximumFractionDigits: 2,\r\n            useGrouping: this.options?.unitsGroupingSeparator ? false : true,\r\n        });\r\n\r\n        let groupingSeparator = this.options?.unitsGroupingSeparator;\r\n        if (groupingSeparator) {\r\n            // Insert spaces for grouping\r\n            formattedNumber = formattedNumber.replace(\r\n                /\\B(?=(\\d{3})+(?!\\d))/g,\r\n                groupingSeparator\r\n            );\r\n        }\r\n\r\n        return formattedNumber;\r\n    }\r\n\r\n    initDrawBtn(mode) {\r\n        let btn = document.createElement(\"button\");\r\n        btn.type = \"button\";\r\n        switch (mode) {\r\n            case this._drawCtrl.modes.DRAW_LINE_STRING:\r\n                btn.title = this.options?.lang?.lengthMeasurementButtonTitle ?? \"\";\r\n                btn.innerHTML = `<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\r\n                viewBox=\"0 0 512 512\" xml:space=\"preserve\" style=\"padding:4px\">\r\n               <path d=\"M503.467,0h-51.2c-4.71,0-8.533,3.814-8.533,8.533v51.2c0,4.719,3.823,8.533,8.533,8.533h16.077\r\n                   c-15.027,136.132-31.095,243.354-75.81,275.678V332.8c0-4.719-3.823-8.533-8.533-8.533h-51.2c-4.71,0-8.533,3.814-8.533,8.533\r\n                   v9.207c-24.226-20.591-47.59-60.45-70.298-99.26c-22.485-38.426-43.793-74.795-66.236-93.269V128c0-4.719-3.823-8.533-8.533-8.533\r\n                   H128c-4.71,0-8.533,3.814-8.533,8.533v20.326c-45.833,25.207-73.916,114.697-93.005,295.407H8.533\r\n                   c-4.71,0-8.533,3.814-8.533,8.533v51.2C0,508.186,3.823,512,8.533,512h51.2c4.71,0,8.533-3.814,8.533-8.533v-51.2\r\n                   c0-4.719-3.823-8.533-8.533-8.533H43.622c16.734-157.124,41.054-245.598,75.844-274.765V179.2c0,4.719,3.823,8.533,8.533,8.533\r\n                   h51.2c4.71,0,8.533-3.814,8.533-8.533v-5.973c16.614,18.56,33.664,47.667,51.499,78.14\r\n                   c26.539,45.363,53.948,92.117,85.035,111.829V384c0,4.719,3.823,8.533,8.533,8.533H384c4.71,0,8.533-3.814,8.533-8.533v-20.096\r\n                   c58.539-29.158,75.981-141.21,92.979-295.637h17.954c4.71,0,8.533-3.814,8.533-8.533v-51.2C512,3.814,508.177,0,503.467,0z\"/>\r\n           </svg>`;\r\n                break;\r\n            case this._drawCtrl.modes.DRAW_POLYGON:\r\n                btn.title = this.options?.lang?.areaMeasurementButtonTitle ?? \"\";\r\n                btn.innerHTML = `<svg viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path d=\"M18 38C18 40.2091 16.2091 42 14 42C11.7909 42 10 40.2091 10 38C10 35.7909 11.7909 34 14 34C16.2091 34 18 35.7909 18 38Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 40C15.1046 40 16 39.1046 16 38C16 36.8954 15.1046 36 14 36C12.8954 36 12 36.8954 12 38C12 39.1046 12.8954 40 14 40ZM14 42C16.2091 42 18 40.2091 18 38C18 35.7909 16.2091 34 14 34C11.7909 34 10 35.7909 10 38C10 40.2091 11.7909 42 14 42Z\" fill=\"#333333\"/>\r\n                <path d=\"M14 20C14 22.2091 12.2091 24 10 24C7.79086 24 6 22.2091 6 20C6 17.7909 7.79086 16 10 16C12.2091 16 14 17.7909 14 20Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10 22C11.1046 22 12 21.1046 12 20C12 18.8954 11.1046 18 10 18C8.89543 18 8 18.8954 8 20C8 21.1046 8.89543 22 10 22ZM10 24C12.2091 24 14 22.2091 14 20C14 17.7909 12.2091 16 10 16C7.79086 16 6 17.7909 6 20C6 22.2091 7.79086 24 10 24Z\" fill=\"#333333\"/>\r\n                <path d=\"M42 20C42 22.2091 40.2091 24 38 24C35.7909 24 34 22.2091 34 20C34 17.7909 35.7909 16 38 16C40.2091 16 42 17.7909 42 20Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M38 22C39.1046 22 40 21.1046 40 20C40 18.8954 39.1046 18 38 18C36.8954 18 36 18.8954 36 20C36 21.1046 36.8954 22 38 22ZM38 24C40.2091 24 42 22.2091 42 20C42 17.7909 40.2091 16 38 16C35.7909 16 34 17.7909 34 20C34 22.2091 35.7909 24 38 24Z\" fill=\"#333333\"/>\r\n                <path d=\"M38 38C38 40.2091 36.2091 42 34 42C31.7909 42 30 40.2091 30 38C30 35.7909 31.7909 34 34 34C36.2091 34 38 35.7909 38 38Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M34 40C35.1046 40 36 39.1046 36 38C36 36.8954 35.1046 36 34 36C32.8954 36 32 36.8954 32 38C32 39.1046 32.8954 40 34 40ZM34 42C36.2091 42 38 40.2091 38 38C38 35.7909 36.2091 34 34 34C31.7909 34 30 35.7909 30 38C30 40.2091 31.7909 42 34 42Z\" fill=\"#333333\"/>\r\n                <path d=\"M28 10C28 12.2091 26.2091 14 24 14C21.7909 14 20 12.2091 20 10C20 7.79086 21.7909 6 24 6C26.2091 6 28 7.79086 28 10Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M24 12C25.1046 12 26 11.1046 26 10C26 8.89543 25.1046 8 24 8C22.8954 8 22 8.89543 22 10C22 11.1046 22.8954 12 24 12ZM24 14C26.2091 14 28 12.2091 28 10C28 7.79086 26.2091 6 24 6C21.7909 6 20 7.79086 20 10C20 12.2091 21.7909 14 24 14Z\" fill=\"#333333\"/>\r\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M34.9188 19.028L25.9188 12.5994L27.0812 10.9719L36.0812 17.4005L34.9188 19.028ZM21.7844 12.8114L13.0812 19.028L11.9187 17.4005L20.6219 11.1839L21.7844 12.8114ZM11.6428 22.783L14.3095 34.783L12.3571 35.2169L9.69047 23.2169L11.6428 22.783ZM33.6905 34.783L36.246 23.283L38.1984 23.7169L35.6428 35.2169L33.6905 34.783ZM17 36.9999H31V38.9999H17V36.9999Z\" fill=\"#333333\"/>\r\n                </svg>\r\n                `;\r\n                break;\r\n        }\r\n        btn.addEventListener(\"click\", () => {\r\n            this._drawCtrl.changeMode(mode);\r\n        });\r\n        this._container.appendChild(btn);\r\n    }\r\n\r\n    initClearBtn() {\r\n        let btn = document.createElement(\"button\");\r\n        btn.type = \"button\";\r\n        btn.title = this.options?.lang?.clearMeasurementsButtonTitle ?? \"\";\r\n        btn.innerHTML = `<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\r\n                            viewBox=\"0 0 465.311 465.311\" style=\"enable-background:new 0 0 465.311 465.311;padding:5px\" xml:space=\"preserve\">\r\n                            <g>\r\n                                <path d=\"M372.811,51.002h-59.908V36.566C312.902,16.404,296.499,0,276.335,0h-87.356c-20.163,0-36.567,16.404-36.567,36.566v14.436\r\n                                    H92.5c-20.726,0-37.587,16.861-37.587,37.587v38.91c0,8.284,6.716,15,15,15h7.728v307.812c0,8.284,6.716,15,15,15H372.67\r\n                                    c8.284,0,15-6.716,15-15V142.499h7.728c8.284,0,15-6.716,15-15v-38.91C410.397,67.863,393.536,51.002,372.811,51.002z\r\n                                        M182.412,36.566c0-3.621,2.946-6.566,6.567-6.566h87.356c3.621,0,6.567,2.946,6.567,6.566v14.436h-100.49V36.566z M84.914,88.589\r\n                                    c0-4.184,3.403-7.587,7.587-7.587h280.31c4.184,0,7.587,3.403,7.587,7.587v23.91H84.914V88.589z M357.67,435.311H107.641V142.499\r\n                                    H357.67V435.311z\"/>\r\n                                <path d=\"M137.41,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\r\n                                    C127.41,409.008,131.887,413.485,137.41,413.485z\"/>\r\n                                <path d=\"M200.907,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\r\n                                    C190.907,409.008,195.384,413.485,200.907,413.485z\"/>\r\n                                <path d=\"M264.404,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\r\n                                    C254.404,409.008,258.881,413.485,264.404,413.485z\"/>\r\n                                <path d=\"M327.901,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\r\n                                    C317.901,409.008,322.378,413.485,327.901,413.485z\"/>\r\n                            </g>\r\n                            </svg>`;\r\n        btn.addEventListener(\"click\", () => {\r\n            this._drawCtrl.deleteAll();\r\n            this._updateLabels();\r\n        });\r\n        this._container.appendChild(btn);\r\n    }\r\n\r\n    _registerEvents() {\r\n        if (this._map) {\r\n            this._map.on(\"load\", () => {\r\n                this._recreateSourceAndLayers();\r\n            });\r\n            this._map.on(\"draw.create\", () => {\r\n                this._updateLabels();\r\n                this._handleOnCreate();\r\n            });\r\n            this._map.on(\"draw.update\", this._updateLabels.bind(this));\r\n            this._map.on(\"draw.delete\", this._updateLabels.bind(this));\r\n            this._map.on(\"draw.render\", () => {\r\n                this._updateLabels();\r\n                this._handleOnRender();\r\n            });\r\n        }\r\n    }\r\n\r\n    _recreateSourceAndLayers() {\r\n        if (!this._map.getSource(DRAW_LABELS_SOURCE_ID))\r\n            this._map.addSource(DRAW_LABELS_SOURCE_ID, {\r\n                type: \"geojson\",\r\n                data: SOURCE_DATA,\r\n            });\r\n        if (!this._map.getLayer(DRAW_LABELS_LAYER_ID))\r\n            this._map.addLayer({\r\n                id: DRAW_LABELS_LAYER_ID,\r\n                type: \"symbol\",\r\n                source: DRAW_LABELS_SOURCE_ID,\r\n                layout: {\r\n                    \"text-font\": [\r\n                        this.options?.style?.text?.font ?? \"Klokantech Noto Sans Bold\",\r\n                    ],\r\n                    \"text-field\": [\"get\", \"measurement\"],\r\n                    \"text-variable-anchor\": [\"top\", \"bottom\", \"left\", \"right\"],\r\n                    \"text-radial-offset\": this.options?.style?.text?.radialOffset ?? 0.5,\r\n                    \"text-justify\": \"auto\",\r\n                    \"text-letter-spacing\":\r\n                        this.options?.style?.text?.letterSpacing ?? 0.05,\r\n                    \"text-size\": [\r\n                        \"interpolate\",\r\n                        [\"linear\"],\r\n                        [\"zoom\"],\r\n                        5,\r\n                        10,\r\n                        10,\r\n                        12.0,\r\n                        13,\r\n                        14.0,\r\n                        14,\r\n                        16.0,\r\n                        18,\r\n                        18.0, // Change 15.0 to 10.0 or lower\r\n                    ],\r\n                },\r\n                paint: {\r\n                    \"text-color\": this.options?.style?.text?.color ?? \"#D20C0C\",\r\n                    \"text-halo-color\": this.options?.style?.text?.haloColor ?? \"#fff\",\r\n                    \"text-halo-width\": this.options?.style?.text?.haloWidth ?? 10,\r\n                },\r\n            });\r\n    }\r\n\r\n    _reorderLayers() {\r\n        if (this._map) {\r\n            let mapboxGlSources = Object.values(MapboxDraw.constants.sources);\r\n            this._map\r\n                .getStyle()\r\n                .layers.filter((l) => mapboxGlSources.includes(l.source))\r\n                .forEach((l) => {\r\n                    this._map.moveLayer(l.id);\r\n                });\r\n\r\n            // move to top\r\n            this._map.moveLayer(DRAW_LABELS_LAYER_ID);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles the optional onRender callback provided in the options\r\n     */\r\n    _handleOnRender() {\r\n        if (this.options && this.options.onRender !== null && this.options.onRender !== undefined && this.options.onRender instanceof Function) {\r\n            const features = this._getDrawnFeatures();\r\n            // Pass drawn features to callback\r\n            try {\r\n                this.options.onRender.call(this, features);\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Handles the optional onCreate callback provided in the options\r\n     */\r\n    _handleOnCreate() {\r\n        if (this.options && this.options.onCreate !== null && this.options.onCreate !== undefined && this.options.onCreate instanceof Function) {\r\n            const features = this._getDrawnFeatures();\r\n            // Pass drawn features to callback\r\n            try {\r\n                this.options.onCreate.call(this, features);\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n    }\r\n\r\n    _updateLabels() {\r\n        let source = this._map.getSource(DRAW_LABELS_SOURCE_ID);\r\n        if (!source && this._map) {\r\n            // in case of the source is somehow missing, recreate and empty one\r\n            this._recreateSourceAndLayers();\r\n            source = this._map.getSource(DRAW_LABELS_SOURCE_ID);\r\n        }\r\n\r\n        const data = this._getDrawnFeatures();\r\n        source.setData(data);\r\n        this._reorderLayers();\r\n    }\r\n\r\n    /**\r\n     * Retrieves features drawn on the map\r\n     * @returns {Object} A FeatureCollection of drawn features\r\n     */\r\n    _getDrawnFeatures() {\r\n        // Build up the centroids for each segment into a features list, containing a property\r\n        // to hold up the measurements\r\n        let features = [];\r\n        // Generate features from what we have on the drawControl:\r\n        let drawnFeatures = this._drawCtrl.getAll();\r\n        drawnFeatures.features.forEach((feature) => {\r\n            try {\r\n                if (feature.geometry.type == \"Polygon\") {\r\n                    let area = this._formatMeasure(turf.area(feature), true);\r\n                    let centroid = turf.centroid(feature);\r\n                    let measurement = `${area}`;\r\n                    centroid.properties = {\r\n                        measurement,\r\n                    };\r\n                    features.push(centroid);\r\n                } else if (feature.geometry.type == \"LineString\") {\r\n                    let segments = turf.lineSegment(feature);\r\n                    segments.features.forEach((segment) => {\r\n                        let centroid = turf.centroid(segment);\r\n                        let lineLength = this._formatMeasure(turf.length(segment) * 1000); //km to m\r\n                        let measurement = `${lineLength}`;\r\n                        centroid.properties = {\r\n                            measurement,\r\n                        };\r\n                        features.push(centroid);\r\n                    });\r\n                }\r\n            } catch (e) {\r\n                //Silently ignored\r\n            }\r\n        });\r\n        return {\r\n            type: \"FeatureCollection\",\r\n            features: features,\r\n        };\r\n    }\r\n\r\n    onRemove() {\r\n        this._container.parentNode.removeChild(this._container);\r\n        this._map.removeLayer(DRAW_LABELS_LAYER_ID);\r\n        this._map = undefined;\r\n    }\r\n}\r\n","// index.ts\nimport { featureCollection, lineString } from \"@turf/helpers\";\nimport { getCoords } from \"@turf/invariant\";\nimport { flattenEach } from \"@turf/meta\";\nfunction lineSegment(geojson) {\n  if (!geojson) {\n    throw new Error(\"geojson is required\");\n  }\n  const results = [];\n  flattenEach(geojson, (feature) => {\n    lineSegmentFeature(feature, results);\n  });\n  return featureCollection(results);\n}\nfunction lineSegmentFeature(geojson, results) {\n  let coords = [];\n  const geometry = geojson.geometry;\n  if (geometry !== null) {\n    switch (geometry.type) {\n      case \"Polygon\":\n        coords = getCoords(geometry);\n        break;\n      case \"LineString\":\n        coords = [getCoords(geometry)];\n    }\n    coords.forEach((coord) => {\n      const segments = createSegments(coord, geojson.properties);\n      segments.forEach((segment) => {\n        segment.id = results.length;\n        results.push(segment);\n      });\n    });\n  }\n}\nfunction createSegments(coords, properties) {\n  const segments = [];\n  coords.reduce((previousCoords, currentCoords) => {\n    const segment = lineString([previousCoords, currentCoords], properties);\n    segment.bbox = bbox(previousCoords, currentCoords);\n    segments.push(segment);\n    return currentCoords;\n  });\n  return segments;\n}\nfunction bbox(coords1, coords2) {\n  const x1 = coords1[0];\n  const y1 = coords1[1];\n  const x2 = coords2[0];\n  const y2 = coords2[1];\n  const west = x1 < x2 ? x1 : x2;\n  const south = y1 < y2 ? y1 : y2;\n  const east = x1 > x2 ? x1 : x2;\n  const north = y1 > y2 ? y1 : y2;\n  return [west, south, east, north];\n}\nvar turf_line_segment_default = lineSegment;\nexport {\n  turf_line_segment_default as default,\n  lineSegment\n};\n//# sourceMappingURL=index.js.map"],"names":["metric","imperial","name","singular","plural","to_anchor","module","exports","_anchors","unit","ratio","equal","a","b","constructor","length","i","keys","Array","isArray","RegExp","source","flags","valueOf","Object","prototype","toString","hasOwnProperty","call","key","objectTypes","object","index","iterable","result","push","createWrapper","slice","func","thisArg","arguments","current","A","mA","kA","energy","Wh","mWh","kWh","MWh","GWh","J","kJ","ppm","ppb","ppt","ppq","apparentPower","VA","mVA","kVA","MVA","GVA","value","reNative","String","replace","bits","bytes","Kb","Mb","Gb","Tb","B","KB","MB","GB","TB","gj","type","types","features","properties","geometry","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","Feature","FeatureCollection","power","W","mW","kW","MW","GW","frequency","mHz","Hz","kHz","MHz","GHz","THz","rpm","Math","PI","voltage","V","mV","kV","Pa","kPa","MPa","hPa","bar","torr","psi","ksi","mm","cm","m","km","yd","ft","mi","mm3","cm3","ml","cl","dl","l","kl","m3","km3","krm","tsk","msk","kkp","glas","kanna","tsp","Tbs","in3","cup","pnt","qt","gal","ft3","yd3","baseCreateCallback","collection","callback","ownIndex","ownProps","isObject","nativeCreate","test","create","baseCreate","g","ea","dz","reactivePower","VAR","mVAR","kVAR","MVAR","GVAR","angle","rad","deg","grad","arcmin","arcsec","knot","mcg","mg","kg","mt","oz","lb","t","baseBind","baseCreateWrapper","isFunction","bitmask","partialArgs","partialRightArgs","arity","isBind","isCurry","isPartial","isPartialRight","TypeError","bindData","__bindData__","apply","setBindData","bound","args","this","thisBinding","time","ns","mu","ms","s","min","h","d","week","month","year","shimKeys","nativeKeys","RADIUS","FLATTENING","POLAR_RADIUS","C","anchor_shift","K","F","R","transform","convert","Converter","each","measures","area","mass","volume","temperature","digital","partsPer","speed","pace","pressure","reactiveEnergy","volumeFlowRate","illuminance","numerator","denominator","val","from","destination","Error","origin","getUnit","throwUnsupportedUnitError","to","abbr","measure","system","toBest","options","best","assign","exclude","cutOffNumber","possibilities","possibility","describe","indexOf","bind","found","systems","units","testAbbr","resp","desc","err","list","testMeasure","concat","what","validUnits","join","isBindKey","isCurryBound","wgs84","polygonArea","coords","abs","ringArea","p1","p2","lowerIndex","middleIndex","upperIndex","coordsLength","sin","_","coordinates","geometries","ring","noop","descriptor","defineProperty","o","e","forOwn","support","funcDecomp","WinRTError","funcNames","Function","identity","reFuncName","reThis","fnToString","argCount","accumulator","VARh","mVARh","kVARh","MVARh","GVARh","array","start","end","mm2","cm2","m2","ha","km2","yd2","ft2","ac","mi2","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","definition","enumerable","get","globalThis","window","obj","prop","r","Symbol","toStringTag","mode","DrawContext","handlers","drag","click","mousemove","mousedown","mouseup","mouseout","keydown","keyup","touchstart","touchmove","touchend","tap","ctx","on","event","selector","fn","render","id","store","featureChanged","delegate","eventName","handles","iHandle","handle","ui","updateMapClasses","stop","trash","combineFeatures","uncombineFeatures","classes","CANVAS","CONTROL_BASE","CONTROL_PREFIX","CONTROL_BUTTON","CONTROL_BUTTON_LINE","CONTROL_BUTTON_POLYGON","CONTROL_BUTTON_POINT","CONTROL_BUTTON_TRASH","CONTROL_BUTTON_COMBINE_FEATURES","CONTROL_BUTTON_UNCOMBINE_FEATURES","CONTROL_GROUP","ATTRIBUTION","ACTIVE_BUTTON","BOX_SELECT","sources","HOT","COLD","cursors","ADD","MOVE","DRAG","POINTER","NONE","POLYGON","LINE","POINT","geojsonTypes","FEATURE","LINE_STRING","FEATURE_COLLECTION","MULTI_PREFIX","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","DRAW_LINE_STRING","DRAW_POLYGON","DRAW_POINT","SIMPLE_SELECT","DIRECT_SELECT","CREATE","DELETE","UPDATE","SELECTION_CHANGE","MODE_CHANGE","ACTIONABLE","RENDER","COMBINE_FEATURES","UNCOMBINE_FEATURES","updateActions","CHANGE_PROPERTIES","CHANGE_COORDINATES","meta","MIDPOINT","VERTEX","activeStates","ACTIVE","INACTIVE","interactions","LAT_MIN","LAT_RENDERED_MIN","LAT_MAX","LAT_RENDERED_MAX","LNG_MIN","LNG_MAX","FEATURE_SORT_RANKS","comparator","score","map","feature","property","sort","mapEvent","buffer","point","x","y","StringSet","items","_items","_nums","_length","add","has","delete","values","forEach","k","v","JSON","parse","clear","META_TYPES","bbox","featuresAt","clickBuffer","touch","touchBuffer","box","queryParams","styles","layers","filter","getLayer","queryRenderedFeatures","featureIds","uniqueFeatures","featureId","getFeatureAtAndSetCursors","mouse","active","events","currentModeName","queueMapClasses","sqrt","FINE_TOLERANCE","GROSS_TOLERANCE","INTERVAL","isClick","fineTolerance","grossTolerance","interval","moveDistance","TAP_TOLERANCE","TAP_INTERVAL","isTap","tolerance","alphabet","defaultSize","size","random","customAlphabet","generateID","geojson","changed","incomingCoords","setCoordinates","getCoordinates","stringify","setProperty","toGeoJSON","internal","userProperties","isValid","updateCoordinate","pathOrLng","lngOrLat","lat","getCoordinate","addCoordinate","path","lng","parseInt","splice","removeCoordinate","every","ids","split","parts","ringId","coordId","models","takeAction","action","idx","tail","MultiFeature","model","_coordinatesToFeatures","Model","f","getFeatures","ModeInterface","drawConfig","_ctx","setSelected","setSelectedCoordinates","reduce","c","feature_id","getSelected","getSelectedIds","isSelected","getFeature","select","deselect","deleteFeature","opts","addFeature","clearSelectedFeatures","clearSelected","clearSelectedCoordinates","setActionableState","actions","newSet","actionable","changeMode","eventOpts","fire","eventData","updateUIClasses","activateUIButton","setActiveButton","bufferType","newFeature","isInstanceOf","doRender","onSetup","onDrag","onClick","onMouseMove","onMouseDown","onMouseUp","onMouseOut","onKeyUp","onKeyDown","onTouchStart","onTouchMove","onTouchEnd","onTap","onStop","onTrash","onCombineFeature","onUncombineFeature","toDisplayFeatures","eventMapper","eventKeys","getSource","cleanup","newHotIds","newColdIds","isDirty","getAllIds","getChangedIds","hot","lastColdCount","cold","parent","coldChanged","renderFeature","featureInternal","currentModeRender","clearChangedIds","setData","Store","renderRequest","_features","_featureIds","_selectedFeatureIds","_selectedCoordinates","_changedFeatureIds","_emitSelectionChange","_mapInitialConfig","requestAnimationFrame","points","getSelectedCoordinates","coordinate","refreshSelectedCoordinates","newSelectedCoordinates","silent","createRenderBatch","holdRender","numRenders","setDirty","featureCreated","suppressAPIEvents","deletedFeaturesToEmit","getAll","coord_path","setFeatureProperty","storeMapConfig","interaction","isEnabled","restoreMapConfig","enable","disable","getInitialConfigValue","classTypes","controlContainer","mapLoadedInterval","setup","onRemove","off","connect","clearInterval","removeLayers","removeButtons","removeEventListeners","clearMapClasses","boxZoomInitial","boxZoom","container","parentNode","removeChild","addLayers","addEventListeners","onAdd","modes","modeObject","modeObjectKeys","startOpts","state","modeHandler","eh","onCombineFeatures","onUncombineFeatures","mouseDownInfo","touchStartInfo","currentMode","isDrag","Date","getTime","originalEvent","stopPropagation","mousedrag","endInfo","touchdrag","buttons","which","target","featureTarget","touchEnabled","preventDefault","isKeyModeValid","code","modename","nextModeOptions","eventOptions","modebuilder","srcElement","classList","contains","keyCode","controls","line_string","polygon","zoomend","changeZoom","data","dataType","some","style","actionState","defaultMode","addEventListener","keybindings","removeEventListener","getMode","buttonElements","activeButton","currentMapClasses","nextMapClasses","classesToRemove","classesToAdd","remove","createControlButton","button","document","createElement","className","setAttribute","title","appendChild","deactivateButtons","onDeactivate","onActivate","addButtons","controlGroup","combine_features","uncombine_features","buttonId","getContainer","boxSelect","dragPanIsEnabled","dragPan","loaded","setInterval","addSource","addLayer","removeLayer","removeSource","blue","orange","white","isOfMetaType","isShiftMousedown","shiftKey","isActiveFeature","isInactiveFeature","noTarget","isVertex","isShiftDown","isEscapeKey","isEnterKey","isTrue","clone","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","_mult","div","_div","rotate","_rotate","rotateAround","_rotateAround","matMult","_matMult","_unit","perp","_perp","round","_round","mag","equals","other","dist","distSqr","dx","dy","atan2","angleTo","angleWith","angleWithSep","cos","mouseEvent","rect","getBoundingClientRect","clientX","left","clientLeft","clientY","top","clientTop","parentId","selected","startVertex","endVertex","startCoord","endCoord","mid","createSupplementaryPoints","basePath","supplementaryPoints","processLine","line","lineBasePath","firstPointString","lastVertex","pointIndex","pointPath","vertex","isSelectedPath","midpoints","midpoint","stringifiedPoint","selectedPaths","lineIndex","subType","subCoordinates","subFeature","processMultiGeometry","setTimeout","doubleClickZoom","geojsonFeatures","delta","northInnerEdge","southInnerEdge","northOuterEdge","southOuterEdge","westEdge","eastEdge","bounds","depth","flat","lngs","coord","lats","vals","max","extent","featureSouthEdge","featureNorthEdge","featureWestEdge","featureEastEdge","constrainedDelta","ceil","currentCoordinates","moveCoordinate","moveRing","nextCoordinates","multi","SimpleSelect","dragMoveLocation","boxSelectStartLocation","boxSelectElement","boxSelecting","canBoxSelect","dragMoving","canDragMove","initialDragPanState","initiallySelectedFeatureIds","fireActionable","selectedFeatures","multiFeatures","featureType","allFeatures","memo","fireUpdate","stopExtendedInteractions","clickAnywhere","clickOnVertex","clickOnFeature","wasSelected","coordPath","startPos","lngLat","startOnActiveFeature","isShiftClick","selectedFeatureIds","isFeatureSelected","startBoxSelect","dragMove","whileBoxSelect","minX","maxX","minY","maxY","translateValue","WebkitTransform","width","height","featuresInBox","idsToSelect","getUniqueIds","display","featuresCombined","includes","subcoords","multiFeature","createdFeatures","deletedFeatures","featuresUncombined","isMidpoint","DirectSelect","selectedCoordPaths","startDragging","about","selectedIndex","selectedCoordinates","pathsToCoordinates","paths","stopDragging","selectedCoords","localeCompare","numeric","isFeature","onVertex","isMidPoint","noCoords","onFeature","onMidpoint","dragVertex","dragFeature","clickNoTarget","clickActiveFeature","clickInactive","DrawPoint","isActivePoint","stopDrawingAndRemove","DrawPolygon","currentVertexPosition","isActivePolygon","coordinateCount","endPos","lineCoordinates","DrawLineString","direction","lastCoord","isActiveLine","simple_select","direct_select","draw_point","draw_polygon","draw_line_string","defaultOptions","displayControlsDefault","showControls","hideControls","addSources","sourceBucket","featureTypes","MapboxDraw","api","withDefaults","getFeatureIdsAt","getSelectedPoints","set","featureCollection","renderBatch","toDelete","newIds","newIdsLookup","internalFeature","originalProperties","deleteAll","modeOptions","setupDraw","constants","lib","earthRadius","factors","centimeters","centimetres","degrees","feet","inches","kilometers","kilometres","meters","metres","miles","millimeters","millimetres","nauticalmiles","radians","yards","geom","feat","degreesToRadians","num","isNaN","coordEach","excludeWrapCoord","j","stopG","geometryMaybeCollection","isGeometryCollection","wrapShrink","coordIndex","isFeatureCollection","featureIndex","geomIndex","multiFeatureIndex","geometryIndex","geomType","geomEach","featureProperties","featureBBox","flattenEach","previousValue","currentGeometry","total","calculateArea","geomReduce","FACTOR","PI_OVER_180","lower","middle","upper","lowerX","middleY","xSum","ySum","len","getCoord","getCoords","distance","coordinates1","coordinates2","dLat","dLon","lat1","lat2","pow","factor","radiansToLength","initialValue","started","feature2","segmentIndex","previousCoords","previousFeatureIndex","previousMultiIndex","prevGeomIndex","currentCoord","featureIndexCoord","multiPartIndexCoord","currentSegment","segmentEach","segmentReduce","segment","DRAW_LABELS_SOURCE_ID","DRAW_LABELS_LAYER_ID","SOURCE_DATA","MeasuresControl","_drawCtrl","layout","paint","lengthMeasurement","lineColor","lineWidth","areaMeasurement","fillColor","fillOutlineColor","fillOpacity","common","midPointRadius","midPointColor","midPointHaloRadius","midPointHaloColor","_map","addControl","_initControl","_registerEvents","_container","initDrawBtn","initClearBtn","_formatMeasure","isAreaMeasurement","_formatAreaToImperialSystem","_formatToImperialSystem","_formatAreaToMetricSystem","_formatToMetricSystem","replaceAll","_getLocaleNumber","formattedNumber","toLocaleString","minimumFractionDigits","maximumFractionDigits","useGrouping","unitsGroupingSeparator","groupingSeparator","btn","lang","lengthMeasurementButtonTitle","innerHTML","areaMeasurementButtonTitle","clearMeasurementsButtonTitle","_updateLabels","_recreateSourceAndLayers","_handleOnCreate","_handleOnRender","text","font","radialOffset","letterSpacing","color","haloColor","haloWidth","_reorderLayers","mapboxGlSources","getStyle","moveLayer","onRender","_getDrawnFeatures","console","error","onCreate","centroid","measurement","results","segments","currentCoords","coords1","coords2","x1","y1","x2","y2","createSegments","lineSegmentFeature","fc"],"sourceRoot":""}