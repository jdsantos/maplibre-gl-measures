var maplibreGLMeasures;(()=>{var e={4:e=>{var t,r;t={"min/km":{name:{singular:"Minute per kilometre",plural:"Minutes per kilometre"},to_anchor:.06},"s/m":{name:{singular:"Second per metre",plural:"Seconds per metre"},to_anchor:1}},r={"min/mi":{name:{singular:"Minute per mile",plural:"Minutes per mile"},to_anchor:.0113636},"s/ft":{name:{singular:"Second per foot",plural:"Seconds per foot"},to_anchor:1}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"s/m",ratio:.3048},imperial:{unit:"s/ft",ratio:1/.3048}}}},17:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(o=n;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var a=i[o];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},30:(e,t,r)=>{var n=r(813),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t,r=e,i=[];if(!r)return i;if(!n[typeof e])return i;for(t in r)o.call(r,t)&&i.push(t);return i}},41:(e,t,r)=>{var n=r(514),o=(r(177),r(923));e.exports=function(e,t){return arguments.length>2?n(e,17,o(arguments,2),null,t):n(e,1,null,null,t)}},86:e=>{var t;t={A:{name:{singular:"Ampere",plural:"Amperes"},to_anchor:1},mA:{name:{singular:"Milliampere",plural:"Milliamperes"},to_anchor:.001},kA:{name:{singular:"Kiloampere",plural:"Kiloamperes"},to_anchor:1e3}},e.exports={metric:t,_anchors:{metric:{unit:"A",ratio:1}}}},99:e=>{var t;t={Wh:{name:{singular:"Watt-hour",plural:"Watt-hours"},to_anchor:3600},mWh:{name:{singular:"Milliwatt-hour",plural:"Milliwatt-hours"},to_anchor:3.6},kWh:{name:{singular:"Kilowatt-hour",plural:"Kilowatt-hours"},to_anchor:36e5},MWh:{name:{singular:"Megawatt-hour",plural:"Megawatt-hours"},to_anchor:36e8},GWh:{name:{singular:"Gigawatt-hour",plural:"Gigawatt-hours"},to_anchor:36e11},J:{name:{singular:"Joule",plural:"Joules"},to_anchor:1},kJ:{name:{singular:"Kilojoule",plural:"Kilojoules"},to_anchor:1e3}},e.exports={metric:t,_anchors:{metric:{unit:"J",ratio:1}}}},133:e=>{var t;t={ppm:{name:{singular:"Part-per Million",plural:"Parts-per Million"},to_anchor:1},ppb:{name:{singular:"Part-per Billion",plural:"Parts-per Billion"},to_anchor:.001},ppt:{name:{singular:"Part-per Trillion",plural:"Parts-per Trillion"},to_anchor:1e-6},ppq:{name:{singular:"Part-per Quadrillion",plural:"Parts-per Quadrillion"},to_anchor:1e-9}},e.exports={metric:t,imperial:{},_anchors:{metric:{unit:"ppm",ratio:1e-6}}}},157:e=>{var t;t={VA:{name:{singular:"Volt-Ampere",plural:"Volt-Amperes"},to_anchor:1},mVA:{name:{singular:"Millivolt-Ampere",plural:"Millivolt-Amperes"},to_anchor:.001},kVA:{name:{singular:"Kilovolt-Ampere",plural:"Kilovolt-Amperes"},to_anchor:1e3},MVA:{name:{singular:"Megavolt-Ampere",plural:"Megavolt-Amperes"},to_anchor:1e6},GVA:{name:{singular:"Gigavolt-Ampere",plural:"Gigavolt-Amperes"},to_anchor:1e9}},e.exports={metric:t,_anchors:{metric:{unit:"VA",ratio:1}}}},160:e=>{e.exports=function(e){return e}},170:e=>{var t,r;t={lx:{name:{singular:"Lux",plural:"Lux"},to_anchor:1}},r={"ft-cd":{name:{singular:"Foot-candle",plural:"Foot-candles"},to_anchor:1}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"lx",ratio:1/10.76391},imperial:{unit:"ft-cd",ratio:10.76391}}}},177:e=>{var t=Object.prototype.toString,r=RegExp("^"+String(t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");e.exports=r},183:e=>{var t,r;t={b:{name:{singular:"Bit",plural:"Bits"},to_anchor:1},Kb:{name:{singular:"Kilobit",plural:"Kilobits"},to_anchor:1024},Mb:{name:{singular:"Megabit",plural:"Megabits"},to_anchor:1048576},Gb:{name:{singular:"Gigabit",plural:"Gigabits"},to_anchor:1073741824},Tb:{name:{singular:"Terabit",plural:"Terabits"},to_anchor:1099511627776}},r={B:{name:{singular:"Byte",plural:"Bytes"},to_anchor:1},KB:{name:{singular:"Kilobyte",plural:"Kilobytes"},to_anchor:1024},MB:{name:{singular:"Megabyte",plural:"Megabytes"},to_anchor:1048576},GB:{name:{singular:"Gigabyte",plural:"Gigabytes"},to_anchor:1073741824},TB:{name:{singular:"Terabyte",plural:"Terabytes"},to_anchor:1099511627776}},e.exports={bits:t,bytes:r,_anchors:{bits:{unit:"b",ratio:1/8},bytes:{unit:"B",ratio:8}}}},186:e=>{e.exports=function(e){if(!e||!e.type)return null;var r=t[e.type];return r?"geometry"===r?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]}:"feature"===r?{type:"FeatureCollection",features:[e]}:"featurecollection"===r?e:void 0:null};var t={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},237:e=>{var t;t={W:{name:{singular:"Watt",plural:"Watts"},to_anchor:1},mW:{name:{singular:"Milliwatt",plural:"Milliwatts"},to_anchor:.001},kW:{name:{singular:"Kilowatt",plural:"Kilowatts"},to_anchor:1e3},MW:{name:{singular:"Megawatt",plural:"Megawatts"},to_anchor:1e6},GW:{name:{singular:"Gigawatt",plural:"Gigawatts"},to_anchor:1e9}},e.exports={metric:t,_anchors:{metric:{unit:"W",ratio:1}}}},241:e=>{var t;t={mHz:{name:{singular:"millihertz",plural:"millihertz"},to_anchor:.001},Hz:{name:{singular:"hertz",plural:"hertz"},to_anchor:1},kHz:{name:{singular:"kilohertz",plural:"kilohertz"},to_anchor:1e3},MHz:{name:{singular:"megahertz",plural:"megahertz"},to_anchor:1e6},GHz:{name:{singular:"gigahertz",plural:"gigahertz"},to_anchor:1e9},THz:{name:{singular:"terahertz",plural:"terahertz"},to_anchor:1e12},rpm:{name:{singular:"rotation per minute",plural:"rotations per minute"},to_anchor:1/60},"deg/s":{name:{singular:"degree per second",plural:"degrees per second"},to_anchor:1/360},"rad/s":{name:{singular:"radian per second",plural:"radians per second"},to_anchor:1/(2*Math.PI)}},e.exports={metric:t,_anchors:{frequency:{unit:"hz",ratio:1}}}},257:e=>{var t;t={V:{name:{singular:"Volt",plural:"Volts"},to_anchor:1},mV:{name:{singular:"Millivolt",plural:"Millivolts"},to_anchor:.001},kV:{name:{singular:"Kilovolt",plural:"Kilovolts"},to_anchor:1e3}},e.exports={metric:t,_anchors:{metric:{unit:"V",ratio:1}}}},264:e=>{var t,r;t={Pa:{name:{singular:"pascal",plural:"pascals"},to_anchor:.001},kPa:{name:{singular:"kilopascal",plural:"kilopascals"},to_anchor:1},MPa:{name:{singular:"megapascal",plural:"megapascals"},to_anchor:1e3},hPa:{name:{singular:"hectopascal",plural:"hectopascals"},to_anchor:.1},bar:{name:{singular:"bar",plural:"bar"},to_anchor:100},torr:{name:{singular:"torr",plural:"torr"},to_anchor:101325/76e4}},r={psi:{name:{singular:"pound per square inch",plural:"pounds per square inch"},to_anchor:.001},ksi:{name:{singular:"kilopound per square inch",plural:"kilopound per square inch"},to_anchor:1}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"kPa",ratio:.00014503768078},imperial:{unit:"psi",ratio:6894.76000045014}}}},315:e=>{var t,r;t={mm:{name:{singular:"Millimeter",plural:"Millimeters"},to_anchor:.001},cm:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:.01},m:{name:{singular:"Meter",plural:"Meters"},to_anchor:1},km:{name:{singular:"Kilometer",plural:"Kilometers"},to_anchor:1e3}},r={in:{name:{singular:"Inch",plural:"Inches"},to_anchor:1/12},yd:{name:{singular:"Yard",plural:"Yards"},to_anchor:3},"ft-us":{name:{singular:"US Survey Foot",plural:"US Survey Feet"},to_anchor:1.000002},ft:{name:{singular:"Foot",plural:"Feet"},to_anchor:1},mi:{name:{singular:"Mile",plural:"Miles"},to_anchor:5280}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"m",ratio:3.28084},imperial:{unit:"ft",ratio:1/3.28084}}}},445:e=>{var t,r;t={mm3:{name:{singular:"Cubic Millimeter",plural:"Cubic Millimeters"},to_anchor:1e-6},cm3:{name:{singular:"Cubic Centimeter",plural:"Cubic Centimeters"},to_anchor:.001},ml:{name:{singular:"Millilitre",plural:"Millilitres"},to_anchor:.001},cl:{name:{singular:"Centilitre",plural:"Centilitres"},to_anchor:.01},dl:{name:{singular:"Decilitre",plural:"Decilitres"},to_anchor:.1},l:{name:{singular:"Litre",plural:"Litres"},to_anchor:1},kl:{name:{singular:"Kilolitre",plural:"Kilolitres"},to_anchor:1e3},m3:{name:{singular:"Cubic meter",plural:"Cubic meters"},to_anchor:1e3},km3:{name:{singular:"Cubic kilometer",plural:"Cubic kilometers"},to_anchor:1e12},krm:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:.001},tsk:{name:{singular:"Tesked",plural:"Teskedar"},to_anchor:.005},msk:{name:{singular:"Matsked",plural:"Matskedar"},to_anchor:.015},kkp:{name:{singular:"Kaffekopp",plural:"Kaffekoppar"},to_anchor:.15},glas:{name:{singular:"Glas",plural:"Glas"},to_anchor:.2},kanna:{name:{singular:"Kanna",plural:"Kannor"},to_anchor:2.617}},r={tsp:{name:{singular:"Teaspoon",plural:"Teaspoons"},to_anchor:1/6},Tbs:{name:{singular:"Tablespoon",plural:"Tablespoons"},to_anchor:.5},in3:{name:{singular:"Cubic inch",plural:"Cubic inches"},to_anchor:.55411},"fl-oz":{name:{singular:"Fluid Ounce",plural:"Fluid Ounces"},to_anchor:1},cup:{name:{singular:"Cup",plural:"Cups"},to_anchor:8},pnt:{name:{singular:"Pint",plural:"Pints"},to_anchor:16},qt:{name:{singular:"Quart",plural:"Quarts"},to_anchor:32},gal:{name:{singular:"Gallon",plural:"Gallons"},to_anchor:128},ft3:{name:{singular:"Cubic foot",plural:"Cubic feet"},to_anchor:957.506},yd3:{name:{singular:"Cubic yard",plural:"Cubic yards"},to_anchor:25852.7}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"l",ratio:33.8140226},imperial:{unit:"fl-oz",ratio:1/33.8140226}}}},447:(e,t,r)=>{var n=r(889),o=r(618),i=r(813);e.exports=function(e,t,r){var a,s=e,l=s;if(!s)return l;if(!i[typeof s])return l;t=t&&void 0===r?t:n(t,r,3);for(var c=-1,u=i[typeof s]&&o(s),p=u?u.length:0;++c<p;)if(!1===t(s[a=u[c]],a,e))return l;return l}},450:(e,t,r)=>{var n=r(669),o=(r(714),r(177).test(o=Object.create)&&o);function i(e,t){return n(e)?o(e):{}}o||(i=function(){function e(){}return function(t){if(n(t)){e.prototype=t;var o=new e;e.prototype=null}return o||r.g.Object()}}()),e.exports=i},466:e=>{var t;t={ea:{name:{singular:"Each",plural:"Each"},to_anchor:1},dz:{name:{singular:"Dozen",plural:"Dozens"},to_anchor:12}},e.exports={metric:t,imperial:{},_anchors:{metric:{unit:"ea",ratio:1}}}},467:e=>{var t;t={VAR:{name:{singular:"Volt-Ampere Reactive",plural:"Volt-Amperes Reactive"},to_anchor:1},mVAR:{name:{singular:"Millivolt-Ampere Reactive",plural:"Millivolt-Amperes Reactive"},to_anchor:.001},kVAR:{name:{singular:"Kilovolt-Ampere Reactive",plural:"Kilovolt-Amperes Reactive"},to_anchor:1e3},MVAR:{name:{singular:"Megavolt-Ampere Reactive",plural:"Megavolt-Amperes Reactive"},to_anchor:1e6},GVAR:{name:{singular:"Gigavolt-Ampere Reactive",plural:"Gigavolt-Amperes Reactive"},to_anchor:1e9}},e.exports={metric:t,_anchors:{metric:{unit:"VAR",ratio:1}}}},472:e=>{var t;t={rad:{name:{singular:"radian",plural:"radians"},to_anchor:180/Math.PI},deg:{name:{singular:"degree",plural:"degrees"},to_anchor:1},grad:{name:{singular:"gradian",plural:"gradians"},to_anchor:.9},arcmin:{name:{singular:"arcminute",plural:"arcminutes"},to_anchor:1/60},arcsec:{name:{singular:"arcsecond",plural:"arcseconds"},to_anchor:1/3600}},e.exports={metric:t,_anchors:{metric:{unit:"deg",ratio:1}}}},496:e=>{var t,r;t={"m/s":{name:{singular:"Metre per second",plural:"Metres per second"},to_anchor:3.6},"km/h":{name:{singular:"Kilometre per hour",plural:"Kilometres per hour"},to_anchor:1}},r={"m/h":{name:{singular:"Mile per hour",plural:"Miles per hour"},to_anchor:1},knot:{name:{singular:"Knot",plural:"Knots"},to_anchor:1.150779},"ft/s":{name:{singular:"Foot per second",plural:"Feet per second"},to_anchor:.681818}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"km/h",ratio:1/1.609344},imperial:{unit:"m/h",ratio:1.609344}}}},503:e=>{var t,r;t={mcg:{name:{singular:"Microgram",plural:"Micrograms"},to_anchor:1e-6},mg:{name:{singular:"Milligram",plural:"Milligrams"},to_anchor:.001},g:{name:{singular:"Gram",plural:"Grams"},to_anchor:1},kg:{name:{singular:"Kilogram",plural:"Kilograms"},to_anchor:1e3},mt:{name:{singular:"Metric Tonne",plural:"Metric Tonnes"},to_anchor:1e6}},r={oz:{name:{singular:"Ounce",plural:"Ounces"},to_anchor:1/16},lb:{name:{singular:"Pound",plural:"Pounds"},to_anchor:1},t:{name:{singular:"Ton",plural:"Tons"},to_anchor:2e3}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"g",ratio:1/453.592},imperial:{unit:"lb",ratio:453.592}}}},514:(e,t,r)=>{var n=r(521),o=r(737),i=r(710),a=[].push;e.exports=function e(t,r,s,l,c,u){var p=1&r,h=4&r,d=16&r,m=32&r;if(!(2&r||i(t)))throw new TypeError;d&&!s.length&&(r&=-17,d=s=!1),m&&!l.length&&(r&=-33,m=l=!1);var g=t&&t.__bindData__;return g&&!0!==g?(g=g.slice(),!p||1&g[1]||(g[4]=c),!p&&1&g[1]&&(r|=8),!h||4&g[1]||(g[5]=u),d&&a.apply(g[2]||(g[2]=[]),s),m&&a.apply(g[3]||(g[3]=[]),l),g[1]|=r,e.apply(null,g)):(1==r||17===r?n:o)([t,r,s,l,c,u])}},521:(e,t,r)=>{var n=r(450),o=r(669),i=r(794),a=[].push;e.exports=function(e){var t=e[0],r=e[2],s=e[4];function l(){if(r){var e=r.slice();a.apply(e,arguments)}if(this instanceof l){var i=n(t.prototype),c=t.apply(i,e||arguments);return o(c)?c:i}return t.apply(s,e||arguments)}return i(l,e),l}},586:e=>{var t;t={ns:{name:{singular:"Nanosecond",plural:"Nanoseconds"},to_anchor:1e-9},mu:{name:{singular:"Microsecond",plural:"Microseconds"},to_anchor:1e-6},ms:{name:{singular:"Millisecond",plural:"Milliseconds"},to_anchor:.001},s:{name:{singular:"Second",plural:"Seconds"},to_anchor:1},min:{name:{singular:"Minute",plural:"Minutes"},to_anchor:60},h:{name:{singular:"Hour",plural:"Hours"},to_anchor:3600},d:{name:{singular:"Day",plural:"Days"},to_anchor:86400},week:{name:{singular:"Week",plural:"Weeks"},to_anchor:604800},month:{name:{singular:"Month",plural:"Months"},to_anchor:2629800},year:{name:{singular:"Year",plural:"Years"},to_anchor:31557600}},e.exports={metric:t,_anchors:{metric:{unit:"s",ratio:1}}}},618:(e,t,r)=>{var n=r(669),o=r(177),i=r(30),a=o.test(a=Object.keys)&&a,s=a?function(e){return n(e)?a(e):[]}:i;e.exports=s},628:e=>{e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},629:e=>{var t,r;t={C:{name:{singular:"degree Celsius",plural:"degrees Celsius"},to_anchor:1,anchor_shift:0},K:{name:{singular:"degree Kelvin",plural:"degrees Kelvin"},to_anchor:1,anchor_shift:273.15}},r={F:{name:{singular:"degree Fahrenheit",plural:"degrees Fahrenheit"},to_anchor:1},R:{name:{singular:"degree Rankine",plural:"degrees Rankine"},to_anchor:1,anchor_shift:459.67}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"C",transform:function(e){return e/(5/9)+32}},imperial:{unit:"F",transform:function(e){return 5/9*(e-32)}}}}},666:(e,t,r)=>{var n,o,i=r(618),a=r(796),s={length:r(315),area:r(978),mass:r(503),volume:r(445),each:r(466),temperature:r(629),time:r(586),digital:r(183),partsPer:r(133),speed:r(496),pace:r(4),pressure:r(264),current:r(86),voltage:r(257),power:r(237),reactivePower:r(467),apparentPower:r(157),energy:r(99),reactiveEnergy:r(908),volumeFlowRate:r(875),illuminance:r(170),frequency:r(241),angle:r(472)};(o=function(e,t){this.val=t?e/t:e}).prototype.from=function(e){if(this.destination)throw new Error(".from must be called before .to");return this.origin=this.getUnit(e),this.origin||this.throwUnsupportedUnitError(e),this},o.prototype.to=function(e){if(!this.origin)throw new Error(".to must be called after .from");var t,r;if(this.destination=this.getUnit(e),this.destination||this.throwUnsupportedUnitError(e),this.origin.abbr===this.destination.abbr)return this.val;if(this.destination.measure!=this.origin.measure)throw new Error("Cannot convert incompatible measures of "+this.destination.measure+" and "+this.origin.measure);return t=this.val*this.origin.unit.to_anchor,this.origin.unit.anchor_shift&&(t-=this.origin.unit.anchor_shift),this.origin.system!=this.destination.system&&("function"==typeof(r=s[this.origin.measure]._anchors[this.origin.system].transform)?t=r(t):t*=s[this.origin.measure]._anchors[this.origin.system].ratio),this.destination.unit.anchor_shift&&(t+=this.destination.unit.anchor_shift),t/this.destination.unit.to_anchor},o.prototype.toBest=function(e){if(!this.origin)throw new Error(".toBest must be called after .from");var t;return e=Object.assign({exclude:[],cutOffNumber:1},e),a(this.possibilities(),function(r){var n=this.describe(r);if(-1===e.exclude.indexOf(r)&&n.system===this.origin.system){var o=this.to(r);(!t||o>=e.cutOffNumber&&o<t.val)&&(t={val:o,unit:r,singular:n.singular,plural:n.plural})}}.bind(this)),t},o.prototype.getUnit=function(e){var t;return a(s,(function(r,n){if(a(r,(function(r,o){return"_anchors"!=o&&(a(r,(function(r,i){if(i==e)return t={abbr:e,measure:n,system:o,unit:r},!1})),!t&&void 0)})),t)return!1})),t};var l=function(e){return{abbr:e.abbr,measure:e.measure,system:e.system,singular:e.unit.name.singular,plural:e.unit.name.plural}};o.prototype.describe=function(e){var t=o.prototype.getUnit(e),r=null;try{r=l(t)}catch(t){this.throwUnsupportedUnitError(e)}return r},o.prototype.list=function(e){var t=[];return a(s,(function(r,n){e&&e!==n||a(r,(function(e,r){if("_anchors"==r)return!1;a(e,(function(e,o){t=t.concat(l({abbr:o,measure:n,system:r,unit:e}))}))}))})),t},o.prototype.throwUnsupportedUnitError=function(e){var t=[];throw a(s,(function(e,r){a(e,(function(e,r){if("_anchors"==r)return!1;t=t.concat(i(e))}))})),new Error("Unsupported unit "+e+", use one of: "+t.join(", "))},o.prototype.possibilities=function(e){var t=[];return this.origin||e?(e=e||this.origin.measure,a(s[e],(function(e,r){if("_anchors"==r)return!1;t=t.concat(i(e))}))):a(i(s),(function(e){a(s[e],(function(e,r){if("_anchors"==r)return!1;t=t.concat(i(e))}))})),t},o.prototype.measures=function(){return i(s)},n=function(e){return new o(e)},e.exports=n},669:(e,t,r)=>{var n=r(813);e.exports=function(e){return!(!e||!n[typeof e])}},710:e=>{e.exports=function(e){return"function"==typeof e}},714:e=>{e.exports=function(){}},737:(e,t,r)=>{var n=r(450),o=r(669),i=r(794),a=r(923),s=[].push;e.exports=function e(t){var r=t[0],l=t[1],c=t[2],u=t[3],p=t[4],h=t[5],d=1&l,m=2&l,g=4&l,f=8&l,y=r;function _(){var t=d?p:this;if(c){var i=c.slice();s.apply(i,arguments)}if((u||g)&&(i||(i=a(arguments)),u&&s.apply(i,u),g&&i.length<h))return l|=16,e([r,f?l:-4&l,i,null,p,h]);if(i||(i=arguments),m&&(r=t[y]),this instanceof _){t=n(r.prototype);var v=r.apply(t,i);return o(v)?v:t}return r.apply(t,i)}return i(_,t),_}},778:(e,t,r)=>{var n=r(628);function o(e){var t=0;if(e&&e.length>0){t+=Math.abs(i(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(i(e[r]))}return t}function i(e){var t,r,o,i,s,l,c=0,u=e.length;if(u>2){for(l=0;l<u;l++)l===u-2?(o=u-2,i=u-1,s=0):l===u-1?(o=u-1,i=0,s=1):(o=l,i=l+1,s=l+2),t=e[o],r=e[i],c+=(a(e[s][0])-a(t[0]))*Math.sin(a(r[1]));c=c*n.RADIUS*n.RADIUS/2}return c}function a(e){return e*Math.PI/180}e.exports.geometry=function e(t){var r,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)n+=o(t.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<t.geometries.length;r++)n+=e(t.geometries[r]);return n}},e.exports.ring=i},794:(e,t,r)=>{var n=r(714),o=r(177),i={configurable:!1,enumerable:!1,value:null,writable:!1},a=function(){try{var e={},t=o.test(t=Object.defineProperty)&&t,r=t(e,e,e)&&t}catch(e){}return r}(),s=a?function(e,t){i.value=t,a(e,"__bindData__",i)}:n;e.exports=s},796:(e,t,r)=>{var n=r(889),o=r(447);e.exports=function(e,t,r){var i=-1,a=e?e.length:0;if(t=t&&void 0===r?t:n(t,r,3),"number"==typeof a)for(;++i<a&&!1!==t(e[i],i,e););else o(e,t);return e}},813:e=>{e.exports={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1}},857:(e,t,r)=>{var n=r(177),o={};o.funcDecomp=!n.test(r.g.WinRTError)&&/\bthis\b/.test((function(){return this})),o.funcNames="string"==typeof Function.name,e.exports=o},875:e=>{var t,r;t={"mm3/s":{name:{singular:"Cubic Millimeter per second",plural:"Cubic Millimeters per second"},to_anchor:1e-6},"cm3/s":{name:{singular:"Cubic Centimeter per second",plural:"Cubic Centimeters per second"},to_anchor:.001},"ml/s":{name:{singular:"Millilitre per second",plural:"Millilitres per second"},to_anchor:.001},"cl/s":{name:{singular:"Centilitre per second",plural:"Centilitres per second"},to_anchor:.01},"dl/s":{name:{singular:"Decilitre per second",plural:"Decilitres per second"},to_anchor:.1},"l/s":{name:{singular:"Litre per second",plural:"Litres per second"},to_anchor:1},"l/min":{name:{singular:"Litre per minute",plural:"Litres per minute"},to_anchor:1/60},"l/h":{name:{singular:"Litre per hour",plural:"Litres per hour"},to_anchor:1/3600},"kl/s":{name:{singular:"Kilolitre per second",plural:"Kilolitres per second"},to_anchor:1e3},"kl/min":{name:{singular:"Kilolitre per minute",plural:"Kilolitres per minute"},to_anchor:50/3},"kl/h":{name:{singular:"Kilolitre per hour",plural:"Kilolitres per hour"},to_anchor:5/18},"m3/s":{name:{singular:"Cubic meter per second",plural:"Cubic meters per second"},to_anchor:1e3},"m3/min":{name:{singular:"Cubic meter per minute",plural:"Cubic meters per minute"},to_anchor:50/3},"m3/h":{name:{singular:"Cubic meter per hour",plural:"Cubic meters per hour"},to_anchor:5/18},"km3/s":{name:{singular:"Cubic kilometer per second",plural:"Cubic kilometers per second"},to_anchor:1e12}},r={"tsp/s":{name:{singular:"Teaspoon per second",plural:"Teaspoons per second"},to_anchor:1/6},"Tbs/s":{name:{singular:"Tablespoon per second",plural:"Tablespoons per second"},to_anchor:.5},"in3/s":{name:{singular:"Cubic inch per second",plural:"Cubic inches per second"},to_anchor:.55411},"in3/min":{name:{singular:"Cubic inch per minute",plural:"Cubic inches per minute"},to_anchor:.55411/60},"in3/h":{name:{singular:"Cubic inch per hour",plural:"Cubic inches per hour"},to_anchor:.55411/3600},"fl-oz/s":{name:{singular:"Fluid Ounce per second",plural:"Fluid Ounces per second"},to_anchor:1},"fl-oz/min":{name:{singular:"Fluid Ounce per minute",plural:"Fluid Ounces per minute"},to_anchor:1/60},"fl-oz/h":{name:{singular:"Fluid Ounce per hour",plural:"Fluid Ounces per hour"},to_anchor:1/3600},"cup/s":{name:{singular:"Cup per second",plural:"Cups per second"},to_anchor:8},"pnt/s":{name:{singular:"Pint per second",plural:"Pints per second"},to_anchor:16},"pnt/min":{name:{singular:"Pint per minute",plural:"Pints per minute"},to_anchor:4/15},"pnt/h":{name:{singular:"Pint per hour",plural:"Pints per hour"},to_anchor:1/225},"qt/s":{name:{singular:"Quart per second",plural:"Quarts per second"},to_anchor:32},"gal/s":{name:{singular:"Gallon per second",plural:"Gallons per second"},to_anchor:128},"gal/min":{name:{singular:"Gallon per minute",plural:"Gallons per minute"},to_anchor:32/15},"gal/h":{name:{singular:"Gallon per hour",plural:"Gallons per hour"},to_anchor:8/225},"ft3/s":{name:{singular:"Cubic foot per second",plural:"Cubic feet per second"},to_anchor:957.506},"ft3/min":{name:{singular:"Cubic foot per minute",plural:"Cubic feet per minute"},to_anchor:957.506/60},"ft3/h":{name:{singular:"Cubic foot per hour",plural:"Cubic feet per hour"},to_anchor:957.506/3600},"yd3/s":{name:{singular:"Cubic yard per second",plural:"Cubic yards per second"},to_anchor:25852.7},"yd3/min":{name:{singular:"Cubic yard per minute",plural:"Cubic yards per minute"},to_anchor:25852.7/60},"yd3/h":{name:{singular:"Cubic yard per hour",plural:"Cubic yards per hour"},to_anchor:25852.7/3600}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"l/s",ratio:33.8140227},imperial:{unit:"fl-oz/s",ratio:1/33.8140227}}}},889:(e,t,r)=>{var n=r(41),o=r(160),i=r(794),a=r(857),s=/^\s*function[ \n\r\t]+\w/,l=/\bthis\b/,c=Function.prototype.toString;e.exports=function(e,t,r){if("function"!=typeof e)return o;if(void 0===t||!("prototype"in e))return e;var u=e.__bindData__;if(void 0===u&&(a.funcNames&&(u=!e.name),!(u=u||!a.funcDecomp))){var p=c.call(e);a.funcNames||(u=!s.test(p)),u||(u=l.test(p),i(e,u))}if(!1===u||!0!==u&&1&u[1])return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)};case 4:return function(r,n,o,i){return e.call(t,r,n,o,i)}}return n(e,t)}},908:e=>{var t;t={VARh:{name:{singular:"Volt-Ampere Reactive Hour",plural:"Volt-Amperes Reactive Hour"},to_anchor:1},mVARh:{name:{singular:"Millivolt-Ampere Reactive Hour",plural:"Millivolt-Amperes Reactive Hour"},to_anchor:.001},kVARh:{name:{singular:"Kilovolt-Ampere Reactive Hour",plural:"Kilovolt-Amperes Reactive Hour"},to_anchor:1e3},MVARh:{name:{singular:"Megavolt-Ampere Reactive Hour",plural:"Megavolt-Amperes Reactive Hour"},to_anchor:1e6},GVARh:{name:{singular:"Gigavolt-Ampere Reactive Hour",plural:"Gigavolt-Amperes Reactive Hour"},to_anchor:1e9}},e.exports={metric:t,_anchors:{metric:{unit:"VARh",ratio:1}}}},923:e=>{e.exports=function(e,t,r){t||(t=0),void 0===r&&(r=e?e.length:0);for(var n=-1,o=r-t||0,i=Array(o<0?0:o);++n<o;)i[n]=e[t+n];return i}},978:e=>{var t,r;t={mm2:{name:{singular:"Square Millimeter",plural:"Square Millimeters"},to_anchor:1e-6},cm2:{name:{singular:"Centimeter",plural:"Centimeters"},to_anchor:1e-4},m2:{name:{singular:"Square Meter",plural:"Square Meters"},to_anchor:1},ha:{name:{singular:"Hectare",plural:"Hectares"},to_anchor:1e4},km2:{name:{singular:"Square Kilometer",plural:"Square Kilometers"},to_anchor:1e6}},r={in2:{name:{singular:"Square Inch",plural:"Square Inches"},to_anchor:1/144},yd2:{name:{singular:"Square Yard",plural:"Square Yards"},to_anchor:9},ft2:{name:{singular:"Square Foot",plural:"Square Feet"},to_anchor:1},ac:{name:{singular:"Acre",plural:"Acres"},to_anchor:43560},mi2:{name:{singular:"Square Mile",plural:"Square Miles"},to_anchor:27878400}},e.exports={metric:t,imperial:r,_anchors:{metric:{unit:"m2",ratio:10.7639},imperial:{unit:"ft2",ratio:1/10.7639}}}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{default:()=>Ft});var e={};r.r(e),r.d(e,{LAT_MAX:()=>C,LAT_MIN:()=>_,LAT_RENDERED_MAX:()=>E,LAT_RENDERED_MIN:()=>v,LNG_MAX:()=>M,LNG_MIN:()=>b,activeStates:()=>f,classes:()=>s,cursors:()=>c,events:()=>d,geojsonTypes:()=>p,interactions:()=>y,meta:()=>g,modes:()=>h,sources:()=>l,types:()=>u,updateActions:()=>m});var t={};r.r(t),r.d(t,{isActiveFeature:()=>_e,isEnterKey:()=>Se,isEscapeKey:()=>Te,isFeature:()=>Ee,isInactiveFeature:()=>ve,isOfMetaType:()=>fe,isShiftDown:()=>Me,isShiftMousedown:()=>ye,isTrue:()=>Ie,isVertex:()=>be,noTarget:()=>Ce});var o={};r.r(o),r.d(o,{CommonSelectors:()=>t,ModeHandler:()=>i,StringSet:()=>L,constrainFeatureMovement:()=>Ve,createMidPoint:()=>Ae,createSupplementaryPoints:()=>Pe,createVertex:()=>Le,doubleClickZoom:()=>we,euclideanDistance:()=>F,featuresAt:()=>P,getFeatureAtAndSetCursors:()=>N,isClick:()=>U,isEventAtCoordinates:()=>We,isTap:()=>B,mapEventToBoundingBox:()=>O,moveFeatures:()=>Ge,sortFeatures:()=>I,stringSetsAreEqual:()=>at,theme:()=>ge,toDenseArray:()=>ae});const i=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on(e,t,n){if(void 0===r[e])throw new Error(`Invalid event type: ${e}`);r[e].push({selector:t,fn:n})},render(e){t.store.featureChanged(e)}},o=function(e,o){const i=r[e];let a=i.length;for(;a--;){const e=i[a];if(e.selector(o)){e.fn.call(n,o)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(e){o("drag",e)},click(e){o("click",e)},mousemove(e){o("mousemove",e)},mousedown(e){o("mousedown",e)},mouseup(e){o("mouseup",e)},mouseout(e){o("mouseout",e)},keydown(e){o("keydown",e)},keyup(e){o("keyup",e)},touchstart(e){o("touchstart",e)},touchmove(e){o("touchmove",e)},touchend(e){o("touchend",e)},tap(e){o("tap",e)}}};var a=r(778);const s={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},l={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},c={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},u={POLYGON:"polygon",LINE:"line_string",POINT:"point"},p={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},h={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},d={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},m={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},g={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},f={ACTIVE:"true",INACTIVE:"false"},y=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],_=-90,v=-85,C=90,E=85,b=-270,M=270,T={Point:0,LineString:1,MultiLineString:1,Polygon:2};function S(e,t){const r=T[e.geometry.type]-T[t.geometry.type];return 0===r&&e.geometry.type===p.POLYGON?e.area-t.area:r}const I=function(e){return e.map((e=>(e.geometry.type===p.POLYGON&&(e.area=a.geometry({type:p.FEATURE,property:{},geometry:e.geometry})),e))).sort(S).map((e=>(delete e.area,e)))},O=function(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]};function x(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}x.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},x.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},x.prototype.has=function(e){return!("string"!=typeof e&&"number"!=typeof e||void 0===this._items[e]&&void 0===this._nums[e])},x.prototype.values=function(){const e=[];return Object.keys(this._items).forEach((t=>{e.push({k:t,v:this._items[t]})})),Object.keys(this._nums).forEach((t=>{e.push({k:JSON.parse(t),v:this._nums[t]})})),e.sort(((e,t)=>e.v-t.v)).map((e=>e.k))},x.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const L=x,A=[g.FEATURE,g.MIDPOINT,g.VERTEX],P={click:function(e,t,r){return w(e,t,r,r.options.clickBuffer)},touch:function(e,t,r){return w(e,t,r,r.options.touchBuffer)}};function w(e,t,r,n){if(null===r.map)return[];const o=e?O(e,n):t,i={};r.options.styles&&(i.layers=r.options.styles.map((e=>e.id)).filter((e=>null!=r.map.getLayer(e))));const a=r.map.queryRenderedFeatures(o,i).filter((e=>-1!==A.indexOf(e.properties.meta))),s=new L,l=[];return a.forEach((e=>{const t=e.properties.id;s.has(t)||(s.add(t),l.push(e))})),I(l)}function N(e,t){const r=P.click(e,null,t),n={mouse:c.NONE};return r[0]&&(n.mouse=r[0].properties.active===f.ACTIVE?c.MOVE:c.POINTER,n.feature=r[0].properties.meta),-1!==t.events.currentModeName().indexOf("draw")&&(n.mouse=c.ADD),t.ui.queueMapClasses(n),t.ui.updateMapClasses(),r[0]}function F(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}const R=4,k=12,D=500;function U(e,t,r={}){const n=null!=r.fineTolerance?r.fineTolerance:R,o=null!=r.grossTolerance?r.grossTolerance:k,i=null!=r.interval?r.interval:D;e.point=e.point||t.point,e.time=e.time||t.time;const a=F(e.point,t.point);return a<n||a<o&&t.time-e.time<i}const V=25,G=250;function B(e,t,r={}){const n=null!=r.tolerance?r.tolerance:V,o=null!=r.interval?r.interval:G;return e.point=e.point||t.point,e.time=e.time||t.time,F(e.point,t.point)<n&&t.time-e.time<o}const K=((e,t=21)=>(r=t)=>{let n="",o=0|r;for(;o--;)n+=e[Math.random()*e.length|0];return n})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function j(){return K()}const $=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||j(),this.type=t.geometry.type};$.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},$.prototype.incomingCoords=function(e){this.setCoordinates(e)},$.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},$.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},$.prototype.setProperty=function(e,t){this.properties[e]=t},$.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:p.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},$.prototype.internal=function(e){const t={id:this.id,meta:g.FEATURE,"meta:type":this.type,active:f.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const e in this.properties)t[`user_${e}`]=this.properties[e];return{type:p.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const H=$,q=function(e,t){H.call(this,e,t)};(q.prototype=Object.create(H.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},q.prototype.updateCoordinate=function(e,t,r){this.coordinates=3===arguments.length?[t,r]:[e,t],this.changed()},q.prototype.getCoordinate=function(){return this.getCoordinates()};const J=q,z=function(e,t){H.call(this,e,t)};(z.prototype=Object.create(H.prototype)).isValid=function(){return this.coordinates.length>1},z.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])},z.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},z.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)},z.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};const W=z,Z=function(e,t){H.call(this,e,t),this.coordinates=this.coordinates.map((e=>e.slice(0,-1)))};(Z.prototype=Object.create(H.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every((e=>e.length>2))},Z.prototype.incomingCoords=function(e){this.coordinates=e.map((e=>e.slice(0,-1))),this.changed()},Z.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},Z.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map((e=>parseInt(e,10)));this.coordinates[n[0]].splice(n[1],0,[t,r])},Z.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map((e=>parseInt(e,10))),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))},Z.prototype.getCoordinate=function(e){const t=e.split(".").map((e=>parseInt(e,10))),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))},Z.prototype.getCoordinates=function(){return this.coordinates.map((e=>e.concat([e[0]])))},Z.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);void 0===this.coordinates[o]&&(this.coordinates[o]=[]),this.coordinates[o][i]=[t,r]};const Y=Z,X={MultiPoint:J,MultiLineString:W,MultiPolygon:Y},Q=(e,t,r,n,o)=>{const i=r.split("."),a=parseInt(i[0],10),s=i[1]?i.slice(1).join("."):null;return e[a][t](s,n,o)},ee=function(e,t){if(H.call(this,e,t),delete this.coordinates,this.model=X[t.geometry.type],void 0===this.model)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};(ee.prototype=Object.create(H.prototype))._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map((e=>new t(this.ctx,{id:j(),type:p.FEATURE,properties:{},geometry:{coordinates:e,type:this.type.replace("Multi","")}})))},ee.prototype.isValid=function(){return this.features.every((e=>e.isValid()))},ee.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()},ee.prototype.getCoordinate=function(e){return Q(this.features,"getCoordinate",e)},ee.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((e=>e.type===p.POLYGON?e.getCoordinates():e.coordinates))))},ee.prototype.updateCoordinate=function(e,t,r){Q(this.features,"updateCoordinate",e,t,r),this.changed()},ee.prototype.addCoordinate=function(e,t,r){Q(this.features,"addCoordinate",e,t,r),this.changed()},ee.prototype.removeCoordinate=function(e){Q(this.features,"removeCoordinate",e),this.changed()},ee.prototype.getFeatures=function(){return this.features};const te=ee;function re(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}re.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)},re.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce(((e,t)=>(void 0===e[t.feature_id]&&(e[t.feature_id]=!0,this._ctx.store.get(t.feature_id).changed()),e)),{})},re.prototype.getSelected=function(){return this._ctx.store.getSelected()},re.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},re.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)},re.prototype.getFeature=function(e){return this._ctx.store.get(e)},re.prototype.select=function(e){return this._ctx.store.select(e)},re.prototype.deselect=function(e){return this._ctx.store.deselect(e)},re.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)},re.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)},re.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},re.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},re.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)},re.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)},re.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)},re.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)},re.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)},re.prototype.featuresAt=function(e,t,r="click"){if("click"!==r&&"touch"!==r)throw new Error("invalid buffer type");return P[r](e,t,this._ctx)},re.prototype.newFeature=function(e){const t=e.geometry.type;return t===p.POINT?new J(this._ctx,e):t===p.LINE_STRING?new W(this._ctx,e):t===p.POLYGON?new Y(this._ctx,e):new te(this._ctx,e)},re.prototype.isInstanceOf=function(e,t){if(e===p.POINT)return t instanceof J;if(e===p.LINE_STRING)return t instanceof W;if(e===p.POLYGON)return t instanceof Y;if("MultiFeature"===e)return t instanceof te;throw new Error(`Unknown feature class: ${e}`)},re.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};const ne=re;re.prototype.onSetup=function(){},re.prototype.onDrag=function(){},re.prototype.onClick=function(){},re.prototype.onMouseMove=function(){},re.prototype.onMouseDown=function(){},re.prototype.onMouseUp=function(){},re.prototype.onMouseOut=function(){},re.prototype.onKeyUp=function(){},re.prototype.onKeyDown=function(){},re.prototype.onTouchStart=function(){},re.prototype.onTouchMove=function(){},re.prototype.onTouchEnd=function(){},re.prototype.onTap=function(){},re.prototype.onStop=function(){},re.prototype.onTrash=function(){},re.prototype.onCombineFeature=function(){},re.prototype.onUncombineFeature=function(){},re.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const oe={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},ie=Object.keys(oe);const ae=function(e){return[].concat(e).filter((e=>void 0!==e))};function se(){const e=this;if(!e.ctx.map||void 0===e.ctx.map.getSource(l.HOT))return s();const t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});let r=[],n=[];e.isDirty?n=e.getAllIds():(r=e.getChangedIds().filter((t=>void 0!==e.get(t))),n=e.sources.hot.filter((t=>t.properties.id&&-1===r.indexOf(t.properties.id)&&void 0!==e.get(t.properties.id))).map((e=>e.properties.id))),e.sources.hot=[];const o=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter((e=>{const t=e.properties.id||e.properties.parent;return-1===r.indexOf(t)}));const i=o!==e.sources.cold.length||n.length>0;function a(r,n){const o=e.get(r).internal(t);e.ctx.events.currentModeRender(o,(r=>{r.properties.mode=t,e.sources[n].push(r)}))}function s(){e.isDirty=!1,e.clearChangedIds()}r.forEach((e=>a(e,"hot"))),n.forEach((e=>a(e,"cold"))),i&&e.ctx.map.getSource(l.COLD).setData({type:p.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(l.HOT).setData({type:p.FEATURE_COLLECTION,features:e.sources.hot}),s()}function le(e){let t;this._features={},this._featureIds=new L,this._selectedFeatureIds=new L,this._selectedCoordinates=[],this._changedFeatureIds=new L,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=()=>{t||(t=requestAnimationFrame((()=>{t=null,se.call(this),this._emitSelectionChange&&(this.ctx.events.fire(d.SELECTION_CHANGE,{features:this.getSelected().map((e=>e.toGeoJSON())),points:this.getSelectedCoordinates().map((e=>({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:e.coordinates}})))}),this._emitSelectionChange=!1),this.ctx.events.fire(d.RENDER,{})})))},this.isDirty=!1}function ce(e,t={}){const r=e._selectedCoordinates.filter((t=>e._selectedFeatureIds.has(t.feature_id)));e._selectedCoordinates.length===r.length||t.silent||(e._emitSelectionChange=!0),e._selectedCoordinates=r}le.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}},le.prototype.setDirty=function(){return this.isDirty=!0,this},le.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)){const t=this.get(e);this.ctx.events.fire(d.CREATE,{features:[t.toGeoJSON()]})}return this},le.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)&&this.ctx.events.fire(d.UPDATE,{action:t.action?t.action:m.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this},le.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},le.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},le.prototype.getAllIds=function(){return this._featureIds.values()},le.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this},le.prototype.delete=function(e,t={}){const r=[];return ae(e).forEach((e=>{this._featureIds.has(e)&&(this._featureIds.delete(e),this._selectedFeatureIds.delete(e),t.silent||-1===r.indexOf(this._features[e])&&r.push(this._features[e].toGeoJSON()),delete this._features[e],this.isDirty=!0)})),r.length&&this.ctx.events.fire(d.DELETE,{features:r}),ce(this,t),this},le.prototype.get=function(e){return this._features[e]},le.prototype.getAll=function(){return Object.keys(this._features).map((e=>this._features[e]))},le.prototype.select=function(e,t={}){return ae(e).forEach((e=>{this._selectedFeatureIds.has(e)||(this._selectedFeatureIds.add(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))})),this},le.prototype.deselect=function(e,t={}){return ae(e).forEach((e=>{this._selectedFeatureIds.has(e)&&(this._selectedFeatureIds.delete(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))})),ce(this,t),this},le.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this},le.prototype.setSelected=function(e,t={}){return e=ae(e),this.deselect(this._selectedFeatureIds.values().filter((t=>-1===e.indexOf(t))),{silent:t.silent}),this.select(e.filter((e=>!this._selectedFeatureIds.has(e))),{silent:t.silent}),this},le.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this},le.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},le.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},le.prototype.getSelected=function(){return this.getSelectedIds().map((e=>this.get(e)))},le.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map((e=>({coordinates:this.get(e.feature_id).getCoordinate(e.coord_path)})))},le.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)},le.prototype.setFeatureProperty=function(e,t,r,n={}){this.get(e).setProperty(t,r),this.featureChanged(e,{silent:n.silent,action:m.CHANGE_PROPERTIES})},le.prototype.storeMapConfig=function(){y.forEach((e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())}))},le.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach((e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()}))},le.prototype.getInitialConfigValue=function(e){return void 0===this._mapInitialConfig[e]||this._mapInitialConfig[e]};const ue=["mode","feature","mouse"];function pe(e){let t=null,r=null;const n={onRemove(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(o){if(e.map=o,e.events=function(e){const t=Object.keys(e.options.modes).reduce(((t,r)=>(t[r]=function(e){const t=Object.keys(e);return function(r,n={}){let o={};const i=t.reduce(((t,r)=>(t[r]=e[r],t)),new ne(r));return{start(){o=i.onSetup(n),ie.forEach((t=>{const r=oe[t];let n=()=>!1;var a;e[r]&&(n=()=>!0),this.on(t,n,(a=r,e=>i[a](o,e)))}))},stop(){i.onStop(o)},trash(){i.onTrash(o)},combineFeatures(){i.onCombineFeatures(o)},uncombineFeatures(){i.onUncombineFeatures(o)},render(e,t){i.toDisplayFeatures(o,e,t)}}}}(e.options.modes[r]),t)),{});let r={},n={};const o={};let a=null,l=null;o.drag=function(t,r){r({point:t.point,time:(new Date).getTime()})?(e.ui.queueMapClasses({mouse:c.DRAG}),l.drag(t)):t.originalEvent.stopPropagation()},o.mousedrag=function(e){o.drag(e,(e=>!U(r,e)))},o.touchdrag=function(e){o.drag(e,(e=>!B(n,e)))},o.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return o.mousedrag(t);const r=N(t,e);t.featureTarget=r,l.mousemove(t)},o.mousedown=function(t){r={time:(new Date).getTime(),point:t.point};const n=N(t,e);t.featureTarget=n,l.mousedown(t)},o.mouseup=function(t){const n=N(t,e);t.featureTarget=n,U(r,{point:t.point,time:(new Date).getTime()})?l.click(t):l.mouseup(t)},o.mouseout=function(e){l.mouseout(e)},o.touchstart=function(t){if(!e.options.touchEnabled)return;n={time:(new Date).getTime(),point:t.point};const r=P.touch(t,null,e)[0];t.featureTarget=r,l.touchstart(t)},o.touchmove=function(t){if(e.options.touchEnabled)return l.touchmove(t),o.touchdrag(t)},o.touchend=function(t){if(t.originalEvent.preventDefault(),!e.options.touchEnabled)return;const r=P.touch(t,null,e)[0];t.featureTarget=r,B(n,{time:(new Date).getTime(),point:t.point})?l.tap(t):l.touchend(t)};const u=e=>!(8===e||46===e||e>=48&&e<=57);function p(r,n,o={}){l.stop();const s=t[r];if(void 0===s)throw new Error(`${r} is not valid`);a=r;const c=s(e,n);l=i(c,e),o.silent||e.map.fire(d.MODE_CHANGE,{mode:r}),e.store.setDirty(),e.store.render()}o.keydown=function(t){(t.srcElement||t.target).classList.contains(s.CANVAS)&&(8!==t.keyCode&&46!==t.keyCode||!e.options.controls.trash?u(t.keyCode)?l.keydown(t):49===t.keyCode&&e.options.controls.point?p(h.DRAW_POINT):50===t.keyCode&&e.options.controls.line_string?p(h.DRAW_LINE_STRING):51===t.keyCode&&e.options.controls.polygon&&p(h.DRAW_POLYGON):(t.preventDefault(),l.trash()))},o.keyup=function(e){u(e.keyCode)&&l.keyup(e)},o.zoomend=function(){e.store.changeZoom()},o.data=function(t){if("style"===t.dataType){const{setup:t,map:r,options:n,store:o}=e;n.styles.some((e=>r.getLayer(e.id)))||(t.addLayers(),o.setDirty(),o.render())}};const m={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start(){a=e.options.defaultMode,l=i(t[a](e),e)},changeMode:p,actionable:function(t){let r=!1;Object.keys(t).forEach((e=>{if(void 0===m[e])throw new Error("Invalid action type");m[e]!==t[e]&&(r=!0),m[e]=t[e]})),r&&e.map.fire(d.ACTIONABLE,{actions:m})},currentModeName:()=>a,currentModeRender:(e,t)=>l.render(e,t),fire(t,r){e.map&&e.map.fire(t,r)},addEventListeners(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash(e){l.trash(e)},combineFeatures(){l.combineFeatures()},uncombineFeatures(){l.uncombineFeatures()},getMode:()=>a}}(e),e.ui=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null};function i(e){o=Object.assign(o,e)}function a(){if(!e.container)return;const t=[],r=[];ue.forEach((e=>{o[e]!==n[e]&&(t.push(`${e}-${n[e]}`),null!==o[e]&&r.push(`${e}-${o[e]}`))})),t.length>0&&e.container.classList.remove(...t),r.length>0&&e.container.classList.add(...r),n=Object.assign(n,o)}function l(e,t={}){const n=document.createElement("button");return n.className=`${s.CONTROL_BUTTON} ${t.className}`,n.setAttribute("title",t.title),t.container.appendChild(n),n.addEventListener("click",(n=>{if(n.preventDefault(),n.stopPropagation(),n.target===r)return c(),void t.onDeactivate();p(e),t.onActivate()}),!0),n}function c(){r&&(r.classList.remove(s.ACTIVE_BUTTON),r=null)}function p(e){c();const n=t[e];n&&n&&"trash"!==e&&(n.classList.add(s.ACTIVE_BUTTON),r=n)}return{setActiveButton:p,queueMapClasses:i,updateMapClasses:a,clearMapClasses:function(){i({mode:null,feature:null,mouse:null}),a()},addButtons:function(){const r=e.options.controls,n=document.createElement("div");return n.className=`${s.CONTROL_GROUP} ${s.CONTROL_BASE}`,r?(r[u.LINE]&&(t[u.LINE]=l(u.LINE,{container:n,className:s.CONTROL_BUTTON_LINE,title:"LineString tool "+(e.options.keybindings?"(l)":""),onActivate:()=>e.events.changeMode(h.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),r[u.POLYGON]&&(t[u.POLYGON]=l(u.POLYGON,{container:n,className:s.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(e.options.keybindings?"(p)":""),onActivate:()=>e.events.changeMode(h.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),r[u.POINT]&&(t[u.POINT]=l(u.POINT,{container:n,className:s.CONTROL_BUTTON_POINT,title:"Marker tool "+(e.options.keybindings?"(m)":""),onActivate:()=>e.events.changeMode(h.DRAW_POINT),onDeactivate:()=>e.events.trash()})),r.trash&&(t.trash=l("trash",{container:n,className:s.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),r.combine_features&&(t.combine_features=l("combineFeatures",{container:n,className:s.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),r.uncombine_features&&(t.uncombine_features=l("uncombineFeatures",{container:n,className:s.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}})),n):n},removeButtons:function(){Object.keys(t).forEach((e=>{const r=t[e];r.parentNode&&r.parentNode.removeChild(r),delete t[e]}))}}}(e),e.container=o.getContainer(),e.store=new le(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=o.boxZoom.isEnabled(),o.boxZoom.disable();const t=o.dragPan.isEnabled();o.dragPan.disable(),o.dragPan.enable(),t||o.dragPan.disable()}return o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval((()=>{o.loaded()&&n.connect()}),16)),e.events.start(),t},addLayers(){e.map.addSource(l.COLD,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(l.HOT,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach((t=>{e.map.addLayer(t)})),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach((t=>{e.map.getLayer(t.id)&&e.map.removeLayer(t.id)})),e.map.getSource(l.COLD)&&e.map.removeSource(l.COLD),e.map.getSource(l.HOT)&&e.map.removeSource(l.HOT)}};return e.setup=n,n}const he="#3bb2d0",de="#fbb03b",me="#fff",ge=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],de,he],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],de,he],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":me}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],de,he]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":me}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":de}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":de}}];function fe(e){return function(t){const r=t.featureTarget;return!!r&&!!r.properties&&r.properties.meta===e}}function ye(e){return!!e.originalEvent&&!!e.originalEvent.shiftKey&&0===e.originalEvent.button}function _e(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===f.ACTIVE&&e.featureTarget.properties.meta===g.FEATURE}function ve(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===f.INACTIVE&&e.featureTarget.properties.meta===g.FEATURE}function Ce(e){return void 0===e.featureTarget}function Ee(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.meta===g.FEATURE}function be(e){const t=e.featureTarget;return!!t&&!!t.properties&&t.properties.meta===g.VERTEX}function Me(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}function Te(e){return 27===e.keyCode}function Se(e){return 13===e.keyCode}function Ie(){return!0}function Oe(e,t){this.x=e,this.y=t}Oe.prototype={clone(){return new Oe(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=n,this.y=o,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),o=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Oe},Oe.convert=function(e){if(e instanceof Oe)return e;if(Array.isArray(e))return new Oe(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new Oe(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};const xe=function(e,t){const r=t.getBoundingClientRect();return new Oe(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))};function Le(e,t,r,n){return{type:p.FEATURE,properties:{meta:g.VERTEX,parent:e,coord_path:r,active:n?f.ACTIVE:f.INACTIVE},geometry:{type:p.POINT,coordinates:t}}}function Ae(e,t,r){const n=t.geometry.coordinates,o=r.geometry.coordinates;if(n[1]>E||n[1]<v||o[1]>E||o[1]<v)return null;const i={lng:(n[0]+o[0])/2,lat:(n[1]+o[1])/2};return{type:p.FEATURE,properties:{meta:g.MIDPOINT,parent:e,lng:i.lng,lat:i.lat,coord_path:r.properties.coord_path},geometry:{type:p.POINT,coordinates:[i.lng,i.lat]}}}const Pe=function e(t,r={},n=null){const{type:o,coordinates:i}=t.geometry,a=t.properties&&t.properties.id;let s=[];function l(e,t){let n="",o=null;e.forEach(((e,i)=>{const l=null!=t?`${t}.${i}`:String(i),u=Le(a,e,l,c(l));if(r.midpoints&&o){const e=Ae(a,o,u);e&&s.push(e)}o=u;const p=JSON.stringify(e);n!==p&&s.push(u),0===i&&(n=p)}))}function c(e){return!!r.selectedPaths&&-1!==r.selectedPaths.indexOf(e)}return o===p.POINT?s.push(Le(a,i,n,c(n))):o===p.POLYGON?i.forEach(((e,t)=>{l(e,null!==n?`${n}.${t}`:String(t))})):o===p.LINE_STRING?l(i,n):0===o.indexOf(p.MULTI_PREFIX)&&function(){const n=o.replace(p.MULTI_PREFIX,"");i.forEach(((o,i)=>{const a={type:p.FEATURE,properties:t.properties,geometry:{type:n,coordinates:o}};s=s.concat(e(a,r,i))}))}(),s},we={enable(e){setTimeout((()=>{e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()}),0)},disable(e){setTimeout((()=>{e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()}),0)}},{LAT_MIN:Ne,LAT_MAX:Fe,LAT_RENDERED_MIN:Re,LAT_RENDERED_MAX:ke,LNG_MIN:De,LNG_MAX:Ue}=e;function Ve(e,t){let r=Ne,n=Fe,o=Ne,i=Fe,a=Ue,s=De;e.forEach((e=>{const t=function(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],r=[e.geometry.coordinates].flat(t),n=r.map((e=>e[0])),o=r.map((e=>e[1])),i=e=>Math.min.apply(null,e),a=e=>Math.max.apply(null,e);return[i(n),i(o),a(n),a(o)]}(e),l=t[1],c=t[3],u=t[0],p=t[2];l>r&&(r=l),c<n&&(n=c),c>o&&(o=c),l<i&&(i=l),u<a&&(a=u),p>s&&(s=p)}));const l=t;return r+l.lat>ke&&(l.lat=ke-r),o+l.lat>Fe&&(l.lat=Fe-o),n+l.lat<Re&&(l.lat=Re-n),i+l.lat<Ne&&(l.lat=Ne-i),a+l.lng<=De&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),s+l.lng>=Ue&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l}function Ge(e,t){const r=Ve(e.map((e=>e.toGeoJSON())),t);e.forEach((e=>{const t=e.getCoordinates(),n=e=>{const t={lng:e[0]+r.lng,lat:e[1]+r.lat};return[t.lng,t.lat]},o=e=>e.map((e=>n(e)));let i;e.type===p.POINT?i=n(t):e.type===p.LINE_STRING||e.type===p.MULTI_POINT?i=t.map(n):e.type===p.POLYGON||e.type===p.MULTI_LINE_STRING?i=t.map(o):e.type===p.MULTI_POLYGON&&(i=t.map((e=>e.map((e=>o(e)))))),e.incomingCoords(i)}))}const Be={onSetup:function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter((e=>void 0!==this.getFeature(e)))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t},fireUpdate:function(){this.fire(d.UPDATE,{action:m.MOVE,features:this.getSelected().map((e=>e.toGeoJSON()))})},fireActionable:function(){const e=this.getSelected(),t=e.filter((e=>this.isInstanceOf("MultiFeature",e)));let r=!1;if(e.length>1){r=!0;const t=e[0].type.replace("Multi","");e.forEach((e=>{e.type.replace("Multi","")!==t&&(r=!1)}))}const n=t.length>0,o=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:o})},getUniqueIds:function(e){return e.length?e.map((e=>e.properties.id)).filter((e=>void 0!==e)).reduce(((e,t)=>(e.add(t),e)),new L).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){we.enable(this)},onMouseMove:function(e,t){return Ee(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0},onMouseOut:function(e){return!e.dragMoving||this.fireUpdate()}};Be.onTap=Be.onClick=function(e,t){return Ce(t)?this.clickAnywhere(e,t):fe(g.VERTEX)(t)?this.clickOnVertex(e,t):Ee(t)?this.clickOnFeature(e,t):void 0},Be.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach((e=>this.doRender(e)))),we.enable(this),this.stopExtendedInteractions(e)},Be.clickOnVertex=function(e,t){this.changeMode(h.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:c.MOVE})},Be.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},Be.clickOnFeature=function(e,t){we.disable(this),this.stopExtendedInteractions(e);const r=Me(t),n=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!r&&i&&this.getFeature(o).type!==p.POINT)return this.changeMode(h.DIRECT_SELECT,{featureId:o});i&&r?(this.deselect(o),this.updateUIClasses({mouse:c.POINTER}),1===n.length&&we.enable(this)):!i&&r?(this.select(o),this.updateUIClasses({mouse:c.MOVE})):i||r||(n.forEach((e=>this.doRender(e))),this.setSelected(o),this.updateUIClasses({mouse:c.MOVE})),this.doRender(o)},Be.onMouseDown=function(e,t){return e.initialDragPanState=this.map.dragPan.isEnabled(),_e(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&ye(t)?this.startBoxSelect(e,t):void 0},Be.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=xe(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},Be.onTouchStart=function(e,t){if(_e(t))return this.startOnActiveFeature(e,t)},Be.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},Be.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:c.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(s.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=xe(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),i=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),l=`translate(${n}px, ${i}px)`;e.boxSelectElement.style.transform=l,e.boxSelectElement.style.WebkitTransform=l,e.boxSelectElement.style.width=o-n+"px",e.boxSelectElement.style.height=a-i+"px"},Be.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};Ge(this.getSelected(),r),e.dragMoveLocation=t.lngLat},Be.onTouchEnd=Be.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,xe(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),o=this.getUniqueIds(n).filter((e=>!this.isSelected(e)));o.length&&(this.select(o),o.forEach((e=>this.doRender(e))),this.updateUIClasses({mouse:c.MOVE}))}this.stopExtendedInteractions(e)},Be.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?f.ACTIVE:f.INACTIVE,r(t),this.fireActionable(),t.properties.active===f.ACTIVE&&t.geometry.type!==p.POINT&&Pe(t).forEach(r)},Be.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Be.onCombineFeatures=function(){const e=this.getSelected();if(0===e.length||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let o=0;o<e.length;o++){const i=e[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach((e=>{t.push(e)})):t.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){const e=this.newFeature({type:p.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(e),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([e.id]),this.fire(d.COMBINE_FEATURES,{createdFeatures:[e.toGeoJSON()],deletedFeatures:r})}this.fireActionable()},Be.onUncombineFeatures=function(){const e=this.getSelected();if(0===e.length)return;const t=[],r=[];for(let n=0;n<e.length;n++){const o=e[n];this.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach((e=>{this.addFeature(e),e.properties=o.properties,t.push(e.toGeoJSON()),this.select([e.id])})),this.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))}t.length>1&&this.fire(d.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};const Ke=Be,je=fe(g.VERTEX),$e=fe(g.MIDPOINT),He={fireUpdate:function(){this.fire(d.UPDATE,{action:m.CHANGE_COORDINATES,features:this.getSelected().map((e=>e.toGeoJSON()))})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){e.canDragMove&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);Me(t)||-1!==n?Me(t)&&-1===n&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];const o=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(o)},onMidpoint:function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map((t=>({feature_id:e,coord_path:t})))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){Ge(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){const n=e.selectedCoordPaths.map((t=>e.feature.getCoordinate(t))),o=Ve(n.map((e=>({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:e}}))),r);for(let t=0;t<n.length;t++){const r=n[t];e.feature.updateCoordinate(e.selectedCoordPaths[t],r[0]+o.lng,r[1]+o.lat)}},clickNoTarget:function(){this.changeMode(h.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(h.SIMPLE_SELECT)},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===p.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),we.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){we.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=f.ACTIVE,r(t),Pe(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=f.INACTIVE,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort(((e,t)=>t.localeCompare(e,"en",{numeric:!0}))).forEach((t=>e.feature.removeCoordinate(t))),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode(h.SIMPLE_SELECT,{}))},onMouseMove:function(e,t){const r=_e(t),n=je(t),o=$e(t),i=0===e.selectedCoordPaths.length;return r&&i||n&&!i?this.updateUIClasses({mouse:c.MOVE}):this.updateUIClasses({mouse:c.NONE}),(n||r||o)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0},onMouseOut:function(e){return e.dragMoving&&this.fireUpdate(),!0}};He.onTouchStart=He.onMouseDown=function(e,t){return je(t)?this.onVertex(e,t):_e(t)?this.onFeature(e,t):$e(t)?this.onMidpoint(e,t):void 0},He.onDrag=function(e,t){if(!0!==e.canDragMove)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat},He.onClick=function(e,t){return Ce(t)?this.clickNoTarget(e,t):_e(t)?this.clickActiveFeature(e,t):ve(t)?this.clickInactive(e,t):void this.stopDragging(e)},He.onTap=function(e,t){return Ce(t)?this.clickNoTarget(e,t):_e(t)?this.clickActiveFeature(e,t):ve(t)?this.clickInactive(e,t):void 0},He.onTouchEnd=He.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const qe=He,Je={onSetup:function(){const e=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:c.ADD}),this.activateUIButton(u.POINT),this.setActionableState({trash:!0}),{point:e}},stopDrawingAndRemove:function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)}};Je.onTap=Je.onClick=function(e,t){this.updateUIClasses({mouse:c.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(d.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.point.id]})},Je.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},Je.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?f.ACTIVE:f.INACTIVE,!n)return r(t)},Je.onTrash=Je.stopDrawingAndRemove,Je.onKeyUp=function(e,t){if(Te(t)||Se(t))return this.stopDrawingAndRemove(e,t)};const ze=Je,We=function(e,t){return!!e.lngLat&&e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]},Ze={onSetup:function(){const e=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),we.disable(this),this.updateUIClasses({mouse:c.ADD}),this.activateUIButton(u.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&We(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:c.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),be(t)&&this.updateUIClasses({mouse:c.POINTER})}};Ze.onTap=Ze.onClick=function(e,t){return be(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},Ze.onKeyUp=function(e,t){Te(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)):Se(t)&&this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},Ze.onStop=function(e){this.updateUIClasses({mouse:c.NONE}),we.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(d.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},Ze.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?f.ACTIVE:f.INACTIVE,!n)return r(t);if(0===t.geometry.coordinates.length)return;const o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=g.FEATURE,r(Le(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){const n=t.geometry.coordinates[0].length-3;r(Le(e.polygon.id,t.geometry.coordinates[0][n],`0.${n}`,!1))}if(o<=4){const e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:p.FEATURE,properties:t.properties,geometry:{coordinates:e,type:p.LINE_STRING}}),3===o)return}return r(t)}},Ze.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)};const Ye=Ze,Xe={onSetup:function(e){const t=(e=e||{}).featureId;let r,n,o="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let i=e.from;if(i&&"Feature"===i.type&&i.geometry&&"Point"===i.geometry.type&&(i=i.geometry),i&&"Point"===i.type&&i.coordinates&&2===i.coordinates.length&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===i[0]&&r.coordinates[a][1]===i[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else{if(r.coordinates[0][0]!==i[0]||r.coordinates[0][1]!==i[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");o="backwards",n=0,r.addCoordinate(n,...r.coordinates[0])}}else r=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),we.disable(this),this.updateUIClasses({mouse:c.ADD}),this.activateUIButton(u.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:o}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&We(t,e.line.coordinates[e.currentVertexPosition-1])||"backwards"===e.direction&&We(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:c.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),"forward"===e.direction?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.line.id]})},onMouseMove:function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),be(t)&&this.updateUIClasses({mouse:c.POINTER})}};Xe.onTap=Xe.onClick=function(e,t){if(be(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},Xe.onKeyUp=function(e,t){Se(t)?this.changeMode(h.SIMPLE_SELECT,{featureIds:[e.line.id]}):Te(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT))},Xe.onStop=function(e){we.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.line.id)&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(d.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT,{},{silent:!0})))},Xe.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(h.SIMPLE_SELECT)},Xe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?f.ACTIVE:f.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=g.FEATURE,r(Le(e.line.id,t.geometry.coordinates["forward"===e.direction?t.geometry.coordinates.length-2:1],""+("forward"===e.direction?t.geometry.coordinates.length-2:1),!1)),r(t))};const Qe={simple_select:Ke,direct_select:qe,draw_point:ze,draw_polygon:Ye,draw_line_string:Xe},et={defaultMode:h.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:ge,modes:Qe,controls:{},userProperties:!1,suppressAPIEvents:!0},tt={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},rt={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function nt(e,t){return e.map((e=>e.source?e:Object.assign({},e,{id:`${e.id}.${t}`,source:"hot"===t?l.HOT:l.COLD})))}var ot=r(17),it=r(186);function at(e,t){return e.length===t.length&&JSON.stringify(e.map((e=>e)).sort())===JSON.stringify(t.map((e=>e)).sort())}const st={Polygon:Y,LineString:W,Point:J,MultiPolygon:te,MultiLineString:te,MultiPoint:te};function lt(e){!function(e,t){const r={options:e=function(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),!1===e.displayControlsDefault?t.controls=Object.assign({},rt,e.controls):t.controls=Object.assign({},tt,e.controls),t=Object.assign({},et,t),t.styles=nt(t.styles,"cold").concat(nt(t.styles,"hot")),t}(e)};t=function(e,t){t.modes=h;const r=void 0===e.options.suppressAPIEvents||!!e.options.suppressAPIEvents;return t.getFeatureIdsAt=function(t){return P.click({point:t},null,e).map((e=>e.properties.id))},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:p.FEATURE_COLLECTION,features:e.store.getSelectedIds().map((t=>e.store.get(t))).map((e=>e.toGeoJSON()))}},t.getSelectedPoints=function(){return{type:p.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map((e=>({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:e.coordinates}})))}},t.set=function(r){if(void 0===r.type||r.type!==p.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let o=e.store.getAllIds().slice();const i=t.add(r),a=new L(i);return o=o.filter((e=>!a.has(e))),o.length&&t.delete(o),n(),i},t.add=function(t){const n=JSON.parse(JSON.stringify(it(t))).features.map((t=>{if(t.id=t.id||j(),null===t.geometry)throw new Error("Invalid geometry: null");if(void 0===e.store.get(t.id)||e.store.get(t.id).type!==t.geometry.type){const n=st[t.geometry.type];if(void 0===n)throw new Error(`Invalid geometry type: ${t.geometry.type}.`);const o=new n(e,t);e.store.add(o,{silent:r})}else{const n=e.store.get(t.id),o=n.properties;n.properties=t.properties,ot(o,t.properties)||e.store.featureChanged(n.id,{silent:r}),ot(n.getCoordinates(),t.geometry.coordinates)||n.incomingCoords(t.geometry.coordinates)}return t.id}));return e.store.render(),n},t.get=function(t){const r=e.store.get(t);if(r)return r.toGeoJSON()},t.getAll=function(){return{type:p.FEATURE_COLLECTION,features:e.store.getAll().map((e=>e.toGeoJSON()))}},t.delete=function(n){return e.store.delete(n,{silent:r}),t.getMode()!==h.DIRECT_SELECT||e.store.getSelectedIds().length?e.store.render():e.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:r}),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:r}),t.getMode()===h.DIRECT_SELECT?e.events.changeMode(h.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.changeMode=function(n,o={}){return n===h.SIMPLE_SELECT&&t.getMode()===h.SIMPLE_SELECT?(at(o.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(o.featureIds,{silent:r}),e.store.render()),t):(n===h.DIRECT_SELECT&&t.getMode()===h.DIRECT_SELECT&&o.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(n,o,{silent:r}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:r}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:r}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:r}),t},t.setFeatureProperty=function(n,o,i){return e.store.setFeatureProperty(n,o,i,{silent:r}),t},t}(r,t),r.api=t;const n=pe(r);t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=u,t.options=e}(e,this)}lt.modes=Qe,lt.constants=e,lt.lib=o;const ct=lt;var ut=6371008.8,pt={centimeters:637100880,centimetres:637100880,degrees:360/(2*Math.PI),feet:20902260.511392,inches:39.37*ut,kilometers:6371.0088,kilometres:6371.0088,meters:ut,metres:ut,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:ut/1852,radians:1,yards:6967335.223679999};function ht(e,t,r={}){const n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function dt(e,t,r={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return ht({type:"LineString",coordinates:e},t,r)}function mt(e){return e%360*Math.PI/180}function gt(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function ft(e,t,r){if(null!==e)for(var n,o,i,a,s,l,c,u,p=0,h=0,d=e.type,m="FeatureCollection"===d,g="Feature"===d,f=m?e.features.length:1,y=0;y<f;y++){s=(u=!!(c=m?e.features[y].geometry:g?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<s;_++){var v=0,C=0;if(null!==(a=u?c.geometries[_]:c)){l=a.coordinates;var E=a.type;switch(p=!r||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===t(l,h,y,v,C))return!1;h++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],h,y,v,C))return!1;h++,"MultiPoint"===E&&v++}"LineString"===E&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-p;o++){if(!1===t(l[n][o],h,y,v,C))return!1;h++}"MultiLineString"===E&&v++,"Polygon"===E&&C++}"Polygon"===E&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(C=0,o=0;o<l[n].length;o++){for(i=0;i<l[n][o].length-p;i++){if(!1===t(l[n][o][i],h,y,v,C))return!1;h++}C++}v++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===ft(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function yt(e,t){var r,n,o,i,a,s,l,c,u,p,h=0,d="FeatureCollection"===e.type,m="Feature"===e.type,g=d?e.features.length:1;for(r=0;r<g;r++){for(s=d?e.features[r].geometry:m?e.geometry:e,c=d?e.features[r].properties:m?e.properties:{},u=d?e.features[r].bbox:m?e.bbox:void 0,p=d?e.features[r].id:m?e.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=l?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,c,u,p))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===t(i.geometries[n],h,c,u,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,c,u,p))return!1;h++}}function _t(e,t){yt(e,(function(e,r,n,o,i){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(ht(e,n,{bbox:o,id:i}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<e.coordinates.length;l++){var c=e.coordinates[l];if(!1===t(ht({type:a,coordinates:c},n),r,l))return!1}}))}function vt(e){return function(e){var t=0;return yt(e,(function(e,r,n,o,i){t=t+function(e){let t,r=0;switch(e.type){case"Polygon":return Ct(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=Ct(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)})),t}(e)}function Ct(e){let t=0;if(e&&e.length>0){t+=Math.abs(Mt(e[0]));for(let r=1;r<e.length;r++)t-=Math.abs(Mt(e[r]))}return t}var Et=20294876564838.72,bt=Math.PI/180;function Mt(e){const t=e.length-1;if(t<=2)return 0;let r=0,n=0;for(;n<t;){const o=e[n],i=e[n+1===t?0:n+1],a=e[n+2>=t?(n+2)%t:n+2],s=o[0]*bt,l=i[1]*bt;r+=(a[0]*bt-s)*Math.sin(l),n++}return r*Et}function Tt(e,t={}){let r=0,n=0,o=0;return ft(e,(function(e){r+=e[0],n+=e[1],o++}),!0),function(e,t,r={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gt(e[0])||!gt(e[1]))throw new Error("coordinates must contain numbers");return ht({type:"Point",coordinates:e},t,r)}([r/o,n/o],t.properties)}function St(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function It(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ot(e,t,r={}){var n=St(e),o=St(t),i=mt(o[1]-n[1]),a=mt(o[0]-n[0]),s=mt(n[1]),l=mt(o[1]),c=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(l);return function(e,t="kilometers"){const r=pt[t];if(!r)throw new Error(t+" units is invalid");return e*r}(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)}function xt(e,t={}){return function(e,t,r){var n=r,o=!1;return function(e,t){_t(e,(function(e,r,n){var o=0;if(e.geometry){var i=e.geometry.type;if("Point"!==i&&"MultiPoint"!==i){var a,s=0,l=0,c=0;return!1!==ft(e,(function(i,u,p,h,d){if(void 0===a||r>s||h>l||d>c)return a=i,s=r,l=h,c=d,void(o=0);var m=dt([a,i],e.properties);if(!1===t(m,r,n,d,o))return!1;o++,a=i}))&&void 0}}}))}(e,(function(e,i,a,s,l){n=!1===o&&void 0===r?e:t(n,e,i,a,s,l),o=!0})),n}(e,((e,r)=>{const n=r.geometry.coordinates;return e+Ot(n[0],n[1],t)}),0)}var Lt=r(666),At=r.n(Lt);const Pt="source-draw-labels",wt="layer-draw-labels",Nt={type:"FeatureCollection",features:[]};class Ft{constructor(e){this.options=e,this._drawCtrl=new ct({displayControlsDefault:!1,styles:[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.options?.style?.lengthMeasurement?.lineColor??"#D20C0C","line-dasharray":[.2,2],"line-width":this.options?.style?.lengthMeasurement?.lineWidth??2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":this.options?.style?.areaMeasurement?.fillColor??"#D20C0C","fill-outline-color":this.options?.style?.areaMeasurement?.fillOutlineColor??"#D20C0C","fill-opacity":this.options?.style?.areaMeasurement?.fillOpacity??.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":this.options?.style?.common?.midPointRadius??3,"circle-color":this.options?.style?.common?.midPointColor??"#fbb03b"}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.options?.style?.areaMeasurement?.fillOutlineColor??"#D20C0C","line-dasharray":[.2,2],"line-width":this.options?.style?.areaMeasurement?.lineWidth??2}},{id:"gl-draw-polygon-and-line-vertex-halo-active",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":this.options?.style?.common?.midPointHaloRadius??3,"circle-color":this.options?.style?.common?.midPointHaloColor??"#FFF"}},{id:"gl-draw-polygon-and-line-vertex-active",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":this.options?.style?.common?.midPointRadius??3,"circle-color":this.options?.style?.common?.midPointColor??"#fbb03b"}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","$type","LineString"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.options?.style?.lengthMeasurement?.lineColor??"#D20C0C","line-width":this.options?.style?.lengthMeasurement?.lineWidth??3}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":this.options?.style?.areaMeasurement?.fillColor??"#000","fill-outline-color":this.options?.style?.areaMeasurement?.fillOutlineColor??"#000","fill-opacity":this.options?.style?.areaMeasurement?.fillOpacity??.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":this.options?.style?.areaMeasurement?.fillOutlineColor??"#000","line-width":this.options?.style?.areaMeasurement?.lineWidth??2}}]})}onAdd(e){return this._map=e,this._map.addControl(this._drawCtrl,"top-left"),this._initControl(),this._registerEvents(),this._container}_initControl(){this._container=document.createElement("div"),this._container.className="maplibregl-ctrl mapboxgl-ctrl maplibregl-measures maplibregl-ctrl-group mapboxgl-ctrl-group",this.initDrawBtn(this._drawCtrl.modes.DRAW_LINE_STRING),this.initDrawBtn(this._drawCtrl.modes.DRAW_POLYGON),this.initClearBtn()}_formatMeasure(e,t=!1){return"imperial"==this.options?.units?t?this._formatAreaToImperialSystem(e):this._formatToImperialSystem(e):t?this._formatAreaToMetricSystem(e):this._formatToMetricSystem(e)}_formatAreaToMetricSystem(e){let t=At()(e).from("m2").toBest({system:"metric"}),r=t.unit.replaceAll("2","²");return`${this._getLocaleNumber(t.val)} ${r}`}_formatAreaToImperialSystem(e){let t=At()(e).from("m2").to("mi2");t=At()(t).from("mi2").toBest({system:"imperial"});let r=t.unit.replaceAll("2","²");return`${this._getLocaleNumber(t.val)} ${r}`}_formatToMetricSystem(e){let t=At()(e).from("m").toBest({system:"metric"});return`${this._getLocaleNumber(t.val)} ${t.unit}`}_formatToImperialSystem(e){let t=At()(e).from("m").to("mi");return t=At()(t).from("mi").toBest({system:"imperial"}),`${this._getLocaleNumber(t.val)} ${t.unit}`}_getLocaleNumber(e){let t=e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2,useGrouping:!this.options?.unitsGroupingSeparator}),r=this.options?.unitsGroupingSeparator;return r&&(t=t.replace(/\B(?=(\d{3})+(?!\d))/g,r)),t}initDrawBtn(e){let t=document.createElement("button");switch(t.type="button",e){case this._drawCtrl.modes.DRAW_LINE_STRING:t.title=this.options?.lang?.lengthMeasurementButtonTitle??"",t.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                viewBox="0 0 512 512" xml:space="preserve" style="padding:4px">\n               <path d="M503.467,0h-51.2c-4.71,0-8.533,3.814-8.533,8.533v51.2c0,4.719,3.823,8.533,8.533,8.533h16.077\n                   c-15.027,136.132-31.095,243.354-75.81,275.678V332.8c0-4.719-3.823-8.533-8.533-8.533h-51.2c-4.71,0-8.533,3.814-8.533,8.533\n                   v9.207c-24.226-20.591-47.59-60.45-70.298-99.26c-22.485-38.426-43.793-74.795-66.236-93.269V128c0-4.719-3.823-8.533-8.533-8.533\n                   H128c-4.71,0-8.533,3.814-8.533,8.533v20.326c-45.833,25.207-73.916,114.697-93.005,295.407H8.533\n                   c-4.71,0-8.533,3.814-8.533,8.533v51.2C0,508.186,3.823,512,8.533,512h51.2c4.71,0,8.533-3.814,8.533-8.533v-51.2\n                   c0-4.719-3.823-8.533-8.533-8.533H43.622c16.734-157.124,41.054-245.598,75.844-274.765V179.2c0,4.719,3.823,8.533,8.533,8.533\n                   h51.2c4.71,0,8.533-3.814,8.533-8.533v-5.973c16.614,18.56,33.664,47.667,51.499,78.14\n                   c26.539,45.363,53.948,92.117,85.035,111.829V384c0,4.719,3.823,8.533,8.533,8.533H384c4.71,0,8.533-3.814,8.533-8.533v-20.096\n                   c58.539-29.158,75.981-141.21,92.979-295.637h17.954c4.71,0,8.533-3.814,8.533-8.533v-51.2C512,3.814,508.177,0,503.467,0z"/>\n           </svg>';break;case this._drawCtrl.modes.DRAW_POLYGON:t.title=this.options?.lang?.areaMeasurementButtonTitle??"",t.innerHTML='<svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M18 38C18 40.2091 16.2091 42 14 42C11.7909 42 10 40.2091 10 38C10 35.7909 11.7909 34 14 34C16.2091 34 18 35.7909 18 38Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M14 40C15.1046 40 16 39.1046 16 38C16 36.8954 15.1046 36 14 36C12.8954 36 12 36.8954 12 38C12 39.1046 12.8954 40 14 40ZM14 42C16.2091 42 18 40.2091 18 38C18 35.7909 16.2091 34 14 34C11.7909 34 10 35.7909 10 38C10 40.2091 11.7909 42 14 42Z" fill="#333333"/>\n                <path d="M14 20C14 22.2091 12.2091 24 10 24C7.79086 24 6 22.2091 6 20C6 17.7909 7.79086 16 10 16C12.2091 16 14 17.7909 14 20Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M10 22C11.1046 22 12 21.1046 12 20C12 18.8954 11.1046 18 10 18C8.89543 18 8 18.8954 8 20C8 21.1046 8.89543 22 10 22ZM10 24C12.2091 24 14 22.2091 14 20C14 17.7909 12.2091 16 10 16C7.79086 16 6 17.7909 6 20C6 22.2091 7.79086 24 10 24Z" fill="#333333"/>\n                <path d="M42 20C42 22.2091 40.2091 24 38 24C35.7909 24 34 22.2091 34 20C34 17.7909 35.7909 16 38 16C40.2091 16 42 17.7909 42 20Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M38 22C39.1046 22 40 21.1046 40 20C40 18.8954 39.1046 18 38 18C36.8954 18 36 18.8954 36 20C36 21.1046 36.8954 22 38 22ZM38 24C40.2091 24 42 22.2091 42 20C42 17.7909 40.2091 16 38 16C35.7909 16 34 17.7909 34 20C34 22.2091 35.7909 24 38 24Z" fill="#333333"/>\n                <path d="M38 38C38 40.2091 36.2091 42 34 42C31.7909 42 30 40.2091 30 38C30 35.7909 31.7909 34 34 34C36.2091 34 38 35.7909 38 38Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M34 40C35.1046 40 36 39.1046 36 38C36 36.8954 35.1046 36 34 36C32.8954 36 32 36.8954 32 38C32 39.1046 32.8954 40 34 40ZM34 42C36.2091 42 38 40.2091 38 38C38 35.7909 36.2091 34 34 34C31.7909 34 30 35.7909 30 38C30 40.2091 31.7909 42 34 42Z" fill="#333333"/>\n                <path d="M28 10C28 12.2091 26.2091 14 24 14C21.7909 14 20 12.2091 20 10C20 7.79086 21.7909 6 24 6C26.2091 6 28 7.79086 28 10Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C25.1046 12 26 11.1046 26 10C26 8.89543 25.1046 8 24 8C22.8954 8 22 8.89543 22 10C22 11.1046 22.8954 12 24 12ZM24 14C26.2091 14 28 12.2091 28 10C28 7.79086 26.2091 6 24 6C21.7909 6 20 7.79086 20 10C20 12.2091 21.7909 14 24 14Z" fill="#333333"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M34.9188 19.028L25.9188 12.5994L27.0812 10.9719L36.0812 17.4005L34.9188 19.028ZM21.7844 12.8114L13.0812 19.028L11.9187 17.4005L20.6219 11.1839L21.7844 12.8114ZM11.6428 22.783L14.3095 34.783L12.3571 35.2169L9.69047 23.2169L11.6428 22.783ZM33.6905 34.783L36.246 23.283L38.1984 23.7169L35.6428 35.2169L33.6905 34.783ZM17 36.9999H31V38.9999H17V36.9999Z" fill="#333333"/>\n                </svg>\n                '}t.addEventListener("click",(()=>{this._drawCtrl.changeMode(e)})),this._container.appendChild(t)}initClearBtn(){let e=document.createElement("button");e.type="button",e.title=this.options?.lang?.clearMeasurementsButtonTitle??"",e.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                            viewBox="0 0 465.311 465.311" style="enable-background:new 0 0 465.311 465.311;padding:5px" xml:space="preserve">\n                            <g>\n                                <path d="M372.811,51.002h-59.908V36.566C312.902,16.404,296.499,0,276.335,0h-87.356c-20.163,0-36.567,16.404-36.567,36.566v14.436\n                                    H92.5c-20.726,0-37.587,16.861-37.587,37.587v38.91c0,8.284,6.716,15,15,15h7.728v307.812c0,8.284,6.716,15,15,15H372.67\n                                    c8.284,0,15-6.716,15-15V142.499h7.728c8.284,0,15-6.716,15-15v-38.91C410.397,67.863,393.536,51.002,372.811,51.002z\n                                        M182.412,36.566c0-3.621,2.946-6.566,6.567-6.566h87.356c3.621,0,6.567,2.946,6.567,6.566v14.436h-100.49V36.566z M84.914,88.589\n                                    c0-4.184,3.403-7.587,7.587-7.587h280.31c4.184,0,7.587,3.403,7.587,7.587v23.91H84.914V88.589z M357.67,435.311H107.641V142.499\n                                    H357.67V435.311z"/>\n                                <path d="M137.41,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\n                                    C127.41,409.008,131.887,413.485,137.41,413.485z"/>\n                                <path d="M200.907,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\n                                    C190.907,409.008,195.384,413.485,200.907,413.485z"/>\n                                <path d="M264.404,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\n                                    C254.404,409.008,258.881,413.485,264.404,413.485z"/>\n                                <path d="M327.901,413.485c5.523,0,10-4.477,10-10V166.497c0-5.523-4.477-10-10-10s-10,4.477-10,10v236.988\n                                    C317.901,409.008,322.378,413.485,327.901,413.485z"/>\n                            </g>\n                            </svg>',e.addEventListener("click",(()=>{this._drawCtrl.deleteAll(),this._updateLabels()})),this._container.appendChild(e)}_registerEvents(){this._map&&(this._map.on("load",(()=>{this._recreateSourceAndLayers()})),this._map.on("draw.create",(()=>{this._updateLabels(),this._handleOnCreate()})),this._map.on("draw.update",this._updateLabels.bind(this)),this._map.on("draw.delete",this._updateLabels.bind(this)),this._map.on("draw.render",(()=>{this._updateLabels(),this._handleOnRender()})))}_recreateSourceAndLayers(){this._map.getSource(Pt)||this._map.addSource(Pt,{type:"geojson",data:Nt}),this._map.getLayer(wt)||this._map.addLayer({id:wt,type:"symbol",source:Pt,layout:{"text-font":[this.options?.style?.text?.font??"Klokantech Noto Sans Bold"],"text-field":["get","measurement"],"text-variable-anchor":["top","bottom","left","right"],"text-radial-offset":this.options?.style?.text?.radialOffset??.5,"text-justify":"auto","text-letter-spacing":this.options?.style?.text?.letterSpacing??.05,"text-size":["interpolate",["linear"],["zoom"],5,10,10,12,13,14,14,16,18,18]},paint:{"text-color":this.options?.style?.text?.color??"#D20C0C","text-halo-color":this.options?.style?.text?.haloColor??"#fff","text-halo-width":this.options?.style?.text?.haloWidth??10}})}_reorderLayers(){if(this._map){let e=Object.values(ct.constants.sources);this._map.getStyle().layers.filter((t=>e.includes(t.source))).forEach((e=>{this._map.moveLayer(e.id)})),this._map.moveLayer(wt)}}_handleOnRender(){if(this.options&&null!==this.options.onRender&&void 0!==this.options.onRender&&this.options.onRender instanceof Function){const e=this._getDrawnFeatures();try{this.options.onRender.call(this,e)}catch(e){console.error(e)}}}_handleOnCreate(){if(this.options&&null!==this.options.onCreate&&void 0!==this.options.onCreate&&this.options.onCreate instanceof Function){const e=this._getDrawnFeatures();try{this.options.onCreate.call(this,e)}catch(e){console.error(e)}}}_updateLabels(){let e=this._map.getSource(Pt);!e&&this._map&&(this._recreateSourceAndLayers(),e=this._map.getSource(Pt));const t=this._getDrawnFeatures();e.setData(t),this._reorderLayers()}_getDrawnFeatures(){let e=[];return this._drawCtrl.getAll().features.forEach((t=>{try{if("Polygon"==t.geometry.type){let r=this._formatMeasure(vt(t),!0),n=Tt(t),o=`${r}`;n.properties={measurement:o},e.push(n)}else"LineString"==t.geometry.type&&function(e){if(!e)throw new Error("geojson is required");const t=[];return _t(e,(e=>{!function(e,t){let r=[];const n=e.geometry;if(null!==n){switch(n.type){case"Polygon":r=It(n);break;case"LineString":r=[It(n)]}r.forEach((r=>{const n=function(e,t){const r=[];return e.reduce(((e,n)=>{const o=dt([e,n],t);return o.bbox=function(e,t){const r=e[0],n=e[1],o=t[0],i=t[1];return[r<o?r:o,n<i?n:i,r>o?r:o,n>i?n:i]}(e,n),r.push(o),n})),r}(r,e.properties);n.forEach((e=>{e.id=t.length,t.push(e)}))}))}}(e,t)})),function(e,t={}){const r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}(t)}(t).features.forEach((t=>{let r=Tt(t),n=`${this._formatMeasure(1e3*xt(t))}`;r.properties={measurement:n},e.push(r)}))}catch(e){}})),{type:"FeatureCollection",features:e}}onRemove(){this._container.parentNode.removeChild(this._container),this._map.removeLayer(wt),this._map=void 0}}})(),maplibreGLMeasures=n})();
//# sourceMappingURL=maplibre-gl-measures.js.map